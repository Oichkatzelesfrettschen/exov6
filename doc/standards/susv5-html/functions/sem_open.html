<!-- Copyright 2001-2024 IEEE and The Open Group, All Rights Reserved -->
<!DOCTYPE HTML>
<html lang="en">
<head>
<meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.8.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link type="text/css" rel="stylesheet" href="style.css"><!-- Generated by The Open Group rhtm tool v1.2.4 -->
<!-- Copyright (c) 2001-2024 The Open Group, All Rights Reserved -->
<title>sem_open</title>
</head>
<body bgcolor="white">
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/sem_init.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/sem_post.html" accesskey="N">Next
&gt;&gt;&gt;</a></td>
</tr>
</table>
<hr align="left" width="100%"></div>
<script language="JavaScript" src="../jscript/codes.js"></script><basefont size="3">
<center><font size="2">The Open Group Base Specifications Issue 8<br>
IEEE Std 1003.1-2024<br>
Copyright © 2001-2024 The IEEE and The Open Group</font></center>
<hr size="2" noshade>
<a name="top" id="top"></a> <a name="sem_open" id="sem_open"></a> <a name="tag_17_509" id="tag_17_509"></a><!-- sem_open -->
<h4 class="mansect"><a name="tag_17_509_01" id="tag_17_509_01"></a>NAME</h4>
<blockquote>sem_open — initialize and open a named semaphore</blockquote>
<h4 class="mansect"><a name="tag_17_509_02" id="tag_17_509_02"></a>SYNOPSIS</h4>
<blockquote class="synopsis">
<p><code><tt>#include &lt;<a href="../basedefs/semaphore.h.html">semaphore.h</a>&gt;<br>
<br>
sem_t *sem_open(const char *</tt><i>name</i><tt>, int</tt> <i>oflag</i><tt>, ...);<br></tt></code></p>
</blockquote>
<h4 class="mansect"><a name="tag_17_509_03" id="tag_17_509_03"></a>DESCRIPTION</h4>
<blockquote>
<p>The <i>sem_open</i>() function shall establish a connection between a named semaphore and a process. A named semaphore may be
implemented using a file descriptor. Following a call to <i>sem_open</i>() with semaphore name <i>name</i>, the process may
reference the semaphore associated with <i>name</i> using the semaphore handle returned from the call. This semaphore can be used
in subsequent calls to <a href="../functions/sem_clockwait.html"><i>sem_clockwait</i>()</a>, <a href=
"../functions/sem_close.html"><i>sem_close</i>()</a>, <a href="../functions/sem_post.html"><i>sem_post</i>()</a>, <a href=
"../functions/sem_timedwait.html"><i>sem_timedwait</i>()</a>, <a href="../functions/sem_trywait.html"><i>sem_trywait</i>()</a>, and
<a href="../functions/sem_wait.html"><i>sem_wait</i>()</a>. The semaphore remains usable by this process until the semaphore is
closed by a successful call to <a href="../functions/sem_close.html"><i>sem_close</i>()</a>, <a href=
"../functions/_exit.html"><i>_exit</i>()</a>, or one of the <i><a href="../functions/exec.html">exec</a></i> functions.</p>
<p>The <i>oflag</i> argument controls whether the semaphore is created or merely accessed by the call to <i>sem_open</i>(). The
following flag bits may be set in <i>oflag</i>:</p>
<dl compact>
<dd></dd>
<dt>O_CREAT</dt>
<dd>This flag is used to create a semaphore if it does not already exist. If O_CREAT is set and the semaphore already exists, then
O_CREAT has no effect, except as noted under O_EXCL. Otherwise, <i>sem_open</i>() creates a named semaphore. The O_CREAT flag
requires a third and a fourth argument: <i>mode</i>, which is of type <b>mode_t</b>, and <i>value</i>, which is of type
<b>unsigned</b>. The semaphore is created with an initial value of <i>value</i>. Valid initial values for semaphores are less than
or equal to {SEM_VALUE_MAX}.
<p>The user ID of the semaphore shall be set to the effective user ID of the process. The group ID of the semaphore shall be set to
the effective group ID of the process; however, if the <i>name</i> argument is visible in the file system, the group ID may be set
to the group ID of the containing directory. The permission bits of the semaphore are set to the value of the <i>mode</i> argument
except those set in the file mode creation mask of the process. When bits in <i>mode</i> other than the file permission bits are
specified, the effect is unspecified.</p>
<p>After the semaphore named <i>name</i> has been created by <i>sem_open</i>() with the O_CREAT flag, other processes can connect
to the semaphore by calling <i>sem_open</i>() with the same value of <i>name</i>.</p>
</dd>
<dt>O_EXCL</dt>
<dd>If O_EXCL and O_CREAT are set, <i>sem_open</i>() fails if the semaphore <i>name</i> exists. The check for the existence of the
semaphore and the creation of the semaphore if it does not exist are atomic with respect to other processes executing
<i>sem_open</i>() with O_EXCL and O_CREAT set. If O_EXCL is set and O_CREAT is not set, the effect is undefined.
<p>If flags other than O_CREAT and O_EXCL are specified in the <i>oflag</i> parameter, the effect is unspecified.</p>
</dd>
</dl>
<p>The <i>name</i> argument points to a string naming a semaphore object. It is unspecified whether the name appears in the file
system and is visible to functions that take pathnames as arguments. The <i>name</i> argument conforms to the construction rules
for a pathname, except that the interpretation of &lt;slash&gt; characters other than the leading &lt;slash&gt; character in
<i>name</i> is implementation-defined, and that the length limits for the <i>name</i> argument are implementation-defined and need
not be the same as the pathname limits {PATH_MAX} and {NAME_MAX}. If <i>name</i> begins with the &lt;slash&gt; character, then
processes calling <i>sem_open</i>() with the same value of <i>name</i> shall refer to the same semaphore object, as long as that
name has not been removed. If <i>name</i> does not begin with the &lt;slash&gt; character, the effect is
implementation-defined.</p>
<p>If a process makes multiple successful calls to <i>sem_open</i>() with the same value for <i>name</i>, there have been no
intervening calls to <a href="../functions/sem_unlink.html"><i>sem_unlink</i>()</a> for <i>name</i>, and at least one open handle
for this semaphore has not been closed with a <a href="../functions/sem_close.html"><i>sem_close</i>()</a> call, it is
implementation-defined whether the same handle or a unique handle is returned for each such successful call.</p>
<p>References to copies of the semaphore produce undefined results.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_509_04" id="tag_17_509_04"></a>RETURN VALUE</h4>
<blockquote>
<p>Upon successful completion, the <i>sem_open</i>() function shall return the address of the semaphore. Otherwise, it shall return
a value of SEM_FAILED and set <i>errno</i> to indicate the error. The symbol SEM_FAILED is defined in the <a href=
"../basedefs/semaphore.h.html"><i>&lt;semaphore.h&gt;</i></a> header. No successful return from <i>sem_open</i>() shall return the
value SEM_FAILED.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_509_05" id="tag_17_509_05"></a>ERRORS</h4>
<blockquote>
<p>If any of the following conditions occur, the <i>sem_open</i>() function shall return SEM_FAILED and set <i>errno</i> to the
corresponding value:</p>
<dl compact>
<dd></dd>
<dt>[EACCES]</dt>
<dd>The named semaphore exists and the permissions specified by <i>oflag</i> are denied, or the named semaphore does not exist and
permission to create the named semaphore is denied.</dd>
<dt>[EEXIST]</dt>
<dd>O_CREAT and O_EXCL are set and the named semaphore already exists.</dd>
<dt>[EINTR]</dt>
<dd>The <i>sem_open</i>() operation was interrupted by a signal.</dd>
<dt>[EINVAL]</dt>
<dd>The <i>sem_open</i>() operation is not supported for the given name, or O_CREAT was specified in <i>oflag</i> and <i>value</i>
was greater than {SEM_VALUE_MAX}.</dd>
<dt>[ENOENT]</dt>
<dd>O_CREAT is not set and the named semaphore does not exist.</dd>
<dt>[ENOMEM]</dt>
<dd>There is insufficient memory for the creation of the new named semaphore.</dd>
<dt>[ENOSPC]</dt>
<dd>There is insufficient space on a storage device for the creation of the new named semaphore.</dd>
</dl>
<p>If any of the following conditions occur, the <i>sem_open</i>() function may return SEM_FAILED and set <i>errno</i> to the
corresponding value:</p>
<dl compact>
<dd></dd>
<dt>[EMFILE]</dt>
<dd>Too many semaphore descriptors or file descriptors are currently in use by this process.</dd>
<dt>[ENAMETOOLONG]</dt>
<dd>
The length of the <i>name</i> argument exceeds {_POSIX_PATH_MAX} on systems that do not support the XSI option <sup>[<a href=
"javascript:open_code('XSI')">XSI</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> &nbsp;or exceeds
{_XOPEN_PATH_MAX} on XSI systems, <img src="../images/opt-end.gif" alt="[Option End]" border="0"> &nbsp;or has a pathname component
that is longer than {_POSIX_NAME_MAX} on systems that do not support the XSI option <sup>[<a href=
"javascript:open_code('XSI')">XSI</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> &nbsp;or longer
than {_XOPEN_NAME_MAX} on XSI systems. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[ENFILE]</dt>
<dd>Too many semaphore descriptors or file descriptors are currently open in the system.</dd>
</dl>
</blockquote>
<hr>
<div class="box"><em>The following sections are informative.</em></div>
<h4 class="mansect"><a name="tag_17_509_06" id="tag_17_509_06"></a>EXAMPLES</h4>
<blockquote>
<p>None.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_509_07" id="tag_17_509_07"></a>APPLICATION USAGE</h4>
<blockquote>
<p>None.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_509_08" id="tag_17_509_08"></a>RATIONALE</h4>
<blockquote>
<p>Early drafts required an error return value of -1 with the type <b>sem_t *</b> for the <i>sem_open</i>() function, which is not
guaranteed to be portable across implementations. The revised text provides the symbolic error code SEM_FAILED to eliminate the
type conflict.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_509_09" id="tag_17_509_09"></a>FUTURE DIRECTIONS</h4>
<blockquote>
<p>A future version might require the <i>sem_open</i>() and <a href="../functions/sem_unlink.html"><i>sem_unlink</i>()</a>
functions to have semantics similar to normal file system operations.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_509_10" id="tag_17_509_10"></a>SEE ALSO</h4>
<blockquote>
<p><a href="../functions/semctl.html#"><i>semctl</i>()</a>, <a href="../functions/semget.html#"><i>semget</i>()</a>, <a href=
"../functions/semop.html#"><i>semop</i>()</a>, <a href="../functions/sem_clockwait.html#"><i>sem_clockwait</i>()</a>, <a href=
"../functions/sem_close.html#"><i>sem_close</i>()</a>, <a href="../functions/sem_post.html#"><i>sem_post</i>()</a>, <a href=
"../functions/sem_trywait.html#"><i>sem_trywait</i>()</a>, <a href="../functions/sem_unlink.html#"><i>sem_unlink</i>()</a></p>
<p>XBD <a href="../basedefs/semaphore.h.html"><i>&lt;semaphore.h&gt;</i></a></p>
</blockquote>
<h4 class="mansect"><a name="tag_17_509_11" id="tag_17_509_11"></a>CHANGE HISTORY</h4>
<blockquote>
<p>First released in Issue 5. Included for alignment with the POSIX Realtime Extension.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_509_12" id="tag_17_509_12"></a>Issue 6</h4>
<blockquote>
<p>The <i>sem_open</i>() function is marked as part of the Semaphores option.</p>
<p>The [ENOSYS] error condition has been removed as stubs need not be provided if an implementation does not support the Semaphores
option.</p>
<p>The <a href="../functions/sem_timedwait.html"><i>sem_timedwait</i>()</a> function is added to the SEE ALSO section for alignment
with IEEE&nbsp;Std&nbsp;1003.1d-1999.</p>
<p>IEEE&nbsp;Std&nbsp;1003.1-2001/Cor&nbsp;2-2004, item XSH/TC2/D6/117 is applied, updating the DESCRIPTION to add the <a href=
"../functions/sem_timedwait.html"><i>sem_timedwait</i>()</a> function for alignment with IEEE&nbsp;Std&nbsp;1003.1d-1999.</p>
<p>IEEE&nbsp;Std&nbsp;1003.1-2001/Cor&nbsp;2-2004, item XSH/TC2/D6/118 is applied, updating the DESCRIPTION to describe the
conditions to return the same semaphore address on a call to <i>sem_open</i>(). The words &quot;and at least one previous successful
<i>sem_open</i>() call for this semaphore has not been matched with a <a href="../functions/sem_close.html"><i>sem_close</i>()</a>
call&quot; are added.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_509_13" id="tag_17_509_13"></a>Issue 7</h4>
<blockquote>
<p>Austin Group Interpretation 1003.1-2001 #066 is applied, updating the [ENOSPC] error case and adding the [ENOMEM] error
case.</p>
<p>Austin Group Interpretation 1003.1-2001 #077 is applied, clarifying the <i>name</i> argument and adding [ENAMETOOLONG] as a
&quot;may fail&quot; error.</p>
<p>Austin Group Interpretation 1003.1-2001 #141 is applied, adding FUTURE DIRECTIONS.</p>
<p>SD5-XSH-ERN-170 is applied, updating the DESCRIPTION to clarify the wording for setting the user ID and group ID of the
semaphore.</p>
<p>The <i>sem_open</i>() function is moved from the Semaphores option to the Base.</p>
<p>POSIX.1-2008, Technical Corrigendum 1, XSH/TC1-2008/0527 [37] is applied.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_509_14" id="tag_17_509_14"></a>Issue 8</h4>
<blockquote>
<p>Austin Group Defect 368 is applied, adding a statement that a named semaphore may be implemented using a file descriptor and
changing the ERRORS section.</p>
<p>Austin Group Defect 1216 is applied, adding <a href="../functions/sem_clockwait.html"><i>sem_clockwait</i>()</a>.</p>
<p>Austin Group Defect 1324 is applied, making it implementation-defined whether the same handle or a unique handle is returned
when multiple successful calls to <i>sem_open</i>() are made with the same value for <i>name</i>.</p>
</blockquote>
<div class="box"><em>End of informative text.</em></div>
<hr>
<p>&nbsp;</p>
<a href="#top"><span class="topOfPage">return to top of page</span></a><br>
<hr size="2" noshade>
<center><font size="2">UNIX® is a registered Trademark of The Open Group.<br>
POSIX™ is a Trademark of The IEEE.<br>
Copyright © 2001-2024 The IEEE and The Open Group, All Rights Reserved<br>
[ <a href="../mindex.html">Main Index</a> | <a href="../basedefs/contents.html">XBD</a> | <a href=
"../functions/contents.html">XSH</a> | <a href="../utilities/contents.html">XCU</a> | <a href="../xrat/contents.html">XRAT</a>
]</font></center>
<hr size="2" noshade>
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/sem_init.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/sem_post.html" accesskey="N">Next
&gt;&gt;&gt;</a></td>
</tr>
</table>
<hr align="left" width="100%"></div>
</body>
</html>
