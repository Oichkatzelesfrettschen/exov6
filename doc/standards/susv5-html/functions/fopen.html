<!-- Copyright 2001-2024 IEEE and The Open Group, All Rights Reserved -->
<!DOCTYPE HTML>
<html lang="en">
<head>
<meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.8.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link type="text/css" rel="stylesheet" href="style.css"><!-- Generated by The Open Group rhtm tool v1.2.4 -->
<!-- Copyright (c) 2001-2024 The Open Group, All Rights Reserved -->
<title>fopen</title>
</head>
<body bgcolor="white">
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/fnmatch.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/fork.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>
<hr align="left" width="100%"></div>
<script language="JavaScript" src="../jscript/codes.js"></script><basefont size="3">
<center><font size="2">The Open Group Base Specifications Issue 8<br>
IEEE Std 1003.1-2024<br>
Copyright © 2001-2024 The IEEE and The Open Group</font></center>
<hr size="2" noshade>
<a name="top" id="top"></a> <a name="fopen" id="fopen"></a> <a name="tag_17_171" id="tag_17_171"></a><!-- fopen -->
<h4 class="mansect"><a name="tag_17_171_01" id="tag_17_171_01"></a>NAME</h4>
<blockquote>fopen — open a stream</blockquote>
<h4 class="mansect"><a name="tag_17_171_02" id="tag_17_171_02"></a>SYNOPSIS</h4>
<blockquote class="synopsis">
<p><code><tt>#include &lt;<a href="../basedefs/stdio.h.html">stdio.h</a>&gt;<br>
<br>
FILE *fopen(const char *restrict</tt> <i>pathname</i><tt>, const char *restrict</tt> <i>mode</i><tt>);<br></tt></code></p>
</blockquote>
<h4 class="mansect"><a name="tag_17_171_03" id="tag_17_171_03"></a>DESCRIPTION</h4>
<blockquote>
<div class="box"><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]"
border="0"> Except for the &quot;exclusive access&quot; requirement (see below), the functionality described on this reference page is
aligned with the ISO&nbsp;C standard. Any other conflict between the requirements described here and the ISO&nbsp;C standard is
unintentional. This volume of POSIX.1-2024 defers to the ISO&nbsp;C standard for all <i>fopen</i>() functionality except in
relation to &quot;exclusive access&quot;. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></div>
<p>The <i>fopen</i>() function shall open the file whose pathname is the string pointed to by <i>pathname</i>, and associates a
stream with it.</p>
<p>The <i>mode</i> argument points to a character string. The behavior is unspecified if any character occurs more than once in the
string. If the string begins with one of the following characters, then the file shall be opened in the indicated mode. Otherwise,
the behavior is undefined.</p>
<dl compact>
<dd></dd>
<dt><tt>'r'</tt></dt>
<dd>Open file for reading.</dd>
<dt><tt>'w'</tt></dt>
<dd>Truncate to zero length or create file for writing.</dd>
<dt><tt>'a'</tt></dt>
<dd>Append; open or create file for writing at end-of-file.</dd>
</dl>
<p>The remainder of the string can contain any of the following characters, <sup>[<a href=
"javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> &nbsp;in any order,
<img src="../images/opt-end.gif" alt="[Option End]" border="0"> and further affect how the file is opened:</p>
<dl compact>
<dd></dd>
<dt><tt>'b'</tt></dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
This character shall have no effect, but is allowed for ISO&nbsp;C standard conformance. <img src="../images/opt-end.gif" alt=
"[Option End]" border="0"></dd>
<dt><tt>'e'</tt></dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The underlying file descriptor shall have the FD_CLOEXEC flag atomically set. <img src="../images/opt-end.gif" alt="[Option End]"
border="0"></dd>
<dt><tt>'x'</tt></dt>
<dd>If the first character of <i>mode</i> is <tt>'w'</tt> <sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src=
"../images/opt-start.gif" alt="[Option Start]" border="0"> &nbsp;or <tt>'a'</tt>, <img src="../images/opt-end.gif" alt=
"[Option End]" border="0"> then the function shall fail if the file already exists, or cannot be created; if the file does not
exist and can be created, it shall be created with <sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src=
"../images/opt-start.gif" alt="[Option Start]" border="0"> &nbsp;an implementation-defined form of <img src="../images/opt-end.gif"
alt="[Option End]" border="0"> &nbsp;exclusive (also known as non-shared) access,<br>
<sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> if
supported by the underlying file system, provided the resulting file permissions are the same as they would be without the
<tt>'x'</tt> modifier. If the first character of mode is <tt>'r'</tt>, the effect is implementation-defined. <img src=
"../images/opt-end.gif" alt="[Option End]" border="0"> <basefont size="2">
<dl>
<dt><b>Note:</b></dt>
<dd>The ISO&nbsp;C standard requires exclusive access &quot;to the extent that the underlying file system supports exclusive access&quot;,
but does not define what it means by this. Taken at face value—that systems must do whatever they are capable of, at the file
system level, in order to exclude access by others—this would require POSIX.1 systems to set the file permissions in a way that
prevents access by other users and groups. Consequently, this volume of POSIX.1-2024 does not defer to the ISO&nbsp;C standard as
regards the &quot;exclusive access&quot; requirement.</dd>
</dl>
<basefont size="3"></dd>
<dt><tt>'+'</tt></dt>
<dd>The file shall be opened for update (both reading and writing), rather than just reading or just writing.</dd>
</dl>
<p>Opening a file with read mode (<tt>'r'</tt> as the first character in the <i>mode</i> argument) shall fail if the file does not
exist or cannot be read.</p>
<p>Opening a file with append mode (<tt>'a'</tt> as the first character in the <i>mode</i> argument) shall cause all subsequent
writes to the file to be forced to the then current end-of-file, regardless of intervening calls to <a href=
"../functions/fseek.html"><i>fseek</i>()</a>.</p>
<p>When a file is opened with update mode (<tt>'+'</tt> in the <i>mode</i> argument), both input and output can be performed on the
associated stream. However, the application shall ensure that output is not directly followed by input without an intervening call
to <a href="../functions/fflush.html"><i>fflush</i>()</a> or to a file positioning function (<a href=
"../functions/fseek.html"><i>fseek</i>()</a>, <a href="../functions/fsetpos.html"><i>fsetpos</i>()</a>, or <a href=
"../functions/rewind.html"><i>rewind</i>()</a>), and input is not directly followed by output without an intervening call to a file
positioning function, unless the input operation encounters end-of-file.</p>
<p>When opened, a stream is fully buffered if and only if it can be determined not to refer to an interactive device. The error and
end-of-file indicators for the stream shall be cleared.</p>
<p><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> If
the first character in <i>mode</i> is <tt>'w'</tt> or <tt>'a'</tt> and the file did not previously exist, upon successful
completion, <i>fopen</i>() shall mark for update the last data access, last data modification, and last file status change
timestamps of the file and the last file status change and last data modification timestamps of the parent directory.</p>
<p>If the first character in <i>mode</i> is <tt>'w'</tt> or <tt>'a'</tt> and the file did not previously exist, the <i>fopen</i>()
function shall create a file as if it called the <a href="../functions/open.html"><i>open</i>()</a> function with a value
appropriate for the <i>path</i> argument interpreted from <i>pathname</i>, a value for the <i>oflag</i> argument as specified
below, and a value of S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP | S_IROTH | S_IWOTH for the third argument.</p>
<p>If the first character in <i>mode</i> is <tt>'w'</tt> and the file did previously exist, upon successful completion,
<i>fopen</i>() shall mark for update the last data modification and last file status change timestamps of the file. <img src=
"../images/opt-end.gif" alt="[Option End]" border="0"></p>
<p>After a successful call to the <i>fopen</i>() function, the orientation of the stream shall be cleared, <sup>[<a href=
"javascript:open_code('XSI')">XSI</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> &nbsp;the encoding
rule shall be cleared, <img src="../images/opt-end.gif" alt="[Option End]" border="0"> and the associated <b>mbstate_t</b> object
shall be set to describe an initial conversion state.</p>
<p><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> The
file descriptor associated with the opened stream shall be allocated and opened as if by a call to <a href=
"../functions/open.html"><i>open</i>()</a> using the following flags:</p>
<center>
<table border="1" cellpadding="3" align="center">
<tr valign="top">
<th align="center">
<p class="tent"><b>fopen() Mode First Character</b></p>
</th>
<th align="center">
<p class="tent"><b>fopen() Mode Includes <tt>'+'</tt></b></p>
</th>
<th align="center">
<p class="tent"><b>Initial open() Flags</b></p>
</th>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">'r'</p>
</td>
<td align="left">
<p class="tent">no</p>
</td>
<td align="left">
<p class="tent">O_RDONLY</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">'w'</p>
</td>
<td align="left">
<p class="tent">no</p>
</td>
<td align="left">
<p class="tent">O_WRONLY|O_CREAT|O_TRUNC</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">'a'</p>
</td>
<td align="left">
<p class="tent">no</p>
</td>
<td align="left">
<p class="tent">O_WRONLY|O_CREAT|O_APPEND</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">'r'</p>
</td>
<td align="left">
<p class="tent">yes</p>
</td>
<td align="left">
<p class="tent">O_RDWR</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">'w'</p>
</td>
<td align="left">
<p class="tent">yes</p>
</td>
<td align="left">
<p class="tent">O_RDWR|O_CREAT|O_TRUNC</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">'a'</p>
</td>
<td align="left">
<p class="tent">yes</p>
</td>
<td align="left">
<p class="tent">O_RDWR|O_CREAT|O_APPEND</p>
</td>
</tr>
</table>
</center>
<p class="tent">If, and only if, the <tt>'e'</tt> <i>mode</i> string character is specified, the O_CLOEXEC flag shall be OR'ed into
the initial <a href="../functions/open.html"><i>open</i>()</a> flags specified in the above table.</p>
<p class="tent">If, and only if, the <tt>'x'</tt> <i>mode</i> string character is specified together with either <tt>'w'</tt> or
<tt>'a'</tt>, the O_EXCL flag shall be OR'ed into the initial <a href="../functions/open.html"><i>open</i>()</a> flags specified in
the above table.</p>
<p class="tent">If <i>mode</i> includes <tt>'x'</tt> and the underlying file system supports exclusive access (see above) enabled
by the use of implementation-specific flags to <a href="../functions/open.html"><i>open</i>()</a>, then the behavior shall be as if
those flags are also included.</p>
<p class="tent">When using <i>mode</i> strings specified by this standard, the implementation shall behave as if no other flags had
been passed to <a href="../functions/open.html"><i>open</i>()</a>. <img src="../images/opt-end.gif" alt="[Option End]" border=
"0"></p>
</blockquote>
<h4 class="mansect"><a name="tag_17_171_04" id="tag_17_171_04"></a>RETURN VALUE</h4>
<blockquote>
<p>Upon successful completion, <i>fopen</i>() shall return a pointer to the object controlling the stream. Otherwise, a null
pointer shall be returned, <sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt=
"[Option Start]" border="0"> &nbsp;and <i>errno</i> shall be set to indicate the error. <img src="../images/opt-end.gif" alt=
"[Option End]" border="0"></p>
</blockquote>
<h4 class="mansect"><a name="tag_17_171_05" id="tag_17_171_05"></a>ERRORS</h4>
<blockquote>
<p>The <i>fopen</i>() function shall fail if:</p>
<dl compact>
<dd></dd>
<dt>[EACCES]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
Search permission is denied on a component of the path prefix, or the file exists and the permissions specified by <i>mode</i> are
denied, or the file does not exist and write permission is denied for the parent directory of the file to be created. <img src=
"../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[EEXIST]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The <i>mode</i> argument begins with <i>w</i> or <i>a</i> and includes <i>x</i>, but the file already exists. <img src=
"../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[EILSEQ]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The <i>mode</i> argument begins with <i>w</i> or <i>a</i>, the file did not previously exist, and the last pathname component is
not a portable filename and cannot be created in the target directory. <img src="../images/opt-end.gif" alt="[Option End]" border=
"0"></dd>
<dt>[EINTR]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> A
signal was caught during <i>fopen</i>(). <img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[EISDIR]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The named file is a directory and <i>mode</i> requires write access. <img src="../images/opt-end.gif" alt="[Option End]" border=
"0"></dd>
<dt>[ELOOP]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> A
loop exists in symbolic links encountered during resolution of the <i>pathname</i> argument. <img src="../images/opt-end.gif" alt=
"[Option End]" border="0"></dd>
<dt>[EMFILE]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
All file descriptors available to the process are currently open. <img src="../images/opt-end.gif" alt="[Option End]" border=
"0"></dd>
<dt>[EMFILE]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
{STREAM_MAX} streams are currently open in the calling process. <img src="../images/opt-end.gif" alt="[Option End]" border=
"0"></dd>
<dt>[ENAMETOOLONG]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border=
"0"><br>
The length of a pathname exceeds {PATH_MAX}, or pathname resolution of a symbolic link produced an intermediate result with a
length that exceeds {PATH_MAX}. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[ENFILE]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The maximum allowable number of files is currently open in the system. <img src="../images/opt-end.gif" alt="[Option End]" border=
"0"></dd>
<dt>[ENOENT]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The <i>mode</i> string begins with <tt>'r'</tt> and a component of <i>pathname</i> does not name an existing file, or <i>mode</i>
begins with <tt>'w'</tt> or <tt>'a'</tt> and a component of the path prefix of <i>pathname</i> does not name an existing file, or
<i>pathname</i> is an empty string. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[ENOENT] or [ENOTDIR]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border=
"0"><br>
The <i>pathname</i> argument contains at least one non-&lt;slash&gt; character and ends with one or more trailing &lt;slash&gt;
characters. If <i>pathname</i> without the trailing &lt;slash&gt; characters would name an existing file, an [ENOENT] error shall
not occur. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[ENOSPC]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The directory or file system that would contain the new file cannot be expanded, the file does not exist, and the file was to be
created. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[ENOTDIR]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> A
component of the path prefix names an existing file that is neither a directory nor a symbolic link to a directory, or the
<i>pathname</i> argument contains at least one non-&lt;slash&gt; character and ends with one or more trailing &lt;slash&gt;
characters and the last pathname component names an existing file that is neither a directory nor a symbolic link to a directory.
<img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[ENXIO]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The named file is a character special or block special file, and the device associated with this special file does not exist.
<img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[EOVERFLOW]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The named file is a regular file and the size of the file cannot be represented correctly in an object of type <b>off_t</b>.
<img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[EROFS]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The named file resides on a read-only file system and <i>mode</i> requires write access. <img src="../images/opt-end.gif" alt=
"[Option End]" border="0"></dd>
</dl>
<p class="tent">The <i>fopen</i>() function may fail if:</p>
<dl compact>
<dd></dd>
<dt>[EINVAL]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The value of the <i>mode</i> argument is not valid. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[ELOOP]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
More than {SYMLOOP_MAX} symbolic links were encountered during resolution of the <i>pathname</i> argument. <img src=
"../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[EMFILE]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
{FOPEN_MAX} streams are currently open in the calling process. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[ENAMETOOLONG]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border=
"0"><br>
The length of a component of a pathname is longer than {NAME_MAX}. <img src="../images/opt-end.gif" alt="[Option End]" border=
"0"></dd>
<dt>[ENOMEM]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
Insufficient storage space is available. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
<dt>[ETXTBSY]</dt>
<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The file is a pure procedure (shared text) file that is being executed and <i>mode</i> requires write access. <img src=
"../images/opt-end.gif" alt="[Option End]" border="0"></dd>
</dl>
</blockquote>
<hr>
<div class="box"><em>The following sections are informative.</em></div>
<h4 class="mansect"><a name="tag_17_171_06" id="tag_17_171_06"></a>EXAMPLES</h4>
<blockquote>
<h5><a name="tag_17_171_06_01" id="tag_17_171_06_01"></a>Opening a File</h5>
<p class="tent">The following example tries to open the file named <b>file</b> for reading. The <i>fopen</i>() function returns a
file pointer that is used in subsequent <a href="../functions/fgets.html"><i>fgets</i>()</a> and <a href=
"../functions/fclose.html"><i>fclose</i>()</a> calls. If the program cannot open the file, it just ignores it.</p>
<pre>
<tt>#include &lt;stdio.h&gt;
...
FILE *fp;
...
void rgrep(const char *file)
{
...
    if ((fp = fopen(file, "r")) == NULL)
        return;
...
}
</tt></pre></blockquote>
<h4 class="mansect"><a name="tag_17_171_07" id="tag_17_171_07"></a>APPLICATION USAGE</h4>
<blockquote>
<p>If an application needs to create a file in a way that fails if the file already exists, and either requires that it does not
have exclusive access to the file or does not need exclusive access, it should use <a href=
"../functions/open.html"><i>open</i>()</a> with the O_CREAT and O_EXCL flags instead of using <i>fopen</i>() with an <tt>'x'</tt>
in the mode. A stream can then be created, if needed, by calling <a href="../functions/fdopen.html"><i>fdopen</i>()</a> on the file
descriptor returned by <a href="../functions/open.html"><i>open</i>()</a>.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_171_08" id="tag_17_171_08"></a>RATIONALE</h4>
<blockquote>
<p>The <tt>'e'</tt> mode character is provided as a convenience to avoid a data race in multi-threaded applications. Without it, a
file descriptor is leaked into a child process created by one thread in the window between another thread creating a file
descriptor with <i>fopen</i>() and then using <a href="../functions/fileno.html"><i>fileno</i>()</a> and <a href=
"../functions/fcntl.html"><i>fcntl</i>()</a> to set the FD_CLOEXEC flag. It is also possible to avoid the race by using <a href=
"../functions/open.html"><i>open</i>()</a> with O_CLOEXEC followed by <a href="../functions/fdopen.html"><i>fdopen</i>()</a>,
however, there is no safe alternative for the <a href="../functions/freopen.html"><i>freopen</i>()</a> function, and consistency
dictates that the <tt>'e'</tt> modifier should be standardized for all functions that accept <i>mode</i> strings.</p>
<p class="tent">The ISO&nbsp;C standard only recognizes the <tt>'+'</tt>, <tt>'b'</tt>, and <tt>'x'</tt> characters in certain
positions of the <i>mode</i> string, leaving other arrangements as unspecified, and only permits <tt>'x'</tt> in <i>mode</i>
strings beginning with <tt>'w'</tt>. This standard specifically requires support for all characters other than the first in the
<i>mode</i> string to be recognized in any order. Thus, <tt>"wxe"</tt> and <tt>"wex"</tt> behave the same, and while <tt>"wx+"</tt>
is unspecified in the ISO&nbsp;C standard, this standard requires it to have the same behavior as <tt>"w+x"</tt>. This standard
also requires that <tt>'x'</tt> work for <i>mode</i> strings beginning with <tt>'a'</tt>, as well as having implementation-defined
behavior for <i>mode</i> strings beginning with <tt>'r'</tt>. Therefore, while <a href="../functions/open.html"><i>open</i>()</a>
has undefined behavior if O_EXCL is specified without O_CREAT, the same is not true of <i>fopen</i>().</p>
<p class="tent">When <tt>'x'</tt> is in mode, the ISO&nbsp;C standard requires that the file is created with exclusive access to
the extent that the underlying system supports exclusive access. Although POSIX.1 does not specify any method of enabling exclusive
access, it allows for the existence of an implementation-specific flag, or flags, that enable it. Note that they should be file
creation flags if a file is being created, not file access mode flags (that is, ones that are included in O_ACCMODE) or file status
flags, so that they do not affect the value returned by <a href="../functions/fcntl.html"><i>fcntl</i>()</a> with F_GETFL. On
implementations that have such flags, if support for them is file system dependent and exclusive access is requested when using
<i>fopen</i>() to create a file on a file system that does not support it, the flags must not be used if they would cause
<i>fopen</i>() to fail.</p>
<p class="tent">Some implementations support mandatory file locking as a means of enabling exclusive access to a file. Locks are
set in the normal way, but instead of only preventing others from setting conflicting locks they prevent others from accessing the
contents of the locked part of the file in a way that conflicts with the lock. However, unless the implementation has a way of
setting a whole-file write lock on file creation, this does not satisfy the requirement in the ISO&nbsp;C standard that the file is
&quot;created with exclusive access to the extent that the underlying system supports exclusive access&quot;. (Having <i>fopen</i>() create
the file and set a lock on the file as two separate operations is not the same, and it would introduce a race condition whereby
another process could open the file and write to it (or set a lock) in between the two operations.) However, on all implementations
that support mandatory file locking, its use is discouraged; therefore, it is recommended that implementations which support
mandatory file locking do not add a means of creating a file with a whole-file exclusive lock set, so that <i>fopen</i>() is not
required to enable mandatory file locking in order to conform to the ISO&nbsp;C standard. An implementation that has a means of
creating a file with a whole-file exclusive lock set would need to provide a way to change the behavior of <i>fopen</i>() depending
on whether the calling process is executing in a POSIX.1 conforming environment or an ISO C conforming environment.</p>
<p class="tent">The typical implementation-defined behavior for mode <tt>"rx"</tt> is to ignore the <tt>'x'</tt>, but the standard
developers did not wish to mandate this behavior. For example, an implementation could allow shared access for reading; that is,
disallow a file that has been opened this way from also being opened for writing.</p>
<p class="tent">Implementations are encouraged to have <i>fopen</i>() and <a href="../functions/freopen.html"><i>freopen</i>()</a>
report an [EILSEQ] error if <i>mode</i> begins with <tt>'w'</tt> or <tt>'a'</tt>, the file did not previously exist, and the last
component of <i>pathname</i> contains any bytes that have the encoded value of a &lt;newline&gt; character.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_171_09" id="tag_17_171_09"></a>FUTURE DIRECTIONS</h4>
<blockquote>
<p>None.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_171_10" id="tag_17_171_10"></a>SEE ALSO</h4>
<blockquote>
<p><a href="../functions/V2_chap02.html#tag_16_05"><i>2.5 Standard I/O Streams</i></a>, <a href=
"../functions/creat.html#"><i>creat</i>()</a>, <a href="../functions/fclose.html#"><i>fclose</i>()</a>, <a href=
"../functions/fdopen.html#"><i>fdopen</i>()</a>, <a href="../functions/fmemopen.html#"><i>fmemopen</i>()</a>, <a href=
"../functions/freopen.html#"><i>freopen</i>()</a>, <a href="../functions/open_memstream.html#"><i>open_memstream</i>()</a></p>
<p class="tent">XBD <a href="../basedefs/stdio.h.html"><i>&lt;stdio.h&gt;</i></a></p>
</blockquote>
<h4 class="mansect"><a name="tag_17_171_11" id="tag_17_171_11"></a>CHANGE HISTORY</h4>
<blockquote>
<p>First released in Issue 1. Derived from Issue 1 of the SVID.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_171_12" id="tag_17_171_12"></a>Issue 5</h4>
<blockquote>
<p>Large File Summit extensions are added.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_171_13" id="tag_17_171_13"></a>Issue 6</h4>
<blockquote>
<p>Extensions beyond the ISO&nbsp;C standard are marked.</p>
<p class="tent">The following new requirements on POSIX implementations derive from alignment with the Single UNIX
Specification:</p>
<ul>
<li class="tent">In the DESCRIPTION, text is added to indicate setting of the offset maximum in the open file description. This
change is to support large files.</li>
<li class="tent">In the ERRORS section, the [EOVERFLOW] condition is added. This change is to support large files.</li>
<li class="tent">The [ELOOP] mandatory error condition is added.</li>
<li class="tent">The [EINVAL], [EMFILE], [ENAMETOOLONG], [ENOMEM], and [ETXTBSY] optional error conditions are added.</li>
</ul>
<p class="tent">The normative text is updated to avoid use of the term &quot;must&quot; for application requirements.</p>
<p class="tent">The following changes are made for alignment with the ISO/IEC&nbsp;9899:1999 standard:</p>
<ul>
<li class="tent">The prototype for <i>fopen</i>() is updated.</li>
<li class="tent">The DESCRIPTION is updated to note that if the argument <i>mode</i> points to a string other than those listed,
then the behavior is undefined.</li>
</ul>
<p class="tent">The wording of the mandatory [ELOOP] error condition is updated, and a second optional [ELOOP] error condition is
added.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_171_14" id="tag_17_171_14"></a>Issue 7</h4>
<blockquote>
<p>Austin Group Interpretation 1003.1-2001 #025 is applied, clarifying the file creation mode.</p>
<p class="tent">Austin Group Interpretation 1003.1-2001 #143 is applied.</p>
<p class="tent">Austin Group Interpretation 1003.1-2001 #159 is applied, clarifying requirements for the flags set on the open file
description.</p>
<p class="tent">SD5-XBD-ERN-4 is applied, changing the definition of the [EMFILE] error.</p>
<p class="tent">SD5-XSH-ERN-149 is applied, changing the {STREAM_MAX} [EMFILE] error condition from a &quot;may fail&quot; to a &quot;shall
fail&quot;.</p>
<p class="tent">Changes are made related to support for finegrained timestamps.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XSH/TC1-2008/0156 [291,433], XSH/TC1-2008/0157 [146,433], XSH/TC1-2008/0158
[324], and XSH/TC1-2008/0159 [14] are applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XSH/TC2-2008/0122 [822] is applied.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_171_15" id="tag_17_171_15"></a>Issue 8</h4>
<blockquote>
<p>Austin Group Defect 251 is applied, encouraging implementations to disallow the creation of filenames containing any bytes that
have the encoded value of a &lt;newline&gt; character.</p>
<p class="tent">Austin Group Defect 293 is applied, adding the [EILSEQ] error.</p>
<p class="tent">Austin Group Defects 411 and 1524 are applied, adding the <tt>'e'</tt> and <tt>'x'</tt> <i>mode</i> string
characters.</p>
<p class="tent">Austin Group Defect 1200 is applied, correcting the argument name in the [ELOOP] errors.</p>
<p class="tent">Austin Group Defect 1302 is applied, aligning this function with the ISO/IEC&nbsp;9899:2018 standard.</p>
</blockquote>
<div class="box"><em>End of informative text.</em></div>
<hr>
<p>&nbsp;</p>
<a href="#top"><span class="topOfPage">return to top of page</span></a><br>
<hr size="2" noshade>
<center><font size="2">UNIX® is a registered Trademark of The Open Group.<br>
POSIX™ is a Trademark of The IEEE.<br>
Copyright © 2001-2024 The IEEE and The Open Group, All Rights Reserved<br>
[ <a href="../mindex.html">Main Index</a> | <a href="../basedefs/contents.html">XBD</a> | <a href=
"../functions/contents.html">XSH</a> | <a href="../utilities/contents.html">XCU</a> | <a href="../xrat/contents.html">XRAT</a>
]</font></center>
<hr size="2" noshade>
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/fnmatch.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/fork.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>
<hr align="left" width="100%"></div>
</body>
</html>
