<!-- Copyright 2001-2024 IEEE and The Open Group, All Rights Reserved -->
<!DOCTYPE HTML>
<html lang="en">
<head>
<meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.8.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link type="text/css" rel="stylesheet" href="style.css"><!-- Generated by The Open Group rhtm tool v1.2.4 -->
<!-- Copyright (c) 2001-2024 The Open Group, All Rights Reserved -->
<title>Rationale for Shell and Utilities</title>
</head>
<body bgcolor="white">
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../xrat/V4_xsh_chap01.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../xrat/V4_port.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>
<hr align="left" width="100%"></div>
<center><font size="2">The Open Group Base Specifications Issue 8<br>
IEEE Std 1003.1-2024<br>
Copyright Â© 2001-2024 The IEEE and The Open Group</font></center>
<hr size="2" noshade>
<a name="top" id="top"></a>
<h2><a name="tag_23" id="tag_23"></a>C. Rationale for Shell and Utilities</h2>
<h3><a name="tag_23_01" id="tag_23_01"></a>C.1 Introduction</h3>
<h4><a name="tag_23_01_01" id="tag_23_01_01"></a>C.1.1 Change History</h4>
<p>The change history is provided as an informative section, to track changes from earlier versions of this standard.</p>
<p>The following sections describe changes made to the Shell and Utilities volume of POSIX.1-2024 since Issue 7 of the base
document. The CHANGE HISTORY section for each utility describes technical changes made to that utility in Issue 5 and later.
Changes made before Issue 5 are not included.</p>
<h5><a name="tag_23_01_01_01" id="tag_23_01_01_01"></a>Changes from Issue 7 to Issue 8 (POSIX.1-2024)</h5>
<p>The following list summarizes the major changes that were made in the Shell and Utilities volume of POSIX.1-2024 from Issue 7 to
Issue 8:</p>
<ul>
<li>
<p>The Open Group Standard, 2022, Additional APIs for the Base Specifications Issue 8, Part 2 is incorporated.</p>
</li>
<li>
<p>Austin Group defect reports and IEEE Interpretations against IEEE Std 1003.1 are applied.</p>
</li>
<li>
<p>The Open Group corrigenda and resolutions are applied.</p>
</li>
<li>
<p>Features, marked obsolescent in the base document, have been considered for removal in this version.</p>
</li>
</ul>
<h5><a name="tag_23_01_01_02" id="tag_23_01_01_02"></a>New Features in Issue 8</h5>
<p>The utilities first introduced in Issue 8 (over the Issue 7 base document) are as follows:</p>
<center>
<table border="1" cellpadding="3" align="center">
<tr valign="top">
<th colspan="3" align="center">
<p class="tent"><b>New Utilities in Issue 8</b></p>
</th>
</tr>
<tr valign="top">
<td align="left">
<p class="tent"><br>
<a href="../utilities/gettext.html"><i>gettext</i></a><br>
<a href="../utilities/msgfmt.html"><i>msgfmt</i></a><br>
<a href="../utilities/ngettext.html"><i>ngettext</i></a><br>
&nbsp;</p>
</td>
<td align="left">
<p class="tent"><br>
<a href="../utilities/readlink.html"><i>readlink</i></a><br>
<a href="../utilities/realpath.html"><i>realpath</i></a><br>
<a href="../utilities/timeout.html"><i>timeout</i></a><br>
&nbsp;</p>
</td>
<td align="left">
<p class="tent"><br>
<a href="../utilities/xgettext.html"><i>xgettext</i></a><br>
&nbsp;</p>
</td>
</tr>
</table>
</center>
<h5><a name="tag_23_01_01_03" id="tag_23_01_01_03"></a>Removed Utilities in Issue 8</h5>
<p class="tent">The utilities removed in Issue 8 (from the Issue 7 base document) are as follows:</p>
<center>
<table border="1" cellpadding="3" align="center">
<tr valign="top">
<th colspan="3" align="center">
<p class="tent"><b>Removed Utilities in Issue 8</b></p>
</th>
</tr>
<tr valign="top">
<td align="left">
<p class="tent"><br>
<i>fort77</i><br>
<i>qalter</i><br>
<i>qdel</i><br>
<i>qhold</i><br>
&nbsp;</p>
</td>
<td align="left">
<p class="tent"><br>
<i>qmove</i><br>
<i>qmsg</i><br>
<i>qrerun</i><br>
<i>qrls</i><br>
&nbsp;</p>
</td>
<td align="left">
<p class="tent"><br>
<i>qselect</i><br>
<i>qsig</i><br>
<i>qstat</i><br>
<i>qsub</i><br>
&nbsp;</p>
</td>
</tr>
</table>
</center>
<h4><a name="tag_23_01_02" id="tag_23_01_02"></a>C.1.2 Relationship to Other Documents</h4>
<h5 class="header4"><a name="tag_23_01_02_01" id="tag_23_01_02_01"></a>C.1.2.1 System Interfaces</h5>
<p class="tent">It has been pointed out that the Shell and Utilities volume of POSIX.1-2024 assumes that a great deal of
functionality from the System Interfaces volume of POSIX.1-2024 is present, but never states exactly how much (and strictly does
not need to since both are mandated on a conforming system). This section is an attempt to clarify the assumptions.</p>
<h5><a name="tag_23_01_02_02" id="tag_23_01_02_02"></a>File Read, Write, and Creation</h5>
<p class="tent">IEEE&nbsp;Std&nbsp;1003.1-2001/Cor&nbsp;2-2004, item XCU/TC2/D6/2 is applied, updating Table 1-1.</p>
<h5><a name="tag_23_01_02_03" id="tag_23_01_02_03"></a>File Removal</h5>
<p class="tent">This is intended to be a summary of the <a href="../functions/unlink.html"><i>unlink</i>()</a> and <a href=
"../functions/rmdir.html"><i>rmdir</i>()</a> requirements. Note that it is possible using the <a href=
"../functions/unlink.html"><i>unlink</i>()</a> function for item 4. to occur.</p>
<h5 class="header4"><a name="tag_23_01_02_04" id="tag_23_01_02_04"></a>C.1.2.2 Concepts Derived from the ISO C Standard</h5>
<p class="tent">This section was introduced to address the issue that there was insufficient detail presented by such utilities as
<a href="../utilities/awk.html"><i>awk</i></a> or <a href="../utilities/sh.html"><i>sh</i></a> about their procedural control
statements and their methods of performing arithmetic functions.</p>
<p class="tent">The ISO&nbsp;C standard was selected as a model because most historical implementations of the standard utilities
were written in C. Thus, it was more likely that they would act in the desired manner without modification.</p>
<p class="tent">Using the ISO&nbsp;C standard is primarily a notational convenience so that the many procedural languages in the
Shell and Utilities volume of POSIX.1-2024 would not have to be rigorously described in every aspect. Its selection does not
require that the standard utilities be written in Standard C; they could be written in Common Usage C, Ada, Pascal, assembler
language, or anything else.</p>
<p class="tent">The sizes of the various numeric values refer to C-language data types that are allowed to be different sizes by
the ISO&nbsp;C standard. Thus, like a C-language application, a shell application cannot rely on their exact size. However, it can
rely on their minimum sizes expressed in the ISO&nbsp;C standard, such as {LONG_MAX} for a <b>long</b> type.</p>
<p class="tent">The behavior on overflow is undefined for ISO&nbsp;C standard arithmetic. Therefore, the standard utilities can use
&quot;bignum&quot; representation for integers so that there is no fixed maximum unless otherwise stated in the utility description.
Similarly, standard utilities can use infinite-precision representations for floating-point arithmetic, as long as these
representations exceed the ISO&nbsp;C standard requirements.</p>
<p class="tent">This section addresses only the issue of semantics; it is not intended to specify syntax. For example, the
ISO&nbsp;C standard requires that 0L be recognized as an integer constant equal to zero, but utilities such as <a href=
"../utilities/awk.html"><i>awk</i></a> and <a href="../utilities/sh.html"><i>sh</i></a> are not required to recognize 0L (though
they are allowed to, as an extension).</p>
<p class="tent">The ISO&nbsp;C standard requires that a C compiler must issue a diagnostic for constants that are too large to
represent. Most standard utilities are not required to issue these diagnostics; for example, the command:</p>
<pre>
<tt>diff -C 2147483648 file1 file2
</tt></pre>
<p class="tent">has undefined behavior, and the <a href="../utilities/diff.html"><i>diff</i></a> utility is not required to issue a
diagnostic even if the number 2147483648 cannot be represented.</p>
<p class="tent">Austin Group Defect 1128 is applied, adding a note about the comma operator.</p>
<h4><a name="tag_23_01_03" id="tag_23_01_03"></a>C.1.3 Utility Limits</h4>
<p class="tent">This section grew out of an idea that originated with the original POSIX.1, in the tables of system limits for the
<a href="../functions/sysconf.html"><i>sysconf</i>()</a> and <a href="../functions/pathconf.html"><i>pathconf</i>()</a> functions.
The idea being that a conforming application can be written to use the most restrictive values that a minimal system can provide,
but it should not have to. The values provided represent compromises so that some vendors can use historically limited versions of
UNIX system utilities. They are the highest values that a strictly conforming application can assume, given no other
information.</p>
<p class="tent">However, by using the <a href="../utilities/getconf.html"><i>getconf</i></a> utility or the <a href=
"../functions/sysconf.html"><i>sysconf</i>()</a> function, the elegant application can be tailored to more liberal values on some
of the specific instances of specific implementations.</p>
<p class="tent">There is no explicitly stated requirement that an implementation provide finite limits for any of these numeric
values; the implementation is free to provide essentially unbounded capabilities (where it makes sense), stopping only at
reasonable points such as {ULONG_MAX} (from the ISO&nbsp;C standard). Therefore, applications desiring to tailor themselves to the
values on a particular implementation need to be ready for possibly huge values; it may not be a good idea to allocate blindly a
buffer for an input line based on the value of {LINE_MAX}, for instance. However, unlike the System Interfaces volume of
POSIX.1-2024, there is no set of limits that return a special indication meaning &quot;unbounded&quot;. The implementation should always
return an actual number, even if the number is very large.</p>
<p class="tent">The statement:</p>
<blockquote>
<pre>
&quot;It is not guaranteed that the application ...&quot;
</pre></blockquote>
<p class="tent">is an indication that many of these limits are designed to ensure that implementors design their utilities without
arbitrary constraints related to unimaginative programming. There are certainly conditions under which combinations of options can
cause failures that would not render an implementation non-conforming. For example, {EXPR_NEST_MAX} and {ARG_MAX} could collide
when expressions are large; combinations of {BC_SCALE_MAX} and {BC_DIM_MAX} could exceed virtual memory.</p>
<p class="tent">In the Shell and Utilities volume of POSIX.1-2024, the notion of a limit being guaranteed for the process lifetime,
as it is in the System Interfaces volume of POSIX.1-2024, is not as useful to a shell script. The <a href=
"../utilities/getconf.html"><i>getconf</i></a> utility is probably a process itself, so the guarantee would be without value.
Therefore, the Shell and Utilities volume of POSIX.1-2024 requires the guarantee to be for the session lifetime. This will mean
that many vendors will either return very conservative values or possibly implement <a href=
"../utilities/getconf.html"><i>getconf</i></a> as a built-in.</p>
<p class="tent">It may seem confusing to have limits that apply only to a single utility grouped into one global section. However,
the alternative, which would be to disperse them out into their utility description sections, would cause great difficulty when
<a href="../functions/sysconf.html"><i>sysconf</i>()</a> and <a href="../utilities/getconf.html"><i>getconf</i></a> were described.
Therefore, the standard developers chose the global approach.</p>
<p class="tent">Each language binding could provide symbol names that are slightly different from those shown here. For example,
the C-Language Binding option adds a leading &lt;underscore&gt; to the symbols as a prefix.</p>
<p class="tent">The following comments describe selection criteria for the symbols and their values:</p>
<dl compact>
<dd></dd>
<dt>{ARG_MAX}</dt>
<dd>
This is defined by the System Interfaces volume of POSIX.1-2024. Unfortunately, it is very difficult for a conforming application
to deal with this value, as it does not know how much of its argument space is being consumed by the environment variables of the
user.<br></dd>
<dt>{BC_BASE_MAX}</dt>
<dd></dd>
<dt>{BC_DIM_MAX}</dt>
<dd></dd>
<dt>{BC_SCALE_MAX}</dt>
<dd>
These were originally one value, {BC_SCALE_MAX}, but it was unreasonable to link all three concepts into one limit.</dd>
<dt>{CHILD_MAX}</dt>
<dd>
This is defined by the System Interfaces volume of POSIX.1-2024.</dd>
<dt>{COLL_WEIGHTS_MAX}</dt>
<dd>
The weights assigned to <b>order</b> can be considered as &quot;passes&quot; through the collation algorithm.</dd>
<dt>{EXPR_NEST_MAX}</dt>
<dd>
The value for expression nesting was borrowed from the ISO&nbsp;C standard.</dd>
<dt>{LINE_MAX}</dt>
<dd>
This is a global limit that affects all utilities, unless otherwise noted. The {MAX_CANON} value from the System Interfaces volume
of POSIX.1-2024 may further limit input lines from terminals. The {LINE_MAX} value was the subject of much debate and is a
compromise between those who wished to have unlimited lines and those who understood that many historical utilities were written
with fixed buffers. Frequently, utility writers selected the UNIX system constant BUFSIZ to allocate these buffers; therefore, some
utilities were limited to 512 bytes for I/O lines, while others achieved 4096 bytes or greater.
<p class="tent">It should be noted that {LINE_MAX} applies only to input line length; there is no requirement in POSIX.1-2024 that
limits the length of output lines. Utilities such as <a href="../utilities/awk.html"><i>awk</i></a>, <a href=
"../utilities/sed.html"><i>sed</i></a>, and <a href="../utilities/paste.html"><i>paste</i></a> could theoretically construct lines
longer than any of the input lines they received, depending on the options used or the instructions from the application. They are
not required to truncate their output to {LINE_MAX}. It is the responsibility of the application to deal with this. If the output
of one of those utilities is to be piped into another of the standard utilities, line length restrictions will have to be
considered; the <a href="../utilities/fold.html"><i>fold</i></a> utility, among others, could be used to ensure that only
reasonable line lengths reach utilities or applications.</p>
</dd>
<dt>{LINK_MAX}</dt>
<dd>
This is defined by the System Interfaces volume of POSIX.1-2024.</dd>
<dt>{MAX_CANON}</dt>
<dd></dd>
<dt>{MAX_INPUT}</dt>
<dd></dd>
<dt>{NAME_MAX}</dt>
<dd></dd>
<dt>{NGROUPS_MAX}</dt>
<dd></dd>
<dt>{OPEN_MAX}</dt>
<dd></dd>
<dt>{PATH_MAX}</dt>
<dd></dd>
<dt>{PIPE_BUF}</dt>
<dd>
These limits are defined by the System Interfaces volume of POSIX.1-2024. Note that the byte lengths described by some of these
values continue to represent bytes, even if the applicable character set uses a multi-byte encoding.</dd>
<dt>{RE_DUP_MAX}</dt>
<dd>
The value selected is consistent with historical practice. Although the name implies that it applies to all REs, only BREs use the
interval notation <b>\{</b><i>m,n</i><b>\}</b> addressed by this limit.</dd>
<dt>{POSIX2_SYMLINKS}</dt>
<dd>
The {POSIX2_SYMLINKS} variable indicates that the underlying operating system supports the creation of symbolic links in specific
directories. Many of the utilities defined in POSIX.1-2024 that deal with symbolic links do not depend on this value. For example,
a utility that follows symbolic links (or does not, as the case may be) will only be affected by a symbolic link if it encounters
one. Presumably, a file system that does not support symbolic links will not contain any. This variable does affect such utilities
as <a href="../utilities/ln.html"><i>ln</i></a> <b>-s</b> and <a href="../utilities/pax.html"><i>pax</i></a> that attempt to create
symbolic links.</dd>
</dl>
<p class="tent">There are different limits associated with command lines and input to utilities, depending on the method of
invocation. In the case of a C program <i>exec</i>-ing a utility, {ARG_MAX} is the underlying limit. In the case of the shell
reading a script and <i>exec</i>-ing a utility, {LINE_MAX} limits the length of lines the shell is required to process, and
{ARG_MAX} will still be a limit. If a user is entering a command on a terminal to the shell, requesting that it invoke the utility,
{MAX_INPUT} may restrict the length of the line that can be given to the shell to a value below {LINE_MAX}.</p>
<p class="tent">When an option is supported, <a href="../utilities/getconf.html"><i>getconf</i></a> returns a value of 1. For
example, when C development is supported:</p>
<pre>
<tt>if [ "$(getconf POSIX2_C_DEV)" -eq 1 ]; then
    echo C supported
fi
</tt></pre>
<p class="tent">The <a href="../functions/sysconf.html"><i>sysconf</i>()</a> function in the C-Language Binding option would return
1.</p>
<p class="tent">The following comments describe selection criteria for the symbols and their values:</p>
<dl compact>
<dd></dd>
<dt>POSIX2_C_BIND</dt>
<dd></dd>
<dt>POSIX2_C_DEV</dt>
<dd></dd>
<dt>POSIX2_FORT_RUN</dt>
<dd></dd>
<dt>POSIX2_SW_DEV</dt>
<dd></dd>
<dt>POSIX2_UPE</dt>
<dd>
It is possible for some (usually privileged) operations to remove utilities that support these options or otherwise to render these
options unsupported. The header files, the <a href="../functions/sysconf.html"><i>sysconf</i>()</a> function, or the <a href=
"../utilities/getconf.html"><i>getconf</i></a> utility will not necessarily detect such actions, in which case they should not be
considered as rendering the implementation non-conforming. A test suite should not attempt tests such as:
<pre>
<tt>rm /usr/bin/c17
getconf POSIX2_C_DEV
</tt></pre></dd>
<dt>POSIX2_LOCALEDEF</dt>
<dd>
This symbol was introduced to allow implementations to restrict supported locales to only those supplied by the
implementation.</dd>
</dl>
<p class="tent">IEEE&nbsp;Std&nbsp;1003.1-2001/Cor&nbsp;1-2002, item XCU/TC1/D6/2 is applied, deleting the entry for
{POSIX2_VERSION} since it is not a utility limit minimum value.</p>
<p class="tent">IEEE&nbsp;Std&nbsp;1003.1-2001/Cor&nbsp;1-2002, item XCU/TC1/D6/3 is applied, changing the text in Utility Limits
from: &quot;utility (see <a href="../utilities/getconf.html"><i>getconf</i></a>) through the <a href=
"../functions/sysconf.html"><i>sysconf</i>()</a> function defined in the System Interfaces volume of POSIX.1-2024. The literal
names shown in Table 1-3 apply only to the <a href="../utilities/getconf.html"><i>getconf</i></a> utility; the high-level language
binding describes the exact form of each name to be used by the interfaces in that binding.&quot; to: &quot;utility (see <a href=
"../utilities/getconf.html"><i>getconf</i></a>).&quot;.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0001 [666] is applied.</p>
<h4><a name="tag_23_01_04" id="tag_23_01_04"></a>C.1.4 Grammar Conventions</h4>
<p class="tent">There is no additional rationale provided for this section.</p>
<h4><a name="tag_23_01_05" id="tag_23_01_05"></a>C.1.5 Utility Description Defaults</h4>
<p class="tent">This section is arranged with headings in the same order as all the utility descriptions. It is a collection of
related and unrelated information concerning:</p>
<ol>
<li class="tent">The default actions of utilities</li>
<li class="tent">The meanings of notations used in POSIX.1-2024 that are specific to individual utility sections</li>
</ol>
<p class="tent">Although this material may seem out of place here, it is important that this information appear before any of the
utilities to be described later.</p>
<h5><a name="tag_23_01_05_01" id="tag_23_01_05_01"></a>NAME</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5><a name="tag_23_01_05_02" id="tag_23_01_05_02"></a>SYNOPSIS</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5><a name="tag_23_01_05_03" id="tag_23_01_05_03"></a>DESCRIPTION</h5>
<p class="tent">Austin Group Defect 351 is applied, adding a requirement relating to declaration utilities.</p>
<h5><a name="tag_23_01_05_04" id="tag_23_01_05_04"></a>OPTIONS</h5>
<p class="tent">Although it has not always been possible, the standard developers tried to avoid repeating information to reduce
the risk that duplicate explanations could each be modified differently.</p>
<p class="tent">The need to recognize <b>--</b> is required because conforming applications need to shield their operands from any
arbitrary options that the implementation may provide as an extension. For example, if the standard utility <i>foo</i> is listed as
taking no options, and the application needed to give it a pathname with a leading &lt;hyphen-minus&gt;, it could safely do it
as:</p>
<pre>
<tt>foo -- -myfile
</tt></pre>
<p class="tent">and avoid any problems with <b>-m</b> used as an extension.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0002 [584] is applied.</p>
<h5><a name="tag_23_01_05_05" id="tag_23_01_05_05"></a>OPERANDS</h5>
<p class="tent">The usage of <b>-</b> is never shown in the SYNOPSIS. Similarly, the usage of <b>--</b> is never shown.</p>
<p class="tent">The requirement for processing operands in command-line order is to avoid a &quot;WeirdNIX&quot; utility that might choose
to sort the input files alphabetically, by size, or by directory order. Although this might be acceptable for some utilities, in
general the programmer has a right to know exactly what order will be chosen.</p>
<p class="tent">Some of the standard utilities take multiple <i>file</i> operands and act as if they were processing the
concatenation of those files. For example:</p>
<pre>
<tt>asa file1 file2
</tt></pre>
<p class="tent">and:</p>
<pre>
<tt>cat file1 file2 | asa
</tt></pre>
<p class="tent">have similar results when questions of file access, errors, and performance are ignored. Other utilities such as
<a href="../utilities/grep.html"><i>grep</i></a> or <a href="../utilities/wc.html"><i>wc</i></a> have completely different results
in these two cases. This latter type of utility is always identified in its DESCRIPTION or OPERANDS sections, whereas the former is
not. Although it might be possible to create a general assertion about the former case, the following points must be addressed:</p>
<ul>
<li class="tent">Access times for the files might be different in the operand case <i>versus</i> the <a href=
"../utilities/cat.html"><i>cat</i></a> case.</li>
<li class="tent">The utility may have error messages that are cognizant of the input filename, and this added value should not be
suppressed. (As an example, <a href="../utilities/awk.html"><i>awk</i></a> sets a variable with the filename at each file
boundary.)</li>
</ul>
<h5><a name="tag_23_01_05_06" id="tag_23_01_05_06"></a>STDIN</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5><a name="tag_23_01_05_07" id="tag_23_01_05_07"></a>INPUT FILES</h5>
<p class="tent">A conforming application cannot assume the following three commands are equivalent:</p>
<pre>
<tt>tail -n +2 file
(sed -n 1q; cat) &lt; file
cat file | (sed -n 1q; cat)
</tt></pre>
<p class="tent">The second command is equivalent to the first only when the file is seekable. In the third command, if the file
offset in the open file description were not unspecified, <a href="../utilities/sed.html"><i>sed</i></a> would have to be
implemented so that it read from the pipe 1 byte at a time or it would have to employ some method to seek backwards on the pipe.
Such functionality is not defined currently in POSIX.1 and does not exist on all historical systems. Other utilities, such as
<a href="../utilities/head.html"><i>head</i></a>, <a href="../utilities/read.html"><i>read</i></a>, and <a href=
"../utilities/sh.html"><i>sh</i></a>, have similar properties, so the restriction is described globally in this section.</p>
<p class="tent">The definition of &quot;text file&quot; is strictly enforced for input to the standard utilities; very few of them list
exceptions to the undefined results called for here. (Of course, &quot;undefined&quot; here does not mean that historical implementations
necessarily have to change to start indicating error conditions. Conforming applications cannot rely on implementations succeeding
or failing when non-text files are used.)</p>
<p class="tent">The utilities that allow line continuation are generally those that accept input languages, rather than pure data.
It would be unusual for an input line of this type to exceed {LINE_MAX} bytes and unreasonable to require that the implementation
allow unlimited accumulation of multiple lines, each of which could reach {LINE_MAX}. Thus, for a conforming application the total
of all the continued lines in a set cannot exceed {LINE_MAX}.</p>
<p class="tent">The format description is intended to be sufficiently rigorous to allow other applications to generate these input
files. However, since &lt;blank&gt; characters can legitimately be included in some of the fields described by the standard
utilities, particularly in locales other than the POSIX locale, this intent is not always realized.</p>
<h5><a name="tag_23_01_05_08" id="tag_23_01_05_08"></a>ENVIRONMENT VARIABLES</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5><a name="tag_23_01_05_09" id="tag_23_01_05_09"></a>ASYNCHRONOUS EVENTS</h5>
<p class="tent">Because there is no language prohibiting it, a utility is permitted to catch a signal, perform some additional
processing (such as deleting temporary files), restore the default signal action, and resignal itself.</p>
<p class="tent">Austin Group Defects 1648 and 1772 are applied, clarifying the default behavior for signal handling.</p>
<h5><a name="tag_23_01_05_10" id="tag_23_01_05_10"></a>STDOUT</h5>
<p class="tent">The format description is intended to be sufficiently rigorous to allow post-processing of output by other
programs, particularly by an <a href="../utilities/awk.html"><i>awk</i></a> or <a href="../utilities/lex.html"><i>lex</i></a>
parser.</p>
<h5><a name="tag_23_01_05_11" id="tag_23_01_05_11"></a>STDERR</h5>
<p class="tent">This section does not describe error messages that refer to incorrect operation of the utility. Consider a utility
that processes program source code as its input. This section is used to describe messages produced by a correctly operating
utility that encounters an error in the program source code on which it is processing. However, a message indicating that the
utility had insufficient memory in which to operate would not be described.</p>
<p class="tent">Some utilities have traditionally produced warning messages without returning a non-zero exit status; these are
specifically noted in their sections. Other utilities shall not write to standard error if they complete successfully, unless the
implementation provides some sort of extension to increase the verbosity or debugging level.</p>
<p class="tent">The format descriptions are intended to be sufficiently rigorous to allow post-processing of output by other
programs.</p>
<h5><a name="tag_23_01_05_12" id="tag_23_01_05_12"></a>OUTPUT FILES</h5>
<p class="tent">The format description is intended to be sufficiently rigorous to allow post-processing of output by other
programs, particularly by an <a href="../utilities/awk.html"><i>awk</i></a> or <a href="../utilities/lex.html"><i>lex</i></a>
parser.</p>
<p class="tent">Receipt of the SIGQUIT signal should generally cause termination (unless in some debugging mode) that would bypass
any attempted recovery actions.</p>
<h5><a name="tag_23_01_05_13" id="tag_23_01_05_13"></a>EXTENDED DESCRIPTION</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5><a name="tag_23_01_05_14" id="tag_23_01_05_14"></a>EXIT STATUS</h5>
<p class="tent">Note the additional discussion of exit values in <i>Exit Status for Commands</i> in the <a href=
"../utilities/sh.html"><i>sh</i></a> utility. It describes requirements for returning exit values greater than 125.</p>
<p class="tent">A utility may list zero as a successful return, 1 as a failure for a specific reason, and greater than 1 as &quot;an
error occurred&quot;. In this case, unspecified conditions may cause a 2 or 3, or other value, to be returned. A strictly conforming
application should be written so that it tests for successful exit status values (zero in this case), rather than relying upon the
single specific error value listed in POSIX.1-2024. In that way, it will have maximum portability, even on implementations with
extensions.</p>
<p class="tent">The standard developers are aware that the general non-enumeration of errors makes it difficult to write test
suites that test the <i>incorrect</i> operation of utilities. There are some historical implementations that have expended effort
to provide detailed status messages and a helpful environment to bypass or explain errors, such as prompting, retrying, or ignoring
unimportant syntax errors; other implementations have not. Since there is no realistic way to mandate system behavior in cases of
undefined application actions or system problemsâin a manner acceptable to all cultures and environmentsâattention has been limited
to the correct operation of utilities by the conforming application. Furthermore, the conforming application does not need detailed
information concerning errors that it caused through incorrect usage or that it cannot correct.</p>
<p class="tent">Austin Group Defect 1492 is applied, adding the <b>Default Behavior</b> paragraph.</p>
<h5><a name="tag_23_01_05_15" id="tag_23_01_05_15"></a>CONSEQUENCES OF ERRORS</h5>
<p class="tent">Several actions are possible when a utility encounters an error condition, depending on the severity of the error
and the state of the utility. Included in the possible actions of various utilities are: deletion of temporary or intermediate work
files; deletion of incomplete files; and validity checking of the file system or directory.</p>
<p class="tent">The text about recursive traversing is meant to ensure that utilities such as <a href=
"../utilities/find.html"><i>find</i></a> process as many files in the hierarchy as they can. They should not abandon all of the
hierarchy at the first error and resume with the next command-line operand, but should attempt to keep going.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0001 [150] is applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0003 [913] is applied.</p>
<p class="tent">Austin Group Defect 251 is applied, adding a note about the treatment of pathnames containing any bytes that have
the encoded value of a &lt;newline&gt; character.</p>
<p class="tent">Austin Group Defect 1499 is applied, requiring utilities to exit with an exit status that indicates an error
occurred, instead of any non-zero exit status.</p>
<h5><a name="tag_23_01_05_16" id="tag_23_01_05_16"></a>APPLICATION USAGE</h5>
<p class="tent">This section provides additional caveats, issues, and recommendations to the developer.</p>
<h5><a name="tag_23_01_05_17" id="tag_23_01_05_17"></a>EXAMPLES</h5>
<p class="tent">This section provides sample usage.</p>
<h5><a name="tag_23_01_05_18" id="tag_23_01_05_18"></a>RATIONALE</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5><a name="tag_23_01_05_19" id="tag_23_01_05_19"></a>FUTURE DIRECTIONS</h5>
<p class="tent">FUTURE DIRECTIONS sections act as pointers to related work that may impact the interface in the future, and often
cautions the developer to architect the code to account for a change in this area. Note that a future directions statement should
not be taken as a commitment to adopt a feature or interface in the future.</p>
<h5><a name="tag_23_01_05_20" id="tag_23_01_05_20"></a>SEE ALSO</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5><a name="tag_23_01_05_21" id="tag_23_01_05_21"></a>CHANGE HISTORY</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h4><a name="tag_23_01_06" id="tag_23_01_06"></a>C.1.6 Considerations for Utilities in Support of Files of Arbitrary Size</h4>
<p class="tent">This section is intended to clarify the requirements for utilities in support of large files.</p>
<p class="tent">The utilities listed in this section are utilities which are used to perform administrative tasks such as to
create, move, copy, remove, change the permissions, or measure the resources of a file. They are useful both as end-user tools and
as utilities invoked by applications during software installation and operation.</p>
<p class="tent">The <a href="../utilities/chgrp.html"><i>chgrp</i></a>, <a href="../utilities/chmod.html"><i>chmod</i></a>,
<a href="../utilities/chown.html"><i>chown</i></a>, <a href="../utilities/ln.html"><i>ln</i></a>, and <a href=
"../utilities/rm.html"><i>rm</i></a> utilities probably require use of large file-capable versions of <a href=
"../functions/stat.html"><i>stat</i>()</a>, <a href="../functions/lstat.html"><i>lstat</i>()</a>, <a href=
"../functions/nftw.html"><i>nftw</i>()</a>, and the <b>stat</b> structure.</p>
<p class="tent">The <a href="../utilities/cat.html"><i>cat</i></a>, <a href="../utilities/cksum.html"><i>cksum</i></a>, <a href=
"../utilities/cmp.html"><i>cmp</i></a>, <a href="../utilities/cp.html"><i>cp</i></a>, <a href="../utilities/dd.html"><i>dd</i></a>,
<a href="../utilities/mv.html"><i>mv</i></a>, and <a href="../utilities/touch.html"><i>touch</i></a> utilities probably require use
of large file-capable versions of <a href="../functions/creat.html"><i>creat</i>()</a>, <a href=
"../functions/open.html"><i>open</i>()</a>, and <a href="../functions/fopen.html"><i>fopen</i>()</a>.</p>
<p class="tent">The <a href="../utilities/cat.html"><i>cat</i></a>, <a href="../utilities/cksum.html"><i>cksum</i></a>, <a href=
"../utilities/cmp.html"><i>cmp</i></a>, <a href="../utilities/dd.html"><i>dd</i></a>, <a href="../utilities/df.html"><i>df</i></a>,
<a href="../utilities/du.html"><i>du</i></a>, and <a href="../utilities/ls.html"><i>ls</i></a> utilities may require writing large
integer values. For example:</p>
<ul>
<li class="tent">The <a href="../utilities/cat.html"><i>cat</i></a> utility might have a <b>-n</b> option which counts
&lt;newline&gt; characters.</li>
<li class="tent">The <a href="../utilities/cksum.html"><i>cksum</i></a> and <a href="../utilities/ls.html"><i>ls</i></a> utilities
report file sizes.</li>
<li class="tent">The <a href="../utilities/cmp.html"><i>cmp</i></a> utility reports the line number at which the first difference
occurs, and also has a <b>-l</b> option which reports file offsets.</li>
<li class="tent">The <a href="../utilities/dd.html"><i>dd</i></a>, <a href="../utilities/df.html"><i>df</i></a>, <a href=
"../utilities/du.html"><i>du</i></a>, and <a href="../utilities/ls.html"><i>ls</i></a> utilities report block counts.</li>
</ul>
<p class="tent">The <a href="../utilities/dd.html"><i>dd</i></a>, <a href="../utilities/find.html"><i>find</i></a>, and <a href=
"../utilities/test.html"><i>test</i></a> utilities may need to interpret command arguments that contain 64-bit values. For <a href=
"../utilities/dd.html"><i>dd</i></a>, the arguments include <i>skip</i>=<i>n</i>, <i>seek</i>=<i>n</i>, and <i>count</i>=<i>n</i>.
For <a href="../utilities/find.html"><i>find</i></a>, the arguments include <b>-size</b><i>n</i>. For <a href=
"../utilities/test.html"><i>test</i></a>, the arguments are those associated with algebraic comparisons.</p>
<p class="tent">The <a href="../utilities/df.html"><i>df</i></a> utility might need to access large file systems with <a href=
"../functions/statvfs.html"><i>statvfs</i>()</a>.</p>
<p class="tent">The <a href="../utilities/ulimit.html"><i>ulimit</i></a> utility will need to use large file-capable versions of
<a href="../functions/getrlimit.html"><i>getrlimit</i>()</a> and <a href="../functions/setrlimit.html"><i>setrlimit</i>()</a> and
be able to read and write large integer values.</p>
<p class="tent">Austin Group Defect 1568 is applied, removing references to the <i>sum</i> utility.</p>
<h4><a name="tag_23_01_07" id="tag_23_01_07"></a>C.1.7 Built-In Utilities</h4>
<p class="tent">Other than the special built-in utilities, there is no requirement to build utilities into the shell itself.
However, many shells implement certain utilities as regular built-ins for the following reasons:</p>
<ul>
<li class="tent">To improve performance, especially for frequently used lightweight utilities (such as <a href=
"../utilities/test.html"><i>test</i></a>, <a href="../utilities/true.html"><i>true</i></a>, and <a href=
"../utilities/false.html"><i>false</i></a>).</li>
<li class="tent">To eliminate the need for some sort of interprocess communication between the shell and those utilities that read
or modify the shell's execution environment (such as <a href="../utilities/cd.html"><i>cd</i></a>).</li>
<li class="tent">To make it easier to satisfy the command search and execution requirements in XCU <a href=
"../utilities/V3_chap02.html#tag_19_09_01_04"><i>2.9.1.4 Command Search and Execution</i></a> for intrinsic utilities. Intrinsic
utilities must be found prior to the <i>PATH</i> search. The shell could satisfy this requirement by keeping a list of the
intrinsic utility pathnames and directly accessing the file-system versions regardless of <i>PATH ,</i> but these utilities usually
need to read or modify the shell's execution environment anyway.</li>
</ul>
<p class="tent">With the exception of the intrinsic utilities, all regular built-in utilities are subject to the <i>PATH</i> search
and can be overridden by a specially crafted <i>PATH</i> environment variable.</p>
<p class="tent">Earlier versions of this standard required that all of the regular built-in utilities, including intrinsic
utilities, could be <i>exec</i>-ed. This was always a contentious requirement, and with the introduction of intrinsic utilities the
standard developers decided to exempt the utilities that this standard requires to be intrinsic, with the exception of <a href=
"../utilities/kill.html"><i>kill</i></a>. The <a href="../utilities/kill.html"><i>kill</i></a> utility is still genuinely useful
when <i>exec</i>-ed, only lacking support for the <tt>%</tt> job ID notation, whereas examples given of uses for the other
utilities that are now exempted were considered contrived (such as using <a href="../utilities/cd.html"><i>cd</i></a> to test
accessibility of a directory, which can be done using <a href="../utilities/test.html"><i>test</i></a> <b>-x</b>). If an
application needs <i>exec</i>-able versions of some of the exempted intrinsic utilities, it can easily provide them itself, on
systems that support the (non-standard but ubiquitous) <tt>"#!"</tt> mechanism to make scripts executable by the <i>exec</i> family
of functions, as links to a two-line shell script:</p>
<pre>
<tt>#! /path/to/sh
${0##*/} "$@"
</tt></pre>
<p class="tent">Austin Group Defect 854 is applied, replacing the table of Regular Built-In Utilities with a reference to the new
<i>Intrinsic Utilities</i> section.</p>
<p class="tent">Austin Group Defect 1600 is applied, exempting the intrinsic utilities other than <a href=
"../utilities/kill.html"><i>kill</i></a> from the requirement that they can be <i>exec</i>-ed.</p>
<h4><a name="tag_23_01_08" id="tag_23_01_08"></a>C.1.8 Intrinsic Utilities</h4>
There were varying reasons for including utilities in the table of intrinsic utilities:
<dl compact>
<dd></dd>
<dt><i>alias</i>, <i>fc</i>, <i>unalias</i></dt>
<dd>
The functionality of these utilities is performed more simply within the shell itself and that is the model most historical
implementations have used.</dd>
<dt><i>bg</i>, <i>fg</i>, <i>jobs</i></dt>
<dd>
All of the job control-related utilities are eligible for built-in status because that is the model most historical implementations
have used.</dd>
<dt><i>cd</i>, <i>getopts</i>, <i>hash</i>, <i>read</i>, <i>type</i>, <i>ulimit</i>, <i>umask</i>, <i>wait</i></dt>
<dd>
The functionality of these utilities is performed more simply within the context of the current process. An example can be taken
from the usage of the <a href="../utilities/cd.html"><i>cd</i></a> utility. The purpose of the <a href=
"../utilities/cd.html"><i>cd</i></a> utility is to change the working directory for subsequent operations. The actions of <a href=
"../utilities/cd.html"><i>cd</i></a> affect the process in which <a href="../utilities/cd.html"><i>cd</i></a> is executed and all
subsequent child processes of that process. Based on the POSIX standard process model, changes in the process environment of a
child process have no effect on the parent process. If the <a href="../utilities/cd.html"><i>cd</i></a> utility were executed from
a child process, the working directory change would be effective only in the child process. Child processes initiated subsequent to
the child process that executed the <a href="../utilities/cd.html"><i>cd</i></a> utility would not have a changed working directory
relative to the parent process.</dd>
<dt><i>command</i></dt>
<dd>
This utility was placed in the table primarily to protect scripts that are concerned about their <i>PATH</i> being manipulated. The
&quot;secure&quot; shell script example in the <a href="../utilities/command.html"><i>command</i></a> utility in the Shell and Utilities
volume of POSIX.1-2024 would not be possible if a <i>PATH</i> change retrieved an alien version of <a href=
"../utilities/command.html"><i>command</i></a>. (An alternative would have been to implement <a href=
"../utilities/getconf.html"><i>getconf</i></a> as a built-in, but the standard developers considered that it carried too many
changing configuration strings to require in the shell.)</dd>
<dt><i>kill</i></dt>
<dd>Since <a href="../utilities/kill.html"><i>kill</i></a> provides optional job control functionality using shell notation
(<tt>%1</tt>, <tt>%2</tt>, and so on), some implementations would find it extremely difficult to provide this outside the
shell.</dd>
</dl>
<p class="tent">The following utilities are frequently implemented as intrinsic (and built-in) utilities. Future versions of this
standard might not allow these utilities, or any other standard utility not in <a href=
"../utilities/V3_chap01.html#tagtcjh_13"><i>Intrinsic Utilities</i></a>, to be intrinsic; implementations are encouraged to
implement these as non-intrinsic utilities instead (but still built-in if they were previously built-in).</p>
<p class="tent"><a href="../utilities/[.html"><i>[</i></a>, <a href="../utilities/echo.html"><i>echo</i></a>, <a href=
"../utilities/false.html"><i>false</i></a>, <a href="../utilities/newgrp.html"><i>newgrp</i></a>, <a href=
"../utilities/printf.html"><i>printf</i></a>, <a href="../utilities/pwd.html"><i>pwd</i></a>, <a href=
"../utilities/test.html"><i>test</i></a>, <a href="../utilities/true.html"><i>true</i></a></p>
<p class="tent">All utilities, including those in the table, are accessible via the <a href=
"../functions/system.html"><i>system</i>()</a> and <a href="../functions/popen.html"><i>popen</i>()</a> functions in the System
Interfaces volume of POSIX.1-2024. There are situations where the return functionality of <a href=
"../functions/system.html"><i>system</i>()</a> and <a href="../functions/popen.html"><i>popen</i>()</a> is not desirable.
Applications that require the exit status of the invoked utility will not be able to use <a href=
"../functions/system.html"><i>system</i>()</a> or <a href="../functions/popen.html"><i>popen</i>()</a>, since the exit status
returned is that of the command language interpreter rather than that of the invoked utility. The alternative for such applications
is the use of the <i>exec</i> family.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0004 [705] is applied.</p>
<p class="tent">Austin Group Defect 854 is applied, adding intrinsic utilities.</p>
<h3><a name="tag_23_02" id="tag_23_02"></a>C.2 Shell Command Language</h3>
<h4><a name="tag_23_02_01" id="tag_23_02_01"></a>C.2.1 Shell Introduction</h4>
<p class="tent">The System&nbsp;V shell was selected as the starting point for the Shell and Utilities volume of POSIX.1-2024. The
BSD C shell was excluded from consideration for the following reasons:</p>
<ul>
<li class="tent">Most historically portable shell scripts assume the Version 7 Bourne shell, from which the System&nbsp;V shell is
derived.</li>
<li class="tent">The majority of tutorial materials on shell programming assume the System V shell.</li>
</ul>
<p class="tent">The construct <tt>"#!"</tt> is reserved for implementations wishing to provide that extension. If it were not
reserved, the Shell and Utilities volume of POSIX.1-2024 would disallow it by forcing it to be a comment. As it stands, a strictly
conforming application must not use <tt>"#!"</tt> as the first two characters of the file.</p>
<p class="tent">Austin Group Defect 249 is applied, adding the dollar-single-quotes quoting mechanism.</p>
<p class="tent">Austin Group Defect 1514 is applied, correcting a misuse of the term &quot;positional parameter&quot;.</p>
<h4><a name="tag_23_02_02" id="tag_23_02_02"></a>C.2.2 Quoting</h4>
<p class="tent">Although this section contains a note indicating that a future version of this standard may extend the conditions
under which some characters are special, there are no plans to do so. The note is there to encourage application writers to
future-proof their shell code. In some cases existing widespread use of the characters unquoted would preclude them being given a
special meaning in those use cases. For example, commas are in widespread use in filenames (notably by RCS and CVS) and it is
common to pass the token <tt>"{}"</tt> as an argument to <a href="../utilities/find.html"><i>find</i></a> and <a href=
"../utilities/xargs.html"><i>xargs</i></a> unquoted.</p>
<p class="tent">Austin Group Defect 249 is applied, adding the dollar-single-quotes quoting mechanism.</p>
<p class="tent">Austin Group Defects 1191 and 1193 are applied, adding:</p>
<pre>
<tt>]  ^  -  !  {  ,  }
</tt></pre>
<p class="tent">to the list of characters that might need to be quoted under certain circumstances.</p>
<h5 class="header4"><a name="tag_23_02_02_01" id="tag_23_02_02_01"></a>C.2.2.1 Escape Character (Backslash)</h5>
<p class="tent">Austin Group Defect 500 is applied, changing &quot;follows&quot; to &quot;immediately follows&quot;.</p>
<h5 class="header4"><a name="tag_23_02_02_02" id="tag_23_02_02_02"></a>C.2.2.2 Single-Quotes</h5>
<p class="tent">A &lt;backslash&gt; cannot be used to escape a single-quote in a single-quoted string. An embedded quote can be
created by writing, for example: <tt>"'a'\''b'"</tt>, which yields <tt>"a'b"</tt>. (See XCU <a href=
"../utilities/V3_chap02.html#tag_19_06_05"><i>2.6.5 Field Splitting</i></a> for a better understanding of how portions of words are
either split into fields or remain concatenated.) A single token can be made up of concatenated partial strings containing all
three kinds of quoting or escaping, thus permitting any combination of characters.</p>
<h5 class="header4"><a name="tag_23_02_02_03" id="tag_23_02_02_03"></a>C.2.2.3 Double-Quotes</h5>
<p class="tent">The escaped &lt;newline&gt; used for line continuation is removed entirely from the input and is not replaced by
any white space. Therefore, it cannot serve as a token separator.</p>
<p class="tent">In double-quoting, if a &lt;backslash&gt; is immediately followed by a character that would be interpreted as
having a special meaning, the &lt;backslash&gt; is deleted and the subsequent character is taken literally. If a &lt;backslash&gt;
does not precede a character that would have a special meaning, it is left in place unmodified and the character immediately
following it is also left unmodified. Thus, for example:</p>
<pre>
<tt>"\$"  -&gt;  $
<br class="tent">
"\a"  -&gt;  \a
</tt></pre>
<p class="tent">It would be desirable to include the statement &quot;The characters from an enclosed <tt>"${"</tt> to the matching
<tt>'}'</tt> shall not be affected by the double-quotes&quot;, similar to the one for <tt>"$()"</tt>. However, historical practice in
the System&nbsp;V shell prevents this.</p>
<p class="tent">Shell implementations differ widely in their handling of unescaped double-quote characters inside <tt>"${...}"</tt>
(except for the four substring-processing variants). Hence this standard leaves the behavior unspecified. Single-quotes are
ordinary characters in this context, and so cannot be used to quote a <tt>'}'</tt> within <tt>"${...}"</tt>. However,
&lt;backslash&gt; can be used to escape a <tt>'}'</tt>. For example, the value of <i>foo</i> assigned by the following commands is
<tt>'}'</tt>:</p>
<pre>
<tt>unset bar
foo="${bar-\}}"
</tt></pre>
<p class="tent">When &lt;backslash&gt; is used in this way it is a special character and is therefore removed during quote removal,
even though it would not be removed in:</p>
<pre>
<tt>foo="\}"
</tt></pre>
<p class="tent">Differences in processing the <tt>"${...}"</tt> form led to inconsistencies between the historical System&nbsp;V
shell, BSD, and KornShells, and the text in the Shell and Utilities volume of POSIX.1-2024 is an attempt to converge them without
breaking too many applications. The only alternative to this compromise between shells would be to make the behavior unspecified
not just for unescaped double-quote but also for unescaped single-quote, <tt>'{'</tt>, or <tt>'}'</tt>. The chosen requirements
provide the maximum consistency between normal double-quote behavior and parameter expansion within double-quotes; the only real
difference being the ability to escape a <tt>'}'</tt> with &lt;backslash&gt;.</p>
<p class="tent">Some implementations have allowed the end of the word to terminate the backquoted command substitution, such as
in:</p>
<pre>
<tt>"`echo hello"
</tt></pre>
<p class="tent">This usage is undefined; the matching backquote is required by the Shell and Utilities volume of POSIX.1-2024. The
other undefined usage can be illustrated by the example:</p>
<pre>
<tt>sh -c '` echo "foo`'
</tt></pre>
<p class="tent">The description of the recursive actions involving command substitution can be illustrated with an example. Upon
recognizing the introduction of command substitution, the shell parses input (in a new context), gathering the source for the
command substitution until an unbalanced <tt>')'</tt> or <tt>'`'</tt> is located. For example, in the following:</p>
<pre>
<tt>echo "$(date; echo "
    one" )"
</tt></pre>
<p class="tent">the double-quote following the <a href="../utilities/echo.html"><i>echo</i></a> does not terminate the first
double-quote; it is part of the command substitution script. Similarly, in:</p>
<pre>
<tt>echo "$(echo *)"
</tt></pre>
<p class="tent">the &lt;asterisk&gt; is not quoted since it is inside command substitution; however:</p>
<pre>
<tt>echo "$(echo "*")"
</tt></pre>
<p class="tent">is quoted (and represents the &lt;asterisk&gt; character itself).</p>
<p class="tent">The <tt>$'...'</tt> construct does not retain its special meaning inside double quotes. This was discussed by the
standard developers and rejected. Note that <tt>$'...'</tt> is a quoting mechanism and not an expansion. Losing the special meaning
inside double-quotes is consistent with other quoting mechanisms losing their special meaning when quoted.</p>
<p class="tent">Austin Group Defect 221 is applied, clarifying the behavior of double-quotes within the string of characters from
<tt>"${"</tt> to the matching <tt>'}'</tt> in parameter expansions using that form.</p>
<p class="tent">Austin Group Defect 249 is applied, adding the dollar-single-quotes quoting mechanism.</p>
<p class="tent">Austin Group Defect 500 is applied, clarifying the behavior of &lt;backslash&gt; within double-quotes.</p>
<p class="tent">Austin Group Defect 1268 is applied, clarifying the effect of double-quotes on the results of parameter expansion,
command substitution, or arithmetic expansion.</p>
<p class="tent">Austin Group Defect 1342 is applied, clarifying the requirements for alias substitutions inside command
substitutions.</p>
<h5 class="header4"><a name="tag_23_02_02_04" id="tag_23_02_02_04"></a>C.2.2.4 Dollar-Single-Quotes</h5>
<p class="tent">The <tt>$'...'</tt> quoting construct has been implemented in several recent shells. It is similar to character
string literals (<tt>"..."</tt>) in the ISO&nbsp;C standard with the following exceptions:</p>
<ul>
<li class="tent">The <tt>\x</tt> escape sequence in C can be followed by an arbitrary number of hexadecimal digits. The
<i>ksh93</i> implementation of <tt>$'...'</tt> also consumes an arbitrary number of hexadecimal digits; <i>bash</i> consumes at
most two hexadecimal digits in this case. This standard leaves the result unspecified if more than two hexadecimal digits follow
<tt>\x</tt>. (Note that a hexadecimal escape followed by a literal hexadecimal character can always be represented as
<tt>$'\x</tt><i>XX</i><tt>'</tt><i>X</i>.)</li>
<li class="tent">The <tt>\c</tt> escape sequence is not included in the ISO&nbsp;C standard. There was also some disagreement in
shells that historically supported <tt>\c</tt> escape sequences in <tt>$'...'</tt>. These include:
<ul>
<li class="tent">Whether <tt>\cA</tt> through <tt>\cZ</tt> produced the byte values 1 through 26, respectively or supported the
codeset independent control character as specified by the <a href="../utilities/stty.html"><i>stty</i></a> utility. This standard
requires codeset independence.</li>
<li class="tent">Whether <tt>\c[</tt>, <tt>\c\\</tt>, <tt>\c]</tt>, <tt>\c^</tt>, <tt>\c_</tt>, and <tt>\c?</tt> could be used to
yield the &lt;ESC&gt;, &lt;FS&gt;, &lt;GS&gt;, &lt;RS&gt;, &lt;US&gt;, and &lt;DEL&gt; control characters, respectively. This
standard requires support for all of the control characters except NULL (matching what is done in the <a href=
"../utilities/stty.html"><i>stty</i></a> utility).</li>
<li class="tent">Whether <tt>\c\\</tt> or <tt>\c\</tt> was used to represent &lt;FS&gt;. This standard requires <tt>\c\\</tt> to
make &lt;backslash&gt;-escape processing consistent.</li>
</ul>
<p class="tent">The implementors of the most common shells that implement <tt>$'\c</tt><i>X</i><tt>'</tt> agreed to convert to the
behavior specified in this standard.</p>
<p class="tent">Some shells also allow <tt>\c</tt>&lt;arbitrary_control_character&gt; to act as an inverse function to
<tt>\c</tt><i>X</i> (that is, <tt>\cm</tt> and <tt>\cM</tt> yield &lt;CR&gt; and <tt>\c</tt>&lt;CR&gt; yields <tt>m</tt> or
<tt>M</tt>. This standard leaves this behavior implementation-defined.</p>
</li>
<li class="tent">The <tt>\e</tt> escape sequence is not included in the ISO&nbsp;C standard, but was provided by all historical
shells that supported <tt>$'...'</tt>. Some also supported <tt>\E</tt> as a synonym. One member of the group objected to adding
<tt>\e</tt> because the &lt;ESC&gt; control character is not required to be in the portable character set. The <tt>\e</tt> sequence
is included because many historical users of <tt>$'...'</tt> expect it to be there. The <tt>\E</tt> sequence is not included in
this standard because &lt;backslash&gt;-escape sequences that start with &lt;backslash&gt; followed by an uppercase letter (except
<tt>\U</tt>) are reserved by the ISO&nbsp;C standard for implementation use.</li>
<li class="tent">The <tt>\</tt><i>ddd</i> octal escape sequence and the <tt>\x</tt><i>XX</i> hexadecimal escape sequence can be
used to insert a null byte into a C character string literal and into a <tt>$'...'</tt> quoted word in this standard. In C, any
characters specified after that null byte (including escape sequences) continue to be processed and added to the character string
literal. In <tt>$'...'</tt> in the shell this standard allows the equivalent behavior but also allows the null byte and all
remaining characters up to the terminating unescaped single-quote to be evaluated and discarded. The latter (which was historic
practice in <i>bash</i>, but not in <i>ksh93</i>) allows an escape sequence producing a null byte to terminate the
dollar-single-quoted expansion, but not terminate the token in which it appears if there are characters remaining in the token. For
example:
<pre>
<tt>printf a$'b\0c\''d
</tt></pre>
<p class="tent">is required by this standard to produce:</p>
<pre>
<tt>abd
</tt></pre>
<p class="tent">while historic versions of <i>ksh93</i> produced:</p>
<pre>
<tt>ab
</tt></pre></li>
<li class="tent">The ISO&nbsp;C standard specifies <tt>\u</tt><i>XXXX</i> and <tt>\U</tt><i>XXXXXXXX</i> escape sequences. These
need not be supported by <tt>$'...'</tt> in the shell. They were omitted because current shell implementations that support them
differ in behavior. In particular, some shells always convert them to the UTF-8 encoding for the named character, even if the
current locale's character set does not have UTF-8 encoding.</li>
<li class="tent">The double-quote character can be used literally, while the single-quote character must be represented as an
escape sequence. In C, single-quote can be used literally, while double-quote requires an escape sequence.</li>
<li class="tent">A &lt;backslash&gt; immediately followed by a &lt;newline&gt; has unspecified behavior. In C, this sequence is
used for line continuations, where both the &lt;backslash&gt; and &lt;newline&gt; are deleted and a diagnostic is required if a
closing quote is not encountered before a &lt;newline&gt; that is not preceded by &lt;backslash&gt;. In current shell
implementations, three different behaviors have been observed.</li>
<li class="tent">The use of &lt;backslash&gt;-escape sequences not described in this standard results in unspecified behavior. In
C, the result is not a token and a diagnostic is required. This allows shells to recognize other &lt;backslash&gt;-escape sequences
in other ways as extensions to this standard. Furthermore, existing implementations already had different behaviors for some
&lt;backslash&gt;-escape sequences when <tt>$'...'</tt> processing was added to this standard.</li>
</ul>
<p class="tent">This standard makes the results implementation-defined if <tt>\e</tt> or <tt>\c</tt><i>X</i> specifies a character
that is not present in the current locale. Application authors should note that implementations are permitted to have a wide range
of behaviors when encountering an unsupported character. For example:</p>
<ul>
<li class="tent">The shell might produce an error, possibly causing the shell to terminate.</li>
<li class="tent">The unsupported character might be silently discarded.</li>
<li class="tent">The unsupported character might be replaced with another character of a different character class.</li>
<li class="tent">The unsupported character might be replaced with a shell-special character (e.g., <tt>'?'</tt>).</li>
<li class="tent">The unsupported character might be replaced with multiple characters, shell-special or regular (e.g. if
&lt;ESC&gt; is not supported, <tt>$'\e'</tt> may be replaced by <tt>"???"</tt>, <tt>"XXX"</tt>, or <tt>"&lt;ESC&gt;"</tt>).</li>
</ul>
<p class="tent">However, implementations must document their behavior, and they are prohibited from replacing an unsupported
character with bytes that do not form valid characters in the current locale's character set (e.g., encoding in UTF-8 when the
locale has a 7-bit character set). This standard does not specify a way for script authors to determine beforehand whether a
particular <tt>\c</tt><i>X</i> sequence specifies a character that exists in the current locale. At the time this feature was
standardized, no known implementations provided such a capability.</p>
<p class="tent">Note that the escape sequences recognized by <tt>$'...',</tt> file format notation (see <a href=
"../basedefs/V1_chap05.html#tagtcjh_2"><i>Escape Sequences and Associated Actions</i></a>), XSI-conforming implementations of the
<a href="../utilities/echo.html"><i>echo</i></a> utility (see the utility's OPERANDS section in <a href=
"../utilities/echo.html#"><i>echo</i></a>), and the <a href="../utilities/printf.html"><i>printf</i></a> utility's <i>format</i>
operand (see the utility's EXTENDED DESCRIPTION in <a href="../utilities/printf.html#tag_20_96"><i>printf</i></a>) are not the
same. Some escape sequences are not recognized by all of the above, the <tt>\c</tt> escape sequence in <a href=
"../utilities/echo.html"><i>echo</i></a> is not at all like the <tt>\c</tt> escape sequence in <tt>$'...',</tt> octal escape
sequences in some of the above accept one to four octal digits and require a leading zero while others accept one to three octal
digits and do not require a leading zero.</p>
<p class="tent">Austin Group Defect 249 is applied, adding the dollar-single-quotes quoting mechanism.</p>
<h4><a name="tag_23_02_03" id="tag_23_02_03"></a>C.2.3 Token Recognition</h4>
<p class="tent">The <tt>"(("</tt> and <tt>"))"</tt> symbols are control operators in the KornShell, used for an alternative syntax
of an arithmetic expression command. A conforming application cannot use <tt>"(("</tt> as a single token (with the exception of the
<tt>"$(("</tt> form for shell arithmetic).</p>
<p class="tent">On some implementations, the symbol <tt>"(("</tt> is a control operator; its use produces unspecified results.
Applications that wish to have nested subshells, such as:</p>
<pre>
<tt>((echo Hello);(echo World))
</tt></pre>
<p class="tent">must separate the <tt>"(("</tt> characters into two tokens by including white space between them. Some systems may
treat these as invalid arithmetic expressions instead of subshells.</p>
<p class="tent">Certain combinations of characters are invalid in portable scripts, as shown in the grammar. Implementations may
use these combinations (such as <tt>"|&amp;"</tt>) as valid control operators. Portable scripts cannot rely on receiving errors in
all cases where this volume of POSIX.1-2024 indicates that a syntax is invalid.</p>
<p class="tent">The (3) rule about combining characters to form operators is not meant to preclude systems from extending the shell
language when characters are combined in otherwise invalid ways. Conforming applications cannot use invalid combinations, and test
suites should not penalize systems that take advantage of this fact. For example, the unquoted combination <tt>"|&amp;"</tt> is not
valid in a POSIX script, but has a specific KornShell meaning.</p>
<p class="tent">The (10) rule about <tt>'#'</tt> as the current character is the first in the sequence in which a new token is
being assembled. The <tt>'#'</tt> starts a comment only when it is at the beginning of a token. This rule is also written to
indicate that the search for the end-of-comment does not consider escaped &lt;newline&gt; specially, so that a comment cannot be
continued to the next line.</p>
<p class="tent">Because a <i>complete_command</i> encountered during a <i>program</i> is executed before the next
<i>complete_command</i> is tokenized and parsed, syntax errors are not discovered by the shell until just before the code would be
executed. While in some cases it might be desirable to detect and react to syntax errors before anything is executed (possible with
<a href="../utilities/sh.html"><i>sh</i></a> <b>-n</b>), deferring the discovery of syntax errors has several benefits:</p>
<ul>
<li class="tent">It makes it possible for script authors to test for the availability of a nonstandard extension and react
appropriately before the use of the extension would trigger a syntax error.</li>
<li class="tent">It makes it possible to create self-extracting tarballs (a shell script concatenated with a payload archive that
extracts the archive when executed).</li>
<li class="tent">The shell does not have to read and parse the complete script before execution, which reduces memory usage when
executing extremely long scripts.</li>
</ul>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0005 [718], XCU/TC2-2008/0006 [647], XCU/TC2-2008/0007 [568],
and XCU/TC2-2008/0008 [648] are applied.</p>
<p class="tent">Austin Group Defect 249 is applied, adding the dollar-single-quotes quoting mechanism.</p>
<p class="tent">Austin Group Defect 1036 is applied, clarifying how here-documents are parsed.</p>
<p class="tent">Austin Group Defect 1055 is applied, clarifying how much of a <i>program</i> is parsed before the parsed commands
are executed.</p>
<p class="tent">Austin Group Defect 1083 is applied, changing &quot;the next character&quot; to &quot;each character in turn&quot;.</p>
<p class="tent">Austin Group Defect 1085 is applied, clarifying requirements for the start and end of tokens.</p>
<h5 class="header4"><a name="tag_23_02_03_01" id="tag_23_02_03_01"></a>C.2.3.1 Alias Substitution</h5>
<p class="tent">The alias capability was added because it is widely used in historical implementations by interactive users.</p>
<p class="tent">The definition of &quot;alias name&quot; precludes an alias name containing a &lt;slash&gt; character. Since the text
applies to the command words of simple commands, reserved words (in their proper places) cannot be confused with aliases.</p>
<p class="tent">The placement of alias substitution in token recognition makes it clear that it precedes all of the word expansion
steps.</p>
<p class="tent">An example concerning trailing &lt;blank&gt; characters and reserved words follows. If the user types:</p>
<pre>
<b>$</b><tt> alias foo="/bin/ls "
</tt><b>$</b><tt> alias while="/"
</tt></pre>
<p class="tent">The effect of executing:</p>
<pre>
<b>$</b><tt> while true
</tt><b>&gt;</b><tt> do
</tt><b>&gt;</b><tt> echo "Hello, World"
</tt><b>&gt;</b><tt> done
</tt></pre>
<p class="tent">is a never-ending sequence of <tt>"Hello, World"</tt> strings to the screen. However, if the user types:</p>
<pre>
<b>$</b><tt> foo while
</tt></pre>
<p class="tent">the result is an <a href="../utilities/ls.html"><i>ls</i></a> listing of <b>/</b>. Since the alias substitution for
<b>foo</b> ends in a &lt;space&gt;, the next word is checked for alias substitution. The next word, <b>while</b>, has also been
aliased, so it is substituted as well. Since it is not in the proper position as a command word, it is not recognized as a reserved
word.</p>
<p class="tent">If the user types:</p>
<pre>
<b>$</b><tt> foo; while
</tt></pre>
<p class="tent"><b>while</b> retains its normal reserved-word properties.</p>
<p class="tent">Some implementations add a &lt;space&gt; after the alias value when performing alias substitution in order to
prevent the last character of the alias value and the first character after the alias name in the input from combining to form an
operator. However, the extra &lt;space&gt; can have side-effects in other situations, such as if the alias value ends with an
unquoted &lt;backslash&gt;. Implementations which do this are encouraged to change to an alternative method of delimiting a partial
operator token at the end of an alias value.</p>
<p class="tent">Some, but not all, shell implementations do not process changes to alias definitions until the current
<i>compound_list</i> (see XCU <a href="../utilities/V3_chap02.html#tag_19_10"><i>2.10 Shell Grammar</i></a>) has completed. In
these shells, alias changes do not take effect until the end of the dot script, <a href="../utilities/eval.html"><i>eval</i></a>
command, function invocation, <b>if</b> statement, <b>case</b> statement, <b>for</b> statement, <b>while</b> statement, or
<b>until</b> statement containing the alias change.</p>
<p class="tent">Many shell implementations execute the contents of a file, typically <b>~/.profile</b>, when invoked as a login
shell. The standard developers are unaware of any such implementations that process the contents of <b>~/.profile</b> (and similar
startup files) as a single <i>compound_list</i>, so alias changes in <b>~/.profile</b> typically do take effect before the end of
<b>~/.profile</b>.</p>
<p class="tent">Austin Group Defects 953 and 1630 are applied, providing additional detail on how alias substitution is
performed.</p>
<h4><a name="tag_23_02_04" id="tag_23_02_04"></a>C.2.4 Reserved Words</h4>
<p class="tent">All reserved words are recognized syntactically as such in the contexts described. However, note that <b>in</b> is
the only meaningful reserved word after a <b>case</b> or <b>for</b>; similarly, <b>in</b> is not meaningful as the first word of a
simple command.</p>
<p class="tent">Reserved words are recognized only when they are delimited (that is, meet the definition of XBD <a href=
"../basedefs/V1_chap03.html#tag_03_420"><i>3.420 Word</i></a>), whereas operators are themselves delimiters. For instance,
<tt>'('</tt> and <tt>')'</tt> are control operators, so that no &lt;space&gt; is needed in (<i>list</i>). However, <tt>'{'</tt> and
<tt>'}'</tt> are reserved words in {&nbsp;<i>list</i>;}, so that in this case the leading &lt;space&gt; and &lt;semicolon&gt; are
required.</p>
<p class="tent">The list of unspecified reserved words is from the KornShell, so conforming applications cannot use them in places
a reserved word would be recognized. Earlier versions of this standard omitted <b>time</b> from this list, so that the <a href=
"../utilities/time.html"><i>time</i></a> utility could be included without requiring applications to quote all or part of its name
(or use other measures) in order to avoid it being treated as a reserved word. However, although the intent was to allow the
reserved word implementation (as evidenced by use of <a href="../utilities/time.html"><i>time</i></a> in pipelines being
unspecified, and explicit mention in the rationale of the <a href="../utilities/time.html"><i>time</i></a> utility), the conditions
under which the behavior was unspecified were insufficient to allow this. In particular, redirection in KornShell does not work in
the normal way when <b>time</b> is a reserved word:</p>
<pre>
<tt>time utility 2&gt; time.out
</tt></pre>
<p class="tent">only writes the standard error from <i>utility</i> to <b>time.out</b>; the timing information is written to the
shell's standard error, but these versions of the standard required the timing information to be written to <b>time.out</b>.
Another issue was that if <b>time</b> is a reserved word, an application cannot define a function with that name, but these
versions of the standard required that applications could do so. Hence <b>time</b> has now been added to the list of unspecified
reserved words, but with its use as a reserved word limited in order to be compatible with its use as a utility in the cases where
the two have traditionally had the same effect (other than possible output format differences).</p>
<p class="tent">There was a strong argument for promoting braces to operators (instead of reserved words), so they would be
syntactically equivalent to subshell operators. Concerns about compatibility outweighed the advantages of this approach.
Nevertheless, conforming applications should consider quoting <tt>'{'</tt> and <tt>'}'</tt> when they represent themselves.</p>
<p class="tent">When used in circumstances where reserved words are recognized, all words whose final character is a &lt;colon&gt;
(<tt>':'</tt>) are reserved. The case of a name suffixed with a colon is reserved to allow implementations to support named labels
for flow control; see the RATIONALE for the <a href="../utilities/V3_chap02.html#break"><i>break</i></a> special built-in utility.
Other words ending in &lt;colon&gt; are reserved to provide implementations with a way to add new reserved words while still
conforming to this standard.</p>
<p class="tent">It is possible that a future version of the Shell and Utilities volume of POSIX.1-2024 may require that
<tt>'{'</tt> and <tt>'}'</tt> be treated individually as control operators, although the token <tt>"{}"</tt> will probably be a
special-case exemption from this because of the often-used <a href="../utilities/find.html"><i>find</i></a>{} construct.</p>
<p class="tent">Austin Group Defect 267 is applied, adding <b>time</b> to the list of words that may be recognized as reserved
words while specifying its behavior if it is recognized as a reserved word, and extending the reservation of words whose final
character is &lt;colon&gt; from those that are a name followed by a &lt;colon&gt; to all such words.</p>
<p class="tent">Austin Group Defect 465 is applied, adding <b>namespace</b> to the list of words that may be recognized as reserved
words.</p>
<h4><a name="tag_23_02_05" id="tag_23_02_05"></a>C.2.5 Parameters and Variables</h4>
<p class="tent">Austin Group Defect 1561 is applied, clarifying that parameters can contain byte sequences that do not form valid
characters and that the shell processes their values as characters only when performing operations that are described in this
standard in terms of characters.</p>
<h5 class="header4"><a name="tag_23_02_05_01" id="tag_23_02_05_01"></a>C.2.5.1 Positional Parameters</h5>
<p class="tent">Austin Group Defect 1491 is applied, clarifying the handling of leading zeros in positional parameter
identifiers.</p>
<h5 class="header4"><a name="tag_23_02_05_02" id="tag_23_02_05_02"></a>C.2.5.2 Special Parameters</h5>
<p class="tent">Most historical implementations implement subshells by forking; thus, the special parameter <tt>'$'</tt> does not
necessarily represent the process ID of the shell process executing the commands since the subshell execution environment preserves
the value of <tt>'$'</tt>.</p>
<p class="tent">If a subshell were to execute a background command, the value of <tt>"$!"</tt> for the parent would not change. For
example:</p>
<pre>
<tt>(
date &
echo $!
)
echo $!
</tt></pre>
<p class="tent">would echo two different values for <tt>"$!"</tt>.</p>
<p class="tent">The <tt>"$-"</tt> special parameter can be used to save and restore <a href=
"../utilities/V3_chap02.html#set"><i>set</i></a> options:</p>
<pre>
<tt>Save=$(echo $- | sed 's/[ics]//g')
...
set +aCefnuvx
if [ -n "$Save" ]; then
    set -$Save
fi
</tt></pre>
<p class="tent">The three options are removed using <a href="../utilities/sed.html"><i>sed</i></a> in the example because they may
appear in the value of <tt>"$-"</tt> (from the <a href="../utilities/sh.html"><i>sh</i></a> command line), but are not valid
options to <a href="../utilities/V3_chap02.html#set"><i>set</i></a>.</p>
<p class="tent">The descriptions of parameters <tt>'*'</tt> and <tt>'@'</tt> assume the reader is familiar with the field splitting
discussion in XCU <a href="../utilities/V3_chap02.html#tag_19_06_05"><i>2.6.5 Field Splitting</i></a> and understands that portions
of the word remain concatenated unless there is some reason to split them into separate fields.</p>
<p class="tent">The following examples illustrate some of the ways in which <tt>'*'</tt> and <tt>'@'</tt> can be expanded:</p>
<pre>
<tt>set "abc" "def ghi" "jkl"
unset novar
IFS=' ' # a space
printf '%s\n' $*
</tt><b>abc
def
ghi
jkl</b><tt>
printf '%s\n' "$*"
</tt><b>abc def ghi jkl</b><tt>
printf '%s\n' xx$*yy
</tt><b>xxabc
def
ghi
jklyy</b><tt>
printf '%s\n' "xx$*yy"
</tt><b>xxabc def ghi jklyy</b><tt>
printf '%s\n' $@
</tt><b>abc
def
ghi
jkl</b><tt>
printf '%s\n' "$@"
</tt><b>abc
def ghi
jkl</b><tt>
printf '%s\n' ${1+"$@"}
</tt><b>abc
def ghi
jkl</b><tt>
printf '%s\n' ${novar-"$@"}
</tt><b>abc
def ghi
jkl</b><tt>
printf '%s\n' xx$@yy
</tt><b>xxabc
def
ghi
jklyy</b><tt>
printf '%s\n' "xx$@yy"
</tt><b>xxabc
def ghi
jklyy</b><tt>
printf '%s\n' $@$@
</tt><b>abc
def
ghi
jklabc
def
ghi
jkl</b><tt>
printf '%s\n' "$@$@"
</tt><b>abc
def ghi
jklabc
def ghi
jkl</b><tt>
IFS=':'
printf '%s\n' "$*"
</tt><b>abc:def ghi:jkl</b><tt>
var=$*; printf '%s\n' "$var"
</tt><b>abc:def ghi:jkl</b><tt>
var="$*"; printf '%s\n' "$var"
</tt><b>abc:def ghi:jkl</b><tt>
unset var
printf '%s\n' ${var-$*}
</tt><b>abc
def ghi
jkl</b><tt>
printf '%s\n' "${var-$*}"
</tt><b>abc:def ghi:jkl</b><tt>
printf '%s\n' ${var-"$*"}
</tt><b>abc:def ghi:jkl</b><tt>
printf '%s\n' ${var=$*}
</tt><b>abc
def ghi
jkl</b><tt>
printf 'var=%s\n' "$var"
</tt><b>var=abc:def ghi:jkl</b><tt>
unset var
printf '%s\n' "${var=$*}"
</tt><b>abc:def ghi:jkl</b><tt>
printf 'var=%s\n' "$var"
</tt><b>var=abc:def ghi:jkl</b><tt>
<br class="tent">
IFS='' # null
printf '%s\n' "$*"
</tt><b>abcdef ghijkl</b><tt>
var=$*; printf '%s\n' "$var"
</tt><b>abcdef ghijkl</b><tt>
var="$*"; printf '%s\n' "$var"
</tt><b>abcdef ghijkl</b><tt>
unset var
printf '%s\n' ${var-$*}
</tt><b>abc
def ghi
jkl</b><tt>
printf '%s\n' "${var-$*}"
</tt><b>abcdef ghijkl</b><tt>
printf '%s\n' ${var-"$*"}
</tt><b>abcdef ghijkl</b><tt>
printf '%s\n' ${var=$*}
</tt><b>abcdef ghijkl</b><tt>
printf 'var=%s\n' "$var"
</tt><b>var=abcdef ghijkl</b><tt>
unset var
printf '%s\n' "${var=$*}"
</tt><b>abcdef ghijkl</b><tt>
printf 'var=%s\n' "$var"
</tt><b>var=abcdef ghijkl</b><tt>
printf '%s\n' "$@"
</tt><b>abc
def ghi
jkl</b><tt>
<br class="tent">
unset IFS
printf '%s\n' "$*"
</tt><b>abc def ghi jkl</b><tt>
var=$*; printf '%s\n' "$var"
</tt><b>abc def ghi jkl</b><tt>
var="$*"; printf '%s\n' "$var"
</tt><b>abc def ghi jkl</b><tt>
unset var
printf '%s\n' ${var-$*}
</tt><b>abc
def
ghi
jkl</b><tt>
printf '%s\n' "${var-$*}"
</tt><b>abc def ghi jkl</b><tt>
printf '%s\n' ${var-"$*"}
</tt><b>abc def ghi jkl</b><tt>
printf '%s\n' ${var=$*}
</tt><b>abc
def
ghi
jkl</b><tt>
printf 'var=%s\n' "$var"
</tt><b>var=abc def ghi jkl</b><tt>
unset var
printf '%s\n' "${var=$*}"
</tt><b>abc def ghi jkl</b><tt>
printf 'var=%s\n' "$var"
</tt><b>var=abc def ghi jkl</b><tt>
printf '%s\n' "$@"
</tt><b>abc
def ghi
jkl</b><tt>
<br class="tent">
set one "" three
printf '[%s]\n' $*
</tt><b>[one]
[]</b><tt> </tt>(<i>this line of output is optional</i>)<tt>
</tt><b>[three]</b><tt>
printf '[%s]\n' $@
</tt><b>[one]
[]</b><tt> </tt>(<i>this line of output is optional</i>)<tt>
</tt><b>[three]</b><tt>
<br class="tent">
set --
printf '[%s]\n' foo "$*"
</tt><b>[foo]
[]</b><tt>
printf '[%s]\n' foo "$novar$*$(echo)"
</tt><b>[foo]
[]</b><tt>
printf '[%s]\n' foo $@
</tt><b>[foo]</b><tt>
printf '[%s]\n' foo "$@"
</tt><b>[foo]</b><tt>
printf '[%s]\n' foo ''$@
</tt><b>[foo]
[]</b><tt>
printf '[%s]\n' foo ''"$@"
</tt><b>[foo]
[]</b><tt>
printf '[%s]\n' foo "$novar$@$(echo)"
</tt><b>[foo]
[]</b><tt> </tt>(<i>this line of output is optional</i>)<tt>
printf '[%s]\n' foo ''"$novar$@$(echo)"
</tt><b>[foo]
[]</b><tt>
</tt></pre>
<p class="tent">In all of the following commands the results of the expansion of <tt>'@'</tt> (if performed) are unspecified:</p>
<pre>
<tt>var=$@
var="$@"
printf '%s\n' ${var=$@}
printf '%s\n' "${var=$@}"
printf '%s\n' ${var="$@"}
printf '%s\n' ${var?$@}
printf '%s\n' "${var?$@}"
printf '%s\n' ${var?"$@"}
printf '%s\n' ${#@}
printf '%s\n' "${#@}"
printf '%s\n' ${@%foo}
printf '%s\n' "${@%foo}"
printf '%s\n' ${@#foo}
printf '%s\n' "${@#foo}"
printf '%s\n' ${var%$@}
printf '%s\n' "${var%$@}"
printf '%s\n' ${var%"$@"}
printf '%s\n' ${var%%$@}
printf '%s\n' "${var%%$@}"
printf '%s\n' ${var%%"$@"}
printf '%s\n' ${var#$@}
printf '%s\n' "${var#$@}"
printf '%s\n' ${var#"$@"}
printf '%s\n' ${var##$@}
printf '%s\n' "${var##$@}"
printf '%s\n' ${var##"$@"}
</tt></pre>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0009 [888] is applied.</p>
<p class="tent">Austin Group Defect 1039 is applied, clarifying the description of the <tt>'-'</tt> special parameter.</p>
<p class="tent">Austin Group Defect 1052 is applied, clarifying that decimal valued special parameters expand to the shortest
representation.</p>
<p class="tent">Austin Group Defects 1150 and 1309 are applied, clarifying the description of the <tt>'?'</tt> special
parameter.</p>
<p class="tent">Austin Group Defect 1254 is applied, clarifying how the <tt>'?'</tt> and <tt>'!'</tt> special parameters are
affected by job control.</p>
<h5 class="header4"><a name="tag_23_02_05_03" id="tag_23_02_05_03"></a>C.2.5.3 Shell Variables</h5>
<p class="tent">Since shell variables are parameters denoted by a name, the shell cannot initialize shell variables from
environment variables that do not have a valid name. However, the shell may initialize parameters that do not have valid names from
such environment variables.</p>
<p class="tent">See the discussion of <i>IFS</i> in <a href="#tag_23_02_06_05">C.2.6.5 Field Splitting</a> and the RATIONALE for
the <a href="../utilities/sh.html"><i>sh</i></a> utility.</p>
<p class="tent">The prohibition on <i>LC_CTYPE</i> changes affecting lexical processing protects the shell implementor (and the
shell programmer) from the ill effects of changing the definition of &lt;blank&gt; or the set of alphabetic characters in the
current environment. It would probably not be feasible to write a compiled version of a shell script without this rule. The rule
applies only to the current invocation of the shell and its subshellsâinvoking a shell script or performing <a href=
"../utilities/V3_chap02.html#exec"><i>exec</i></a> <a href="../utilities/sh.html"><i>sh</i></a> would subject the new shell to the
changes in <i>LC_CTYPE .</i></p>
<p class="tent">Other common environment variables used by historical shells are not specified by the Shell and Utilities volume of
POSIX.1-2024, but they should be reserved for the historical uses.</p>
<p class="tent">Tilde expansion for components of <i>PATH</i> in an assignment such as:</p>
<pre>
<tt>PATH=~hlj/bin:~dwc/bin:$PATH
</tt></pre>
<p class="tent">is a feature of some historical shells and is allowed by the wording of XCU <a href=
"../utilities/V3_chap02.html#tag_19_06_01"><i>2.6.1 Tilde Expansion</i></a>. Note that the &lt;tilde&gt; characters are expanded
during the assignment to <i>PATH ,</i> not when <i>PATH</i> is accessed during command search.</p>
<p class="tent">The following entries represent additional information about variables included in the Shell and Utilities volume
of POSIX.1-2024, or rationale for common variables in use by shells that have been excluded:</p>
<dl compact>
<dd></dd>
<dt><tt>_</tt></dt>
<dd>(Underscore.) While &lt;underscore&gt; is historical practice, its overloaded usage in the KornShell is confusing, and it has
been omitted from the Shell and Utilities volume of POSIX.1-2024.</dd>
<dt><i>ENV</i></dt>
<dd>This variable can be used to set aliases and other items local to the invocation of a shell. The file referred to by <i>ENV</i>
differs from <b>$HOME/.profile</b> in that <b>.profile</b> is typically executed at session start-up, whereas the <i>ENV</i> file
is executed at the beginning of each shell invocation. The <i>ENV</i> value is interpreted in a manner similar to a dot script, in
that the commands are executed in the current environment and the file needs to be readable, but not executable. However, unlike
dot scripts, no <i>PATH</i> searching is performed. This is used as a guard against Trojan Horse security breaches.</dd>
<dt><i>ERRNO</i></dt>
<dd>This variable was omitted from the Shell and Utilities volume of POSIX.1-2024 because the values of error numbers are not
defined in POSIX.1-2024 in a portable manner.</dd>
<dt><i>FCEDIT</i></dt>
<dd>Since this variable affects only the <a href="../utilities/fc.html"><i>fc</i></a> utility, it has been omitted from this more
global place. The value of <i>FCEDIT</i> does not affect the command-line editing mode in the shell; see the description of
<a href="../utilities/V3_chap02.html#set"><i>set</i></a> <b>-o</b> <i>vi</i> in the <a href=
"../utilities/V3_chap02.html#set"><i>set</i></a> built-in utility.</dd>
<dt><i>PS1</i></dt>
<dd>This variable is used for interactive prompts. Historically, the &quot;superuser&quot; has had a prompt of <tt>'#'</tt>. Since
privileges are not required to be monolithic, it is difficult to define which privileges should cause the alternate prompt.
However, a sufficiently powerful user should be reminded of that power by having an alternate prompt.</dd>
<dt><i>PS3</i></dt>
<dd>This variable is used by the KornShell for the <i>select</i> command. Since the POSIX shell does not include <i>select</i>,
<i>PS3</i> was omitted.</dd>
<dt><i>PS4</i></dt>
<dd>This variable is used for shell debugging. For example, the following script:
<pre>
<tt>PS4='[${LINENO}]+ '
set -x
echo Hello
</tt></pre>
<p class="tent">writes the following to standard error:</p>
<pre>
<tt>[3]+ echo Hello
</tt></pre></dd>
<dt><i>RANDOM</i></dt>
<dd>This pseudo-random number generator was not seen as being useful to interactive users.</dd>
<dt><i>SECONDS</i></dt>
<dd>Although this variable is sometimes used with <i>PS1</i> to allow the display of the current time in the prompt of the user, it
is not one that would be manipulated frequently enough by an interactive user to include in the Shell and Utilities volume of
POSIX.1-2024.</dd>
</dl>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0002 [152] is applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0010 [888], XCU/TC2-2008/0011 [884], and XCU/TC2-2008/0012
[494] are applied.</p>
<p class="tent">Austin Group Defect 953 is applied, clarifying how the <i>ENV</i> file is parsed.</p>
<p class="tent">Austin Group Defect 1006 is applied, clarifying how the values of the <i>PS1 ,</i> <i>PS2 ,</i> and <i>PS4</i>
variables are expanded.</p>
<p class="tent">Austin Group Defect 1441 is applied, requiring <i>PS4</i> to be used in non-interactive shells.</p>
<p class="tent">Austin Group Defect 1511 is applied, making the description of <i>LINENO</i> consistent with other variables as
regards how they relate to the User Portability Utilities option.</p>
<p class="tent">Austin Group Defect 1561 is applied, clarifying that shell variables are initialized only from environment
variables that have valid names.</p>
<h4><a name="tag_23_02_06" id="tag_23_02_06"></a>C.2.6 Word Expansions</h4>
<p class="tent">Some shells implement <i>brace expansion</i> which expands, for example, <tt>file{A,B,C}.c</tt> into the fields
<tt>fileA.c</tt>, <tt>fileB.c</tt>, and <tt>fileC.c</tt> or <tt>file{1..3}.c</tt> into the fields <tt>file1.c</tt>,
<tt>file2.c</tt>, and <tt>file3.c</tt>. This form of expansion is allowed but not required by this standard, but if supported must
be performed before all of the standard word expansions. A variant which some shells implement whereby brace expansion is performed
following field splitting was considered by the standard developers and rejected because it causes surprising behavior if the
results of parameter expansion and command substitution happen to produce a valid brace expansion. For example, if the shell
variable <tt>patt</tt> contains an arbitrary pathname, glob pattern applications cannot rely on <tt>some_command -- $patt</tt>
passing a list of pathnames that match the pattern to <tt>some_command</tt>. Note that quoting the braces or commas prevents this
form of expansion, but quoting the periods need not prevent it.</p>
<p class="tent">Step (2) refers to the &quot;portions of fields generated by step (1)&quot;. For example, if the word being expanded were
<tt>"$x+$y"</tt> and <i>IFS =+,</i> the word would be split only if <tt>"$x"</tt> or <tt>"$y"</tt> contained <tt>'+'</tt>; the
<tt>'+'</tt> in the original word was not generated by step (1).</p>
<p class="tent"><i>IFS</i> is used for performing field splitting on the results of parameter and command substitution; it is not
used for splitting all fields. Earlier versions of the shell used it for splitting all fields during field splitting, but this has
severe problems because the shell can no longer parse its own script. There are also important security implications caused by this
behavior. All useful applications of <i>IFS</i> use it for parsing input of the <a href="../utilities/read.html"><i>read</i></a>
utility and for splitting the results of parameter and command substitution.</p>
<p class="tent">The rule concerning expansion to a single field requires that if <b>foo</b>=<b>abc</b> and <b>bar</b>=<b>def</b>,
that:</p>
<pre>
<tt>"$foo""$bar"
</tt></pre>
<br>
<p class="tent">expands to the single field:</p>
<pre>
<tt>abcdef
</tt></pre>
<p class="tent">The rule concerning empty fields can be illustrated by:</p>
<pre>
<b>$</b><tt>    unset foo
</tt><b>$</b><tt>    set $foo bar '' xyz "$foo" abc
</tt><b>$</b><tt>    for i
</tt><b>&gt;</b><tt>    do
</tt><b>&gt;</b><tt>        echo "-$i-"
</tt><b>&gt;</b><tt>    done
</tt><b>-bar-
--
-xyz-
--
-abc-</b><tt>
</tt></pre>
<p class="tent">Step (1) indicates that parameter expansion, command substitution, and arithmetic expansion are all processed
simultaneously as they are scanned. For example, the following is valid arithmetic:</p>
<pre>
<tt>x=1
echo $(( $(echo 3)+$x ))
</tt></pre>
<p class="tent">An early proposal stated that tilde expansion preceded the other steps, but this is not the case in known
historical implementations; if it were, and if a referenced home directory contained a <tt>'$'</tt> character, expansions would
result within the directory name.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0003 [49,430] is applied.</p>
<p class="tent">Austin Group Defect 249 is applied, adding the dollar-single-quotes quoting mechanism.</p>
<p class="tent">Austin Group Defect 985 is applied, clarifying that quote removal is not always performed.</p>
<p class="tent">Austin Group Defect 1038 is applied, clarifying that a <tt>'$'</tt> that is followed by a &lt;space&gt;,
&lt;tab&gt;, or a &lt;newline&gt;, or is not followed by any character, is treated as a literal character.</p>
<p class="tent">Austin Group Defect 1123 is applied, clarifying the environment in which expansions are performed and requirements
relating to empty fields.</p>
<p class="tent">Austin Group Defect 1193 is applied, adding optional brace expansion.</p>
<h5 class="header4"><a name="tag_23_02_06_01" id="tag_23_02_06_01"></a>C.2.6.1 Tilde Expansion</h5>
<p class="tent">Tilde expansion generally occurs only at the beginning of words, but an exception based on historical practice has
been included:</p>
<pre>
<tt>PATH=/posix/bin:~dgk/bin
</tt></pre>
<p class="tent">This is eligible for tilde expansion because &lt;tilde&gt; follows a &lt;colon&gt; and none of the relevant
characters is quoted. Consideration was given to prohibiting this behavior because any of the following are reasonable
substitutes:</p>
<pre>
<tt>PATH=$(printf %s ~karels/bin : ~bostic/bin)
<br class="tent">
for Dir in ~maart/bin ~srb/bin ...
do
    PATH=${PATH:+$PATH:}$Dir
done
</tt></pre>
<p class="tent">In the first command, explicit &lt;colon&gt; characters are used for each directory. In all cases, the shell
performs tilde expansion on each directory because all are separate words to the shell.</p>
<p class="tent">Note that expressions in operands such as:</p>
<pre>
<tt>make -k mumble LIBDIR=~chet/lib
</tt></pre>
<p class="tent">do not qualify as shell variable assignments, and tilde expansion is not performed (unless the command does so
itself, which <a href="../utilities/make.html"><i>make</i></a> does not).</p>
<p class="tent">Because of the requirement that the word is not quoted, the following are not equivalent; only the last causes
tilde expansion:</p>
<pre>
<tt>\~hlj/   ~h\lj/   ~"hlj"/   ~hlj\/   ~hlj/
</tt></pre>
<p class="tent">In an early proposal, tilde expansion occurred following any unquoted &lt;equals-sign&gt; or &lt;colon&gt;, but
this was removed because of its complexity and to avoid breaking commands such as:</p>
<pre>
<tt>rcp hostname:~marc/.profile .
</tt></pre>
<p class="tent">System administrators on systems where <b>//</b> has an implementation-defined meaning which is different to
<b>/</b>, should not create users with a home directory of <b>/</b> or <b>//</b>, since this may lead to unexpected filename
resolution on those systems.</p>
<p class="tent">A suggestion was made that the special sequence <tt>"$~"</tt> should be allowed to force tilde expansion anywhere.
Since this is not historical practice, it has been left for future implementations to evaluate. (The description in XCU <a href=
"../utilities/V3_chap02.html#tag_19_02"><i>2.2 Quoting</i></a> requires that a &lt;dollar-sign&gt; be quoted to represent itself,
so the <tt>"$~"</tt> combination is already unspecified.)</p>
<p class="tent">The results of giving &lt;tilde&gt; with an unknown login name are undefined because the KornShell <tt>"~+"</tt>
and <tt>"~-"</tt> constructs make use of this condition, but in general it is an error to give an incorrect login name with
&lt;tilde&gt;. The results of having <i>HOME</i> unset are unspecified because some historical shells treat this as an error.</p>
<p class="tent">Historically, the Korn shell performed field splitting and pathname expansion on the results of tilde expansion,
and earlier versions of this standard reflected this. However, tilde expansion results in a pathname, and performing field
splitting and pathname expansion on something that is already a pathname is at best redundant and at worst will change the value
from the correct pathname to one or more incorrect ones. Later versions of the Korn shell do not perform these expansions and
POSIX.1-2024 has been updated to match. Note that although pathname expansion is not performed on the results of tilde expansion,
this does not prevent other parts of the same word from being expanded. For example, ~/a* expands to all files in <b>$HOME</b>
beginning with <tt>'a'</tt>.</p>
<p class="tent">Austin Group Defect 1172 is applied, clarifying how quoting affects tilde expansion.</p>
<p class="tent">Austin Group Defect 1632 is applied, clarifying the treatment of &lt;slash&gt; characters in tilde expansion.</p>
<h5 class="header4"><a name="tag_23_02_06_02" id="tag_23_02_06_02"></a>C.2.6.2 Parameter Expansion</h5>
<p class="tent">The rule for finding the closing <tt>'}'</tt> in <tt>"${...}"</tt> is the one used in the KornShell and is
upwardly-compatible with the Bourne shell, which does not determine the closing <tt>'}'</tt> until the word is expanded. The
advantage of this is that incomplete expansions, such as:</p>
<pre>
<tt>${foo
</tt></pre>
<p class="tent">can be determined during tokenization, rather than during expansion.</p>
<p class="tent">Quote removal is performed when assigning the value in the ${<i>parameter</i>:=<b>[</b><i>word</i><b>]</b>} form of
expansion in order that a subsequent expansion of the same parameter produces the same value as the original expansion. That is,
the commands:</p>
<pre>
<tt>unset parameter
foo=${parameter:=word}
bar=${parameter}
</tt></pre>
<p class="tent">assign the same value to <i>foo</i> and <i>bar</i>. A consequence of this is that the expansions
${<i>parameter</i>:=<b>[</b><i>word</i><b>]</b>} and ${<i>parameter</i>:-<b>[</b><i>word</i><b>]</b>} can produce different results
for the same <i>word</i>. For example, with <i>parameter</i> unset or empty:</p>
<pre>
<tt>${parameter:-a\ b}
</tt></pre>
<p class="tent">expands to a single field "a b", whereas:</p>
<pre>
<tt>${parameter:=a\ b}
</tt></pre>
<p class="tent">expands to two fields <tt>'a'</tt> and <tt>'b'</tt> (because <i>parameter</i> is assigned the value <tt>"a b"</tt>
before its value is substituted).</p>
<p class="tent">For rationale regarding expansion of <tt>"${...}"</tt> within double-quotes, see <a href="#tag_23_02_02_03">C.2.2.3
Double-Quotes</a>.</p>
<p class="tent">The string length and substring capabilities were included because of the demonstrated need for them, based on
their usage in other shells, such as C shell and KornShell.</p>
<p class="tent">Historical versions of the KornShell have not performed tilde expansion on the word part of parameter expansion;
however, it is more consistent to do so.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0004 [458], XCU/TC1-2008/0005 [458], XCU/TC1-2008/0006 [457],
XCU/TC1-2008/0007 [457], XCU/TC1-2008/0008 [417], XCU/TC1-2008/0009 [457], XCU/TC1-2008/0010 [457], XCU/TC1-2008/0011 [457],
XCU/TC1-2008/0012 [457], XCU/TC1-2008/0013 [457], XCU/TC1-2008/0014 [457], XCU/TC1-2008/0015 [457], XCU/TC1-2008/0016 [457],
XCU/TC1-2008/0017 [457], and XCU/TC1-2008/0018 [458] are applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0013 [888] and XCU/TC2-2008/0014 [867] are applied.</p>
<p class="tent">Austin Group Defect 221 is applied, removing a statement about counting brace levels and clarifying that quote
removal is performed when expanding <i>word</i> in ${<i>parameter</i>:=<b>[</b><i>word</i><b>]</b>}.</p>
<p class="tent">Austin Group Defect 985 is applied, clarifying when quote removal is performed.</p>
<p class="tent">Austin Group Defect 1052 is applied, clarifying the description of string length expansion.</p>
<p class="tent">Austin Group Defect 1268 is applied, removing text relating to parameter expansion inside double-quotes.</p>
<p class="tent">Austin Group Defect 1478 is applied, making explicitly unspecified the results of parameter expansions that test
whether the parameter <tt>'*'</tt> or <tt>'@'</tt> is unset or null.</p>
<p class="tent">Austin Group Defect 1491 is applied, restructuring a paragraph that used &quot;Otherwise&quot; after two conditions.</p>
<p class="tent">Austin Group Defect 1561 is applied, clarifying that the varieties of parameter expansion that provide for
substring processing process parameter values as characters.</p>
<h5 class="header4"><a name="tag_23_02_06_03" id="tag_23_02_06_03"></a>C.2.6.3 Command Substitution</h5>
<p class="tent">The <tt>"$()"</tt> form of command substitution solves a problem of inconsistent behavior when using backquotes.
For example:</p>
<center>
<table border="1" cellpadding="3" align="center">
<tr valign="top">
<th align="center">
<p class="tent"><b>Command</b></p>
</th>
<th align="center">
<p class="tent"><b>Output</b></p>
</th>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">echo '\$x'</p>
</td>
<td align="left">
<p class="tent">\$x</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">echo `echo '\$x'`</p>
</td>
<td align="left">
<p class="tent">$x</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">echo $(echo '\$x')</p>
</td>
<td align="left">
<p class="tent">\$x</p>
</td>
</tr>
</table>
</center>
<p class="tent">Additionally, the backquoted syntax has historical restrictions on the contents of the embedded command. While the
newer <tt>"$()"</tt> form can process any kind of valid embedded script (with a few caveats; see below), the backquoted form cannot
handle some valid scripts that include backquotes. For example, these otherwise valid embedded scripts do not work in the left
column, but do work on the right:</p>
<pre>
<tt>echo `                         echo $(
cat &lt;&lt;\eof                     cat &lt;&lt;\eof
a here-doc with `              a here-doc with )
eof                            eof
`                              )
<br class="tent">
echo `                         echo $(
echo abc # a comment with `    echo abc # a comment with )
`                              )
<br class="tent">
echo `                         echo $(
echo '`'                       echo ')'
`                              )
</tt></pre>
<p class="tent">Because of these inconsistent behaviors, the backquoted variety of command substitution is not recommended for new
applications that nest command substitutions or attempt to embed complex scripts.</p>
<p class="tent">The KornShell feature:</p>
<blockquote>If the <i>commands</i> string is of the form &lt;<i>word</i>, <i>word</i> is expanded to generate a pathname, and the
value of the command substitution is the contents of this file with any trailing &lt;newline&gt; characters deleted.</blockquote>
<p class="tent">was omitted from the Shell and Utilities volume of POSIX.1-2024 because $(<a href=
"../utilities/cat.html"><i>cat</i></a> <i>word</i>) is an appropriate substitute. However, to prevent breaking numerous scripts
relying on this feature, it is unspecified to have a script within <tt>"$()"</tt> that has only redirections.</p>
<p class="tent">In IEEE&nbsp;Std&nbsp;1003.2-1992 the $(<i>commands</i>) form of command substitution only had unspecified behavior
for a <i>commands</i> string consisting solely of redirections. However, two additional unspecified cases have since been added
with relation to aliases:</p>
<ol>
<li class="tent">Implementations are permitted to parse the entire <i>commands</i> string before executing any of it, and in this
case <a href="../utilities/alias.html"><i>alias</i></a> and <a href="../utilities/unalias.html"><i>unalias</i></a> commands in
<i>commands</i> have no effect during parsing. For example, the following commands:
<pre>
<tt>alias foo='echo "hello globe"'
echo $(alias foo='echo "Hello World"';foo)
</tt></pre>
<p class="tent">produce the output <tt>"hello globe"</tt> if the <i>commands</i> string is executed as an entire command and
produce the output <tt>"Hello World"</tt> if the <i>commands</i> string is executed incrementally.</p>
</li>
<li class="tent">Although existing aliases are required to be expanded when the shell parses the input that follows the
<tt>"$("</tt> in order to find the terminating <tt>')'</tt> (see <a href="../utilities/V3_chap02.html#tag_19_03"><i>2.3 Token
Recognition</i></a>), it is unspecified whether the terminating <tt>')'</tt> can result from alias substitution. For example, with
this script:
<pre>
<tt>alias foo="echo foo )"
echo $(foo ; echo bar
</tt></pre>
<p class="tent">some shells output lines containing <tt>"foo"</tt> and <tt>"bar"</tt> whereas other shells report a syntax error
because they do not find a terminating <tt>')'</tt> for the command substitution.</p>
</li>
</ol>
<p class="tent">Arithmetic expansions have precedence over command substitutions. That is, if the shell can parse an expansion
beginning with <tt>"$(("</tt> as an arithmetic expansion then it will do so. It will only parse the expansion as a command
substitution (that starts with a subshell) if it determines that it cannot parse the expansion as an arithmetic expansion. If the
syntax is valid for neither type of expansion, then it is unspecified what kind of syntax error the shell reports.</p>
<p class="tent">How well the shell performs this determination is a quality of implementation issue. Current shell implementations
use heuristics. In particular, the shell need not evaluate nested expansions when determining whether it can parse an expansion
beginning with <tt>"$(("</tt> as an arithmetic expansion. For example:</p>
<pre>
<tt>$((a $op b))
</tt></pre>
<p class="tent">is always an arithmetic expansion if <tt>"$op"</tt> expands to, say, <tt>'+'</tt>, but if <tt>"$op"</tt> expands to
<tt>'('</tt> then the shell might still parse the expansion as an arithmetic expansion (resulting in a syntax error due to
unbalanced parentheses) or it might perform a command substitution.</p>
<p class="tent">This standard requires that conforming applications always separate the <tt>"$("</tt> and <tt>'('</tt> with white
space when a command substitution starts with a subshell. This is because implementations may support extensions in arithmetic
expressions which could result in the shell parsing the input as an arithmetic expansion even though a minimally conforming shell
would not. For example, many shells support arrays with the array index (which can be an expression) in square brackets. Therefore,
the presence of <tt>"myfile[0-9]"</tt> within an expansion beginning <tt>"$(("</tt> is no guarantee that it will be parsed as a
command substitution.</p>
<p class="tent">The ambiguity is not restricted to the simple case of a single subshell. More complicated ambiguous cases are
possible (even with just the standard shell syntax), such as:</p>
<pre>
<tt>$(( cat &lt;&lt;EOH
+ ( (
EOH
) &amp;& ( cat &lt;&lt;EOH
) ) + 1 +
EOH
))
</tt></pre>
<p class="tent">This can be parsed as an arithmetic expansion, with <i>cat</i> and <i>EOH</i> as the names of shell variables.
Ambiguous cases also exist where the end of the expansion is at a different location for the arithmetic expansion and the command
substitution:</p>
<pre>
<tt>$((cat &lt;&lt;EOF
+((((
EOF
) &amp;& (
cat &lt;&lt;EOF
+
EOF
))
</tt></pre>
<p class="tent">This is an incomplete arithmetic expansion, but would have been a (complete) command substitution if it could not
have been parsed as an arithmetic expansion. If this expansion occurs at the end of input then the shell reports a syntax error; it
does not parse it as a command substitution.</p>
<p class="tent">IEEE&nbsp;Std&nbsp;1003.1-2001/Cor&nbsp;1-2002, item XCU/TC1/D6/4 is applied, changing the text from: &quot;If a
command substitution occurs inside double-quotes, it shall not be performed on the results of the substitution.&quot; to: &quot;If a
command substitution occurs inside double-quotes, field splitting and pathname expansion shall not be performed on the results of
the substitution.&quot;. The replacement text taken from the ISO&nbsp;POSIX-2:1993 standard is clearer about the items that are not
performed.</p>
<p class="tent">SD5-XCU-ERN-84 is applied, clarifying how the search for the matching backquote is satisfied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0019 [217] is applied.</p>
<p class="tent">Austin Group Defect 249 is applied, adding the dollar-single-quotes quoting mechanism.</p>
<p class="tent">Austin Group Defect 953 is applied, clarifying how the commands in command substitutions are parsed.</p>
<p class="tent">Austin Group Defect 1015 is applied, clarifying the handling of &lt;backslash&gt; when a backquoted command
substitution is within double-quotes.</p>
<p class="tent">Austin Group Defect 1268 is applied, removing text relating to command substitution inside double-quotes.</p>
<p class="tent">Austin Group Defect 1342 is applied, clarifying the requirements for alias substitutions inside command
substitutions.</p>
<p class="tent">Austin Group Defect 1560 is applied, clarifying that the standard output of the command(s) in a command
substitution is treated as a sequence of bytes.</p>
<h5 class="header4"><a name="tag_23_02_06_04" id="tag_23_02_06_04"></a>C.2.6.4 Arithmetic Expansion</h5>
<p class="tent">The standard developers agreed that there was a strong desire for some kind of arithmetic evaluator to provide
functionality similar to <a href="../utilities/expr.html"><i>expr</i></a>, that relating it to <tt>'$'</tt> makes it work well with
the standard shell language and provides access to arithmetic evaluation in places where accessing a utility would be
inconvenient.</p>
<p class="tent">The syntax and semantics for arithmetic were revised for the ISO/IEC&nbsp;9945-2:1993 standard. The language
represents a simple subset of the previous arithmetic language (which was derived from the KornShell <tt>"(())"</tt> construct).
The syntax was changed from that of a command denoted by ((<i>expression</i>)) to an expansion denoted by $((<i>expression</i>)).
The new form is a dollar expansion (<tt>'$'</tt>) that evaluates the expression and substitutes the resulting value. Objections to
the previous style of arithmetic included that it was too complicated, did not fit in well with the use of variables in the shell,
and its syntax conflicted with subshells. The justification for the new syntax is that the shell is traditionally a macro language,
and if a new feature is to be added, it should be accomplished by extending the capabilities presented by the current model of the
shell, rather than by inventing a new one outside the model; adding a new dollar expansion was perceived to be the most intuitive
and least destructive way to add such a new capability.</p>
<p class="tent">The standard requires assignment operators to be supported (as listed in XCU <a href=
"../utilities/V3_chap01.html#tag_18_01_02"><i>1.1.2 Concepts Derived from the ISO C Standard</i></a>), and since arithmetic
expansions are not specified to be evaluated in a subshell environment, changes to variables there have to be in effect after the
arithmetic expansion, just as in the parameter expansion <tt>"${x=value}"</tt>.</p>
<p class="tent">Note, however, that <tt>"$((&nbsp;x=5&nbsp;))"</tt> need not be equivalent to <tt>"$((&nbsp;$x=5&nbsp;))"</tt>. If
the value of the environment variable <i>x</i> is the string <tt>"y="</tt>, the expansion of <tt>"$((&nbsp;x=5&nbsp;))"</tt> would
set <i>x</i> to 5 and output 5, but <tt>"$((&nbsp;$x=5&nbsp;))"</tt> would output 0 if the value of the environment variable
<i>y</i> is not 5 and would output 1 if the environment variable <i>y</i> is 5. Similarly, if the value of the environment variable
is 4, the expansion of <tt>"$((&nbsp;x=5&nbsp;))"</tt> would still set <i>x</i> to 5 and output 5, but
<tt>"$((&nbsp;$x=5&nbsp;))"</tt> (which would be equivalent to <tt>"$((&nbsp;4=5&nbsp;))"</tt>) would yield a syntax error.</p>
<p class="tent">In early proposals, a form $[<i>expression</i>] was used. It was functionally equivalent to the <tt>"$(())"</tt> of
the current text, but objections were lodged that the 1988 KornShell had already implemented <tt>"$(())"</tt> and there was no
compelling reason to invent yet another syntax. Furthermore, the <tt>"$[]"</tt> syntax had a minor incompatibility involving the
patterns in <b>case</b> statements.</p>
<p class="tent">The portion of the ISO&nbsp;C standard arithmetic operations selected corresponds to the operations historically
supported in the KornShell. In addition to the exceptions listed in XCU <a href="../utilities/V3_chap02.html#tag_19_06_04"><i>2.6.4
Arithmetic Expansion</i></a>, the use of the following are explicitly outside the scope of the rules defined in XCU <a href=
"../utilities/V3_chap01.html#tag_18_01_02_01"><i>1.1.2.1 Arithmetic Precision and Operations</i></a>:</p>
<ul>
<li class="tent">The prefix operator <tt>'&amp;'</tt> and the <tt>"[]"</tt>, <tt>"-&gt;"</tt>, and <tt>'.'</tt> operators.</li>
<li class="tent">Casts</li>
</ul>
<p class="tent">It was concluded that the <a href="../utilities/test.html"><i>test</i></a> command (<b>[</b>) was sufficient for
the majority of relational arithmetic tests, and that tests involving complicated relational expressions within the shell are rare,
yet could still be accommodated by testing the value of <tt>"$(())"</tt> itself. For example:</p>
<pre>
<tt># a complicated relational expression
while [ $(( (($x + $y)/($a * $b)) &lt; ($foo*$bar) )) -ne 0 ]
</tt></pre>
<p class="tent">or better yet, the rare script that has many complex relational expressions could define a function like this:</p>
<pre>
<tt>val() {
    return $((!$1))
}
</tt></pre>
<p class="tent">and complicated tests would be less intimidating:</p>
<pre>
<tt>while val $(( (($x + $y)/($a * $b)) &lt; ($foo*$bar) ))
do
    # some calculations
done
</tt></pre>
<p class="tent">A suggestion that was not adopted was to modify <a href="../utilities/true.html"><i>true</i></a> and <a href=
"../utilities/false.html"><i>false</i></a> to take an optional argument, and <a href="../utilities/true.html"><i>true</i></a> would
exit true only if the argument was non-zero, and <a href="../utilities/false.html"><i>false</i></a> would exit false only if the
argument was non-zero:</p>
<pre>
<tt>while true $(($x &gt; 5 &amp;& $y &lt;= 25))
</tt></pre>
<p class="tent">There is a minor portability concern with the new syntax. The example <tt>"$((2+2))"</tt> could have been intended
to mean a command substitution of a utility named <tt>"2+2"</tt> in a subshell. The standard developers considered this to be
obscure and isolated to some KornShell scripts (because <tt>"$()"</tt> command substitution existed previously only in the
KornShell). The text on command substitution requires that the <tt>"$("</tt> and <tt>'('</tt> be separate tokens if this usage is
needed.</p>
<p class="tent">An example such as:</p>
<pre>
<tt>echo $((echo hi);(echo there))
</tt></pre>
<p class="tent">should not be misinterpreted by the shell as arithmetic because attempts to balance the parentheses pairs would
indicate that they are subshells. However, as indicated by XBD <a href="../basedefs/V1_chap03.html#tag_03_85"><i>3.85 Control
Operator</i></a>, a conforming application must separate two adjacent parentheses with white space to indicate nested
subshells.</p>
<p class="tent">The standard is intentionally silent about how a variable's numeric value in an expression is determined from its
normal &quot;sequence of bytes&quot; value. It could be done as a text substitution, as a conversion like that performed by <a href=
"../functions/strtol.html"><i>strtol</i>()</a>, or even recursive evaluation. Therefore, the only cases for which the standard is
clear are those for which both conversions produce the same result. The cases where they give the same result are those where the
sequence of bytes form a valid integer constant. Therefore, if a variable does not contain a valid integer constant, the behavior
is unspecified.</p>
<p class="tent">For the commands:</p>
<pre>
<tt>x=010; echo $((x += 1))
</tt></pre>
<p class="tent">the output must be 9.</p>
<p class="tent">For the commands:</p>
<pre>
<tt>x=' 1'; echo $((x += 1))
</tt></pre>
<p class="tent">the results are unspecified.</p>
<p class="tent">For the commands:</p>
<pre>
<tt>x=1+1; echo $((x += 1))
</tt></pre>
the results are unspecified.
<p class="tent">Although the ISO&nbsp;C standard requires support for <b>long long</b> and allows extended integer types with
higher ranks, POSIX.1-2024 only requires arithmetic expansions to support <b>signed long</b> integer arithmetic. Implementations
are encouraged to support signed integer values at least as large as the size of the largest file allowed on the
implementation.</p>
<p class="tent">Implementations are also allowed to perform floating-point evaluations as long as an application won't see
different results for expressions that would not overflow <b>signed long</b> integer expression evaluation. (This includes
appropriate truncation of results to integer values.)</p>
<p class="tent">Changes made in response to IEEE PASC Interpretation 1003.2 #208 removed the requirement that the integer constant
suffixes <tt>l</tt> and <tt>L</tt> had to be recognized. The ISO&nbsp;POSIX-2:1993 standard did not require the <tt>u</tt>,
<tt>ul</tt>, <tt>uL</tt>, <tt>U</tt>, <tt>Ul</tt>, <tt>UL</tt>, <tt>lu</tt>, <tt>lU</tt>, <tt>Lu</tt>, and <tt>LU</tt> suffixes
since only signed integer arithmetic was required. Since all arithmetic expressions were treated as handling <b>signed long</b>
integer types anyway, the <tt>l</tt> and <tt>L</tt> suffixes were redundant. No known scripts used them and some historic shells
did not support them. When the ISO/IEC&nbsp;9899:1999 standard was used as the basis for the description of arithmetic processing,
the <tt>ll</tt> and <tt>LL</tt> suffixes and combinations were also not required. Implementations are still free to accept any or
all of these suffixes, but are not required to do so.</p>
<p class="tent">There was also some confusion as to whether the shell was required to recognize character constants. Syntactically,
character constants were required to be recognized, but the requirements for the handling of &lt;backslash&gt; and single-quote
characters (needed to specify character constants) within an arithmetic expansion were ambiguous. Furthermore, no known shells
supported them. Changes made in response to IEEE PASC Interpretation 1003.2 #208 removed the requirement to support them (if they
were indeed required before). POSIX.1-2024 clearly does not require support for character constants.</p>
<p class="tent">IEEE&nbsp;Std&nbsp;1003.1-2001/Cor&nbsp;2-2004, item XCU/TC2/D6/3 is applied, clarifying arithmetic
expressions.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0020 [50] is applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0015 [584] is applied.</p>
<h5 class="header4"><a name="tag_23_02_06_05" id="tag_23_02_06_05"></a>C.2.6.5 Field Splitting</h5>
<p class="tent">The operation of field splitting using <i>IFS ,</i> as described in early proposals, was based on the way the
KornShell splits words, but it is incompatible with other common versions of the shell. However, each has merit, and so a decision
was made to allow both. If the <i>IFS</i> variable is unset or is &lt;space&gt;&lt;tab&gt;&lt;newline&gt;, the operation is
equivalent to the way the System&nbsp;V shell splits words. Using characters outside the &lt;space&gt;&lt;tab&gt;&lt;newline&gt;
set yields the KornShell behavior, where each of the non-&lt;space&gt;&lt;tab&gt;&lt;newline&gt;s is significant. This behavior,
which affords the most flexibility, was taken from the way the original <a href="../utilities/awk.html"><i>awk</i></a> handled
field splitting.</p>
<p class="tent">The different handling of white space and non-white-space characters in <i>IFS</i> can be summarized as a
pseudo-ERE:</p>
<pre>
<tt>(</tt><i>s</i><tt>*</tt><i>ns</i><tt>*|</tt><i>s</i><tt>+)
</tt></pre>
<p class="tent">where <i>s</i> is an <i>IFS</i> white-space character and <i>n</i> is a character in the <i>IFS</i> that is not
white space. Any string matching that ERE delimits a field, except that the <i>s</i>+ form does not delimit fields at the beginning
or the end of a line. For example, if <i>IFS</i> is &lt;space&gt;/&lt;comma&gt;/&lt;tab&gt;, the string:</p>
<pre>
<tt>&lt;space&gt;&lt;space&gt;red&lt;space&gt;&lt;space&gt;,&lt;space&gt;white&lt;space&gt;blue
</tt></pre>
<p class="tent">yields the three colors as the delimited fields.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0016 [832] is applied.</p>
<p class="tent">Austin Group Defect 1123 is applied, clarifying the requirements if no fields are delimited.</p>
<p class="tent">Austin Group Defect 1560 is applied, clarifying that the results of word expansions are treated as a sequences of
bytes when searching for (bytes that form) <i>IFS</i> characters.</p>
<p class="tent">Austin Group Defect 1649 is applied, clarifying how field splitting is performed.</p>
<h5 class="header4"><a name="tag_23_02_06_06" id="tag_23_02_06_06"></a>C.2.6.6 Pathname Expansion</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5 class="header4"><a name="tag_23_02_06_07" id="tag_23_02_06_07"></a>C.2.6.7 Quote Removal</h5>
<p class="tent">The golden rule in quote removal is that if a quote character was treated as special in the original word, it is
removed; if it was treated as a literal character, it is not removed.</p>
<p class="tent">Austin Group Defect 221 is applied, clarifying the conditions under which quote characters are, or are not,
removed.</p>
<p class="tent">Austin Group Defect 249 is applied, adding the dollar-single-quotes quoting mechanism.</p>
<h4><a name="tag_23_02_07" id="tag_23_02_07"></a>C.2.7 Redirection</h4>
<p class="tent">In the System Interfaces volume of POSIX.1-2024, file descriptors are integers in the range 0-({OPEN_MAX}-1). The
file descriptors discussed in XCU <a href="../utilities/V3_chap02.html#tag_19_07"><i>2.7 Redirection</i></a> are that same set of
small integers.</p>
<p class="tent">Having multi-digit file descriptor numbers for I/O redirection can cause some obscure compatibility problems.
Specifically, scripts that depend on an example command:</p>
<pre>
<tt>echo 22&gt;/dev/null
</tt></pre>
<p class="tent">echoing <tt>"2"</tt> to standard error or <tt>"22"</tt> to standard output are no longer portable. However, the
file descriptor number must still be delimited from the preceding text. For example:</p>
<pre>
<tt>cat file2&gt;foo
</tt></pre>
<p class="tent">writes the contents of <b>file2</b>, not the contents of <b>file</b>.</p>
<p class="tent">The limitation to 9 file descriptors is overcome in some shells via a form of redirection whereby a shell variable
stores the file descriptor number. For example:</p>
<pre>
<tt>exec {fdvar}&gt; foo
</tt></pre>
<p class="tent">opens the file <tt>foo</tt> on a file descriptor greater than 9 and stores the file descriptor number in shell
variable <tt>fdvar</tt>. (This can later be closed using <tt>exec {fdvar}&gt;&amp;-</tt>.) This form of redirection is allowed but
not required by this standard.</p>
<p class="tent">The <tt>"&gt;|"</tt> format of output redirection was adopted from the KornShell. Along with the <i>noclobber</i>
option, <a href="../utilities/V3_chap02.html#set"><i>set</i></a> <b>-C</b>, it provides a safety feature to prevent inadvertent
overwriting of existing files. (See the RATIONALE for the <a href="../utilities/pathchk.html"><i>pathchk</i></a> utility for why
this step was taken.) The restriction on regular files is historical practice.</p>
<p class="tent">The System&nbsp;V shell and the KornShell have differed historically on pathname expansion of <i>word</i>; the
former never performed it, the latter only when the result was a single field (file). As a compromise, it was decided that the
KornShell functionality was useful, but only as a shorthand device for interactive users. No reasonable shell script would be
written with a command such as:</p>
<pre>
<tt>cat foo &gt; a*
</tt></pre>
<p class="tent">Thus, shell scripts are prohibited from doing it, while interactive users can select the shell with which they are
most comfortable.</p>
<p class="tent">The construct <tt>"2&gt;&amp;1"</tt> is often used to redirect standard error to the same file as standard output.
Since the redirections take place beginning to end, the order of redirections is significant. For example:</p>
<pre>
<tt>ls &gt; foo 2&gt;&amp;1
</tt></pre>
<p class="tent">directs both standard output and standard error to file <b>foo</b>. However:</p>
<pre>
<tt>ls 2&gt;&amp;1 &gt; foo
</tt></pre>
<p class="tent">only directs standard output to file <b>foo</b> because standard error was duplicated as standard output before
standard output was directed to file <b>foo</b>.</p>
<p class="tent">Applications should not use the <b>[</b><i>n</i><b>]</b><tt>&lt;&amp;-</tt> or
<b>[</b><i>n</i><b>]</b><tt>&gt;&amp;-</tt> operators to execute a utility or application with file descriptor 0 not open for
reading or with file descriptor 1 or 2 not open for writing, as this might cause the executed program (or shell built-in) to
misbehave. In order not to pass on these file descriptors to an executed utility or application, applications should not just close
them but should reopen them on, for example, <b>/dev/null</b>. Some implementations may reopen them automatically, but applications
should not rely on this being done.</p>
<p class="tent">The <tt>"&lt;&gt;"</tt> operator could be useful in writing an application that worked with several terminals, and
occasionally wanted to start up a shell. That shell would in turn be unable to run applications that run from an ordinary
controlling terminal unless it could make use of <tt>"&lt;&gt;"</tt> redirection. The specific example is a historical version of
the pager <a href="../utilities/more.html"><i>more</i></a>, which reads from standard error to get its commands, so standard input
and standard output are both available for their usual usage. There is no way of saying the following in the shell without
<tt>"&lt;&gt;"</tt>:</p>
<pre>
<tt>cat food | more - &gt;/dev/tty03 2&lt;&gt;/dev/tty03
</tt></pre>
<p class="tent">Another example of <tt>"&lt;&gt;"</tt> is one that opens <b>/dev/tty</b> on file descriptor 3 for reading and
writing:</p>
<pre>
<tt>exec 3&lt;&gt; /dev/tty
</tt></pre>
<p class="tent">An example of creating a lock file for a critical code region:</p>
<pre>
<tt>set -C
until    2&gt; /dev/null &gt; lockfile
do       sleep 30
done
set +C
</tt><i>perform critical function</i><tt>
rm lockfile
</tt></pre>
<p class="tent">Since <b>/dev/null</b> is not a regular file, no error is generated by redirecting to it in <i>noclobber</i>
mode.</p>
<p class="tent">Tilde expansion is not performed on a here-document because the data is treated as if it were enclosed in
double-quotes.</p>
<p class="tent">Austin Group Defect 1193 is applied, adding the optional redirection form
<b>{</b><i>location</i><b>}</b><i>redir-op word</i>.</p>
<p class="tent">Austin Group Defect 1232 is applied, clarifying the allowed behaviors in an interactive shell when pathname
expansion on the word following a redirection operator would result in more than one word.</p>
<p class="tent">Austin Group Defect 1493 is applied, moving some information from this section to the definition of &quot;file
descriptor&quot; in XBD <a href="../basedefs/V1_chap03.html#tag_03_141"><i>3.141 File Descriptor</i></a>.</p>
<h5 class="header4"><a name="tag_23_02_07_01" id="tag_23_02_07_01"></a>C.2.7.1 Redirecting Input</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5 class="header4"><a name="tag_23_02_07_02" id="tag_23_02_07_02"></a>C.2.7.2 Redirecting Output</h5>
<p class="tent">Earlier versions of this standard did not require redirection using <tt>'&gt;'</tt> when <i>noclobber</i> is set to
perform the file creation step as an atomic operation. Historical shells just called <a href=
"../functions/stat.html"><i>stat</i>()</a> to check if a regular file existed and then called <a href=
"../functions/creat.html"><i>creat</i>()</a>. The operation thus involved a race condition which meant that it could not be used
for reliable creation of lock files. Many shell implementations improved on this by using <a href=
"../functions/open.html"><i>open</i>()</a> with the O_CREAT and O_EXCL flags set as one step in a multi-step process which still
meant that an existing non-regular file (for example <b>/dev/null</b>, <b>/dev/tty</b>, or a FIFO) was opened successfully.
However, the methods employed still involved a race condition and could produce misleading diagnostics if there is concurrent
creation or removal of files.</p>
<p class="tent">An ideal solution would be an O_NOCLOBBER flag for <a href="../functions/open.html"><i>open</i>()</a> which the
shell could use in order to perform the entire operation atomically, and implementations are encouraged to adopt this solution,
adding the flag as described in the FUTURE DIRECTIONS section of <a href="../functions/open.html#"><i>open</i>()</a>, and using it
in the implementation's POSIX shell and in other shells. Authors of portable shells should make use of <tt>#ifdef O_NOCLOBBER</tt>
so that it is used on implementations that provide it.</p>
<p class="tent">If O_NOCLOBBER is not used, shells can use one of the following methods:</p>
<ol>
<li class="tent">The &quot;stat first&quot; method.
<ol type="a">
<li class="tent">Call <a href="../functions/stat.html"><i>stat</i>()</a> and if the file exists and is a regular file, the
redirection fails. Otherwise:</li>
<li class="tent">Call <a href="../functions/open.html"><i>open</i>()</a> without O_CREAT or O_TRUNC to open an existing file. If
the open succeeds, use <a href="../functions/fstat.html"><i>fstat</i>()</a> to check whether the opened file is a regular file. If
it is, close it and fail the redirection. If it is a non-regular file, the redirection succeeds. Otherwise:</li>
<li class="tent">Call <a href="../functions/open.html"><i>open</i>()</a> with O_CREAT|O_EXCL. The redirection succeeds or fails
depending on whether the open succeeds or fails.</li>
</ol>
</li>
<li class="tent">The &quot;exclusive create first&quot; method.
<ol type="a">
<li class="tent">Call <a href="../functions/open.html"><i>open</i>()</a> with O_CREAT|O_EXCL. If the open succeeds, the redirection
succeeds. If the open fails with [EMFILE] or [ENFILE], use <a href="../functions/stat.html"><i>stat</i>()</a> to check whether a
regular file exists; if it does, fail the redirection. Otherwise:</li>
<li class="tent">Call <a href="../functions/open.html"><i>open</i>()</a> without O_CREAT or O_TRUNC to open an existing file. If
the open succeeds, use <a href="../functions/fstat.html"><i>fstat</i>()</a> to check whether the opened file is a regular file. If
it is, close it and fail the redirection. If it is a non-regular file, the redirection succeeds. If the second open fails, the
redirection fails with a diagnostic based on the <i>errno</i> value set by the first open.</li>
</ol>
<p class="tent">(A minor variation of this method could also be used whereby step 2.b is only done if the <a href=
"../functions/open.html"><i>open</i>()</a> in step 2.a fails with [EEXIST].)</p>
</li>
</ol>
<p class="tent">Method 1 is in widespread use. Method 2 has not been observed exactly as described, although an implementation
which omits the <a href="../functions/stat.html"><i>stat</i>()</a> in step 2.a has been observed. Without the <a href=
"../functions/stat.html"><i>stat</i>()</a>, this method has a problem in that if a regular file exists but the <a href=
"../functions/open.html"><i>open</i>()</a> fails with [EMFILE] or [ENFILE] instead of [EEXIST] (which is to be expected if those
conditions exist, because detecting [EEXIST] is more expensive), then the shell will give an incorrect diagnostic. (Reporting that
no file descriptors are available implies that a non-regular file exists, because the shell tried to open the file and it is not
supposed to open an existing regular file.)</p>
<p class="tent">A variant of method 1 which omits the initial <a href="../functions/stat.html"><i>stat</i>()</a> call has also been
observed; this has the same problem with [EMFILE] and [ENFILE]. With the <a href="../functions/stat.html"><i>stat</i>()</a>, this
misleading diagnostic can also happen, but only if a regular file is created in the timing window between steps 1.a and 1.b, which
makes it an allowed case. (The standard allows a misleading diagnostic when there is concurrent creation or removal of files.)</p>
<p class="tent">Both methods have cases where a misleading diagnostic is given when a non-regular file is concurrently created or
removed. With method 1 it occurs if no file exists at steps 1.a and 1.b, and a non-regular file is created before step 1.c. With
method 2 it occurs if a non-regular file exists at step 2.a and is removed before step 2.b. (In both cases, the diagnostic
misleadingly implies that a regular file exists).</p>
<p class="tent">Both methods differ from historical shell behavior in that the redirection fails if there is an existing symbolic
link whose target does not exist, instead of the link's target being created as a regular file. The standard developers consider
reliable lock file creation to be more important than the creation of symbolic link targets.</p>
<p class="tent">Creation of lock files and unique (often temporary) files with <i>noclobber</i> set is only reliable provided
neither non-regular files nor symbolic links to non-regular files exist or are created in the same directory with the same names,
and no other processes delete the files while still in use. If a directory such as <b>/tmp</b> is used for lock files, then another
process could accidentally or maliciously create a FIFO (or a special file, given sufficient privilege) with the same name, causing
multiple processes to simultaneously open the same lock file instead of one succeeding and the others failing.</p>
<p class="tent">Austin Group Defects 1016 and 1364 are applied, changing the requirements when the <i>noclobber</i> option is
set.</p>
<h5 class="header4"><a name="tag_23_02_07_03" id="tag_23_02_07_03"></a>C.2.7.3 Appending Redirected Output</h5>
<p class="tent">Note that when a file is opened (even with the O_APPEND flag set), the initial file offset for that file is set to
the beginning of the file. Some historic shells set the file offset to the current end-of-file when <b>append</b> mode shell
redirection was used, but this is not allowed by POSIX.1-2024.</p>
<p class="tent">Austin Group Defect 1016 is applied, changing &quot;with the O_APPEND flag&quot; to &quot;with the O_APPEND flag set&quot;.</p>
<h5 class="header4"><a name="tag_23_02_07_04" id="tag_23_02_07_04"></a>C.2.7.4 Here-Document</h5>
<p class="tent">Historical shell behavior was to treat the end of input as being equivalent to the delimiter of a here-document,
terminating the here-document, usually without any indication, and continuing as if the delimiter had been recognized. This can
cause problems where the delimiter had been intended to occur much earlier in the script, but was incorrectly enteredâa mistake
which for many other errors would have resulted in a syntax error, and an aborted script, instead simply generates incorrect
results. Because of this some shell implementations have changed to reporting an undelimited here-document as a syntax error. Other
implementations are encouraged to do the same.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0017 [890], XCU/TC2-2008/0018 [583], and XCU/TC2-2008/0019
[580] are applied.</p>
<p class="tent">Austin Group Defect 1036 is applied, clarifying how here-documents are parsed.</p>
<p class="tent">Austin Group Defect 1411 is applied, adding a paragraph break.</p>
<h5 class="header4"><a name="tag_23_02_07_05" id="tag_23_02_07_05"></a>C.2.7.5 Duplicating an Input File Descriptor</h5>
<p class="tent">The file descriptor duplication redirection operators, <b>[</b><i>n</i><b>]</b><tt>&lt;&</tt><i>word</i> and
<b>[</b><i>n</i><b>]</b><tt>&gt;&</tt><i>word</i>, make a copy of one file descriptor as another. If the operation is successful,
the new file descriptor has the same access mode as the source (old) file descriptor, because the access mode is determined by the
open file description to which both file descriptors point. To avoid a redirection error, applications need to ensure that they use
the appropriate redirection operator for the access mode of the file descriptor being duplicated.</p>
<p class="tent">Austin Group Defect 1536 is applied, making it optional whether attempting to duplicate an open file descriptor
that is not open for input results in a redirection error.</p>
<h5 class="header4"><a name="tag_23_02_07_06" id="tag_23_02_07_06"></a>C.2.7.6 Duplicating an Output File Descriptor</h5>
<p class="tent">See <a href="#tag_23_02_07_05">C.2.7.5 Duplicating an Input File Descriptor</a>.</p>
<p class="tent">Austin Group Defect 1536 is applied, making it optional whether attempting to duplicate an open file descriptor
that is not open for output results in a redirection error.</p>
<h5 class="header4"><a name="tag_23_02_07_07" id="tag_23_02_07_07"></a>C.2.7.7 Open File Descriptors for Reading and Writing</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h4><a name="tag_23_02_08" id="tag_23_02_08"></a>C.2.8 Exit Status and Errors</h4>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5 class="header4"><a name="tag_23_02_08_01" id="tag_23_02_08_01"></a>C.2.8.1 Consequences of Shell Errors</h5>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0020 [882] and XCU/TC2-2008/0021 [717,882] are applied.</p>
<p class="tent">Austin Group Defect 914 is applied, requiring that the shell does not exit when a redirection error occurs with
compound commands or with function execution.</p>
<p class="tent">Austin Group Defect 1427 is applied, changing this section to account for the effect of the <a href=
"../utilities/command.html"><i>command</i></a> utility when it is used to execute a special built-in utility.</p>
<p class="tent">Austin Group Defect 1629 is applied, requiring that the shell exits if an unrecoverable read error occurs when
reading commands.</p>
<h5 class="header4"><a name="tag_23_02_08_02" id="tag_23_02_08_02"></a>C.2.8.2 Exit Status for Commands</h5>
<p class="tent">There is a historical difference in <a href="../utilities/sh.html"><i>sh</i></a> and <i>ksh</i> non-interactive
error behavior. When a command named in a script is not found, some implementations of <a href="../utilities/sh.html"><i>sh</i></a>
exit immediately, but <i>ksh</i> continues with the next command. Thus, the Shell and Utilities volume of POSIX.1-2024 says that
the shell &quot;may&quot; exit in this case. This puts a small burden on the programmer, who has to test for successful completion
following a command if it is important that the next command not be executed if the previous command was not found. If it is
important for the command to have been found, it was probably also important for it to complete successfully. The test for
successful completion would not need to change.</p>
<p class="tent">Historically, shells have returned an exit status of 128+<i>n</i>, where <i>n</i> represents the signal number.
Since signal numbers are not standardized, there is no portable way to determine which signal caused the termination. Also, it is
possible for a command to exit with a status in the same range of numbers that the shell would use to report that the command was
terminated by a signal. Implementations are encouraged to choose exit values greater than 256 to indicate programs that terminate
by a signal so that the exit status cannot be confused with an exit status generated by a normal termination. However, the use of
exit values greater than 256 poses a problem for the shell's own exit status. Historically this was the exit status of the last
command invoked by the shell, but if the last command was terminated by a signal and was assigned an exit status greater than 256
by the shell, this value would be truncated to eight bits in the shell's exit status. Likewise truncation would occur with use
of</p>
<pre>
<tt>exit $?
</tt></pre>
<p class="tent">or</p>
<pre>
<tt>ret=$?
....
exit $ret
</tt></pre>
<p class="tent">in shell scripts. To avoid this truncation, shells which assign exit statuses greater than 256 are required to
propagate the wait status of the last command to the shell's own wait status (by sending itself the same signal), and to handle
exit values greater than 256 passed to the <a href="../utilities/exit.html"><i>exit</i></a> builtin by mimicking the wait status
that would give rise to assignment of that exit status in the shell. Note that this requirement does not apply to signals that do
not cause termination, such as SIGCHLD, since the shell can never actually assign a corresponding exit status greater than 256, and
the requirement is worded in terms of this assignment.</p>
<p class="tent">Historical shells make the distinction between &quot;utility not found&quot; and &quot;utility found but cannot execute&quot; in
their error messages. By specifying two seldomly used exit status values for these cases, 127 and 126 respectively, this gives an
application the opportunity to make use of this distinction without having to parse an error message that would probably change
from locale to locale. The <a href="../utilities/command.html"><i>command</i></a>, <a href="../utilities/env.html"><i>env</i></a>,
<a href="../utilities/nohup.html"><i>nohup</i></a>, and <a href="../utilities/xargs.html"><i>xargs</i></a> utilities in the Shell
and Utilities volume of POSIX.1-2024 have also been specified to use this convention.</p>
<p class="tent">When a command fails during word expansion or redirection, most historical implementations exit with a status of 1.
However, there was some sentiment that this value should probably be much higher so that an application could distinguish this case
from the more normal exit status values. Thus, the language &quot;greater than zero&quot; was selected to allow either method to be
implemented.</p>
<p class="tent">If a C application calls <tt>exit(256)</tt>, the command's exit status in the shell becomes zero due to the modulo
256 operation. Since zero is interpreted as &quot;true&quot; or &quot;success&quot; for <b>if</b> statements, AND and OR lists, <tt>set -e</tt>,
and so on, applications should be careful to avoid exiting with a value that is a multiple of 256 unless the value is intended to
be interpreted as true or success.</p>
<p class="tent">To avoid ambiguity caused by the modulo 256 operation, applications are encouraged to avoid using a count or the
result of a computation as the exit value unless the value is guaranteed to be non-negative and less than 256.</p>
<p class="tent">The ambiguity caused by the modulo 256 operation is unfortunate, but required due to historical implementation
behavior. A future version of this standard may change the definition of exit status to remove the modulo 256 requirement and use
all bits of the value passed to <a href="../functions/exit.html"><i>exit</i>()</a> (or equivalent), and may introduce a way to
select whether the special parameter <tt>'?'</tt> contains the exit status modulo 256 or the full exit status.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0022 [717] is applied.</p>
<p class="tent">Austin Group Defect 51 is applied, clarifying the exit status when a command is terminated due to the receipt of a
signal.</p>
<p class="tent">Austin Group Defect 947 is applied, clarifying the exit status of commands.</p>
<h4><a name="tag_23_02_09" id="tag_23_02_09"></a>C.2.9 Shell Commands</h4>
<p class="tent">A description of an &quot;empty command&quot; was removed from an early proposal because it is only relevant in the cases
of <a href="../utilities/sh.html"><i>sh</i></a> <b>-c</b> <tt>""</tt>, <i>system</i>(<tt>""</tt>), or an empty shell-script file
(such as the implementation of <a href="../utilities/true.html"><i>true</i></a> on some historical systems). Since it is no longer
mentioned in the Shell and Utilities volume of POSIX.1-2024, it falls into the silently unspecified category of behavior where
implementations can continue to operate as they have historically, but conforming applications do not construct empty commands.
(However, note that <a href="../utilities/sh.html"><i>sh</i></a> does explicitly state an exit status for an empty string or file.)
In an interactive session or a script with other commands, extra &lt;newline&gt; or &lt;semicolon&gt; characters, such as:</p>
<pre>
<tt>$ false
$
$ echo $?
1
</tt></pre>
<p class="tent">would not qualify as the empty command described here because they would be consumed by other parts of the
grammar.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0023 [473] is applied.</p>
<h5 class="header4"><a name="tag_23_02_09_01" id="tag_23_02_09_01"></a>C.2.9.1 Simple Commands</h5>
<p class="tent">Austin Group Defect 1224 is applied, correcting a mismatch between the description of simple commands and the
formal <i>simple_command</i> grammar.</p>
<p class="tent">Austin Group Defect 1227 is applied, inserting additional subsection headings.</p>
<h5><a name="tag_23_02_09_02" id="tag_23_02_09_02"></a>Order of Processing</h5>
<p class="tent">The enumerated list is used only when the command is actually going to be executed. For example, in:</p>
<pre>
<tt>true || $foo *
</tt></pre>
<p class="tent">no expansions are performed.</p>
<p class="tent">Expansion of words in an assignment context following the command name can only occur for declaration utilities,
and only when the word can be used as a variable assignment in isolation.</p>
<p class="tent">For example, this code sequence exports the single variable <i>a</i> with the value <tt>"1 b=2"</tt>, but invokes
<a href="../utilities/make.html"><i>make</i></a> with the macro <i>a</i> set to <tt>'1'</tt> and <i>b</i> set to <tt>'2'</tt>,
since <a href="../utilities/make.html"><i>make</i></a> is not a declaration utility:</p>
<pre>
<tt>set '1 b=2'
export a=$1
make a=$1
</tt></pre>
<p class="tent">Conversely, this code sequence exports two variables, <i>a</i> set to <tt>'1'</tt> and <i>b</i> set to
<tt>'2'</tt>, because the use of quoting means that the word could not be recognized as a variable assignment, and regular
expansion rules require that field splitting occurs on the unquoted expansion of <tt>$1</tt>:</p>
<pre>
<tt>set '1 b=2'
export \a=$1
</tt></pre>
<p class="tent">Likewise, this code sequence will not be parsed in assignment context, but is still required to export the variable
named <i>foo</i> with the value <tt>'1'</tt>:</p>
<pre>
<tt>var=foo
export $var=1
</tt></pre>
<p class="tent">Implementations are permitted to provide extensions that serve as declaration utilities, such as <i>typeset</i> or
<i>local</i>, or even a way to define a function that can behave as a declaration utility.</p>
<p class="tent">Declaration utilities are only required to be recognized via lexical analysis; if any expansions are required
before the command name is known, or before the first argument to the <a href="../utilities/command.html"><i>command</i></a>
utility is known, then it is unspecified whether subsequent arguments will be treated with an assignment context during expansion.
For example, it is unspecified whether</p>
<pre>
<tt>var=export; $var a=~
</tt></pre>
<p class="tent">sets the variable <i>a</i> to a literal &lt;tilde&gt; or to the value of <tt>$HOME</tt>, since lexical analysis
sees <tt>"$var"</tt> rather than <tt>"export"</tt> as the command name.</p>
<p class="tent">Austin Group Defects 351 and 1535 are applied, adding requirements relating to declaration utilities.</p>
<h5><a name="tag_23_02_09_03" id="tag_23_02_09_03"></a>Variable Assignments</h5>
<p class="tent">The following example illustrates both how a variable assignment without a command name affects the current
execution environment, and how an assignment with a command name only affects the execution environment of the command:</p>
<pre>
<b>$</b><tt> x=red
</tt><b>$</b><tt> echo $x
</tt><b>red
$</b><tt> export x
</tt><b>$</b><tt> sh -c 'echo $x'
</tt><b>red
$</b><tt> x=blue sh -c 'echo $x'
</tt><b>blue
$</b><tt> echo $x
</tt><b>red</b><tt>
</tt></pre>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0021 [255] is applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0024 [654] is applied.</p>
<p class="tent">Austin Group Defect 1009 is applied, clarifying the behavior when a special built-in utility is executed with a
variable assignment.</p>
<h5><a name="tag_23_02_09_04" id="tag_23_02_09_04"></a>Commands with no Command Name</h5>
<p class="tent">This next example illustrates that redirections without a command name are still performed:</p>
<pre>
<b>$</b><tt> ls foo
</tt><b>ls: foo: no such file or directory
$</b><tt> &gt; foo
</tt><b>$</b><tt> ls foo
</tt><b>foo</b><tt>
</tt></pre>
<br>
<p class="tent">A command without a command name, but one that includes a command substitution, has an exit status of the last
command substitution that the shell performed. For example:</p>
<pre>
<tt>if      x=$(</tt><i>command</i><tt>)
then    ...
fi
</tt></pre>
<p class="tent">An example of redirections without a command name being performed in a subshell shows that the here-document does
not disrupt the standard input of the <b>while</b> loop:</p>
<pre>
<tt>IFS=:
while    read a b
do       echo $a
         &lt;&lt;-eof
         Hello
         eof
done &lt;/etc/passwd
</tt></pre>
<p class="tent">Following are examples of commands without command names in AND-OR lists:</p>
<pre>
<tt>&gt; foo || {
    echo "error: foo cannot be created" &gt;&amp;2
    exit 1
}
<br class="tent">
# set saved if /vmunix.save exists
test -f /vmunix.save &amp;& saved=1
</tt></pre>
<p class="tent">Command substitution and redirections without command names both occur in subshells, but they are not necessarily
the same ones. For example, in:</p>
<pre>
<tt>exec 3&gt; file
var=$(echo foo &gt;&amp;3) 3&gt;&amp;1
</tt></pre>
<p class="tent">it is unspecified whether <b>foo</b> is echoed to the file or to standard output.</p>
<p class="tent">Austin Group Defect 1150 is applied, clarifying the exit status of a command that has no command name and has more
than one command substitution.</p>
<h5><a name="tag_23_02_09_05" id="tag_23_02_09_05"></a>Command Search and Execution</h5>
<p class="tent">This description requires that the shell can execute shell scripts directly, even if the underlying system does not
support the common <tt>"#!"</tt> interpreter convention. That is, if file <b>foo</b> contains shell commands and is executable, the
following executes <b>foo</b>:</p>
<pre>
<tt>./foo
</tt></pre>
<p class="tent">The command search shown here does not match all historical implementations. A more typical sequence has been:</p>
<ul>
<li class="tent">Any built-in (special or regular)</li>
<li class="tent">Functions</li>
<li class="tent">Path search for executable files</li>
</ul>
<p class="tent">But there are problems with this sequence. Since the programmer has no idea in advance which utilities might have
been built into the shell, a function cannot be used to override portably a utility of the same name. (For example, a function
named <a href="../utilities/cd.html"><i>cd</i></a> cannot be written for many historical systems.) Furthermore, the <i>PATH</i>
variable is partially ineffective in this case, and only a pathname with a &lt;slash&gt; can be used to ensure a specific
executable file is invoked.</p>
<p class="tent">After the <a href="../functions/execve.html"><i>execve</i>()</a> failure described, the shell normally executes the
file as a shell script. Some implementations, however, attempt to detect whether the file is actually a script and not an
executable from some other architecture. The method used by the KornShell is allowed by the text that indicates non-text files may
be bypassed.</p>
<p class="tent">The sequence selected for the Shell and Utilities volume of POSIX.1-2024 acknowledges that special built-ins cannot
be overridden, but gives the programmer full control over which versions of other utilities are executed (with some exceptions). It
provides a means of suppressing function lookup (via the <a href="../utilities/command.html"><i>command</i></a> utility) for the
user's own functions and, with the exception of the intrinsic utilities (see XCU <a href=
"../utilities/V3_chap01.html#tag_18_07"><i>1.7 Intrinsic Utilities</i></a>), ensures that any regular built-ins or functions
provided by the implementation are under the control of the path search. The mechanisms for associating non-intrinsic built-ins or
functions with executable files in the path are not specified by the Shell and Utilities volume of POSIX.1-2024, but the wording
requires that if either is implemented, the application is not able to distinguish a function or built-in from an executable (other
than in terms of performance, presumably). The implementation ensures that all effects specified by the Shell and Utilities volume
of POSIX.1-2024 resulting from the invocation of the regular built-in or function (interaction with the environment, variables,
traps, and so on) are identical to those resulting from the invocation of an executable file.</p>
<p class="tent">Various historical implementations have used the names in item 1.b. as built-ins or reserved words. This standard
does not specify their behavior, but their existence means that it is important for portable applications to avoid giving functions
(or utilities in <i>PATH )</i> those names because the function (or utility in <i>PATH )</i> might not be executed as expected.</p>
<p class="tent">IEEE&nbsp;Std&nbsp;1003.1-2001/Cor&nbsp;2-2004, item XCU/TC2/D6/4 is applied, updating the case where <a href=
"../functions/execve.html"><i>execve</i>()</a> fails due to an error equivalent to the [ENOEXEC] error.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0022 [168], XCU/TC1-2008/0023 [168], XCU/TC1-2008/0024 [168],
XCU/TC1-2008/0025 [168], XCU/TC1-2008/0026 [168,430], XCU/TC1-2008/0027 [168,430], and XCU/TC1-2008/0028 [173] are applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0025 [935] and XCU/TC2-2008/0026 [705] are applied.</p>
<p class="tent">Austin Group Defect 465 is applied, adding <i>compound</i>, <i>enum</i>, <i>float</i>, <i>integer</i>, and
<i>nameref</i> to the table of command names for which the results are unspecified.</p>
<p class="tent">Austin Group Defect 854 is applied, adding intrinsic utilities.</p>
<p class="tent">Austin Group Defect 1391 is applied, clarifying the execution of a standard utility provided by the implementation
in the form of a function.</p>
<h5><a name="tag_23_02_09_06" id="tag_23_02_09_06"></a>Standard File Descriptors</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5><a name="tag_23_02_09_07" id="tag_23_02_09_07"></a>Non-built-in Utility Execution</h5>
<p class="tent">Austin Group Defect 1157 is applied, clarifying the execution of non-built-in utilities.</p>
<p class="tent">Austin Group Defects 1226 and 1435 are applied, clarifying the circumstances under which the shell may bypass
execution of a non-built-in utility as a shell script.</p>
<h5><a name="tag_23_02_09_08" id="tag_23_02_09_08"></a>Examples</h5>
<p class="tent">Consider three versions of the <a href="../utilities/ls.html"><i>ls</i></a> utility:</p>
<ol>
<li class="tent">The application includes a shell function named <a href="../utilities/ls.html"><i>ls</i></a>.</li>
<li class="tent">The user writes a utility named <a href="../utilities/ls.html"><i>ls</i></a> and puts it in <b>/fred/bin</b>.</li>
<li class="tent">The example implementation provides <a href="../utilities/ls.html"><i>ls</i></a> as a regular shell built-in that
is invoked (either by the shell or directly by <i>exec</i>) when the path search reaches the directory <b>/posix/bin</b>.</li>
</ol>
<p class="tent">If <i>PATH =</i><b>/posix/bin</b>, various invocations yield different versions of <a href=
"../utilities/ls.html"><i>ls</i></a>:</p>
<center>
<table border="1" cellpadding="3" align="center">
<tr valign="top">
<th align="center">
<p class="tent"><b>Invocation</b></p>
</th>
<th align="center">
<p class="tent"><b>Version of <i>ls</i></b></p>
</th>
</tr>
<tr valign="top">
<td align="left">
<p class="tent"><i>ls</i> (from within application script)</p>
</td>
<td align="left">
<p class="tent">(1) function</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent"><i>command ls</i> (from within application script)</p>
</td>
<td align="left">
<p class="tent">(3) built-in</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent"><i>ls</i> (from within makefile called by application)</p>
</td>
<td align="left">
<p class="tent">(3) built-in</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent"><i>system</i>("<i>ls</i>")</p>
</td>
<td align="left">
<p class="tent">(3) built-in</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent"><i>PATH</i>="<b>/fred/bin</b>:$<i>PATH</i>" <i>ls</i></p>
</td>
<td align="left">
<p class="tent">(2) user's version</p>
</td>
</tr>
</table>
</center>
<h5 class="header4"><a name="tag_23_02_09_09" id="tag_23_02_09_09"></a>C.2.9.2 Pipelines</h5>
<p class="tent">Because pipeline assignment of standard input or standard output or both takes place before redirection, it can be
modified by redirection. For example:</p>
<pre>
<b>$ </b><i>command1</i><tt> 2&gt;&amp;1 | </tt><i>command2</i><tt>
</tt></pre>
<p class="tent">sends both the standard output and standard error of <i>command1</i> to the standard input of <i>command2</i>.</p>
<p class="tent">The reserved word <b>!</b> allows more flexible testing using AND and OR lists. The behavior of <b>!(</b> is
unspecified because in the Korn Shell this introduces a negated pathname expansion. Portable applications need to separate the
<b>!</b> and <b>(</b> to ensure the command is treated as a negated subshell.</p>
<p class="tent">It was suggested that it would be better to return a non-zero value if any command in the pipeline terminates with
non-zero status (perhaps the bitwise-inclusive OR of all return values). However, the choice of the last-specified command
semantics are historical practice and would cause applications to break if changed. An example of historical behavior:</p>
<pre>
<tt>$ sleep 5 | (exit 4)
$ echo $?
4
$ (exit 4) | sleep 5
$ echo $?
0
</tt></pre>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0029 [205] is applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0027 [521] is applied.</p>
<h5><a name="tag_23_02_09_10" id="tag_23_02_09_10"></a>Exit Status</h5>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0030 [52] is applied.</p>
<p class="tent">Austin Group Defect 789 is applied, adding the <i>pipefail</i> option.</p>
<h5 class="header4"><a name="tag_23_02_09_11" id="tag_23_02_09_11"></a>C.2.9.3 Lists</h5>
<p class="tent">The equal precedence of <tt>"&amp;&amp;"</tt> and <tt>"||"</tt> is historical practice. The standard developers
evaluated the model used more frequently in high-level programming languages, such as C, to allow the shell logical operators to be
used for complex expressions in an unambiguous way, but they could not allow historical scripts to break in the subtle way unequal
precedence might cause. Some arguments were posed concerning the <tt>"{}"</tt> or <tt>"()"</tt> groupings that are required
historically. There are some disadvantages to these groupings:</p>
<ul>
<li class="tent">The <tt>"()"</tt> can be expensive, as they spawn other processes on some implementations. This performance
concern is primarily an implementation issue.</li>
<li class="tent">The <tt>"{}"</tt> braces are not operators (they are reserved words) and require a trailing &lt;space&gt; after
each <tt>'{'</tt>, and a &lt;semicolon&gt; before each <tt>'}'</tt>. Most programmers (and certainly interactive users) have
avoided braces as grouping constructs because of the problematic syntax required. Braces were not changed to operators because that
would generate compatibility issues even greater than the precedence question; braces appear outside the context of a keyword in
many shell scripts.</li>
</ul>
<p class="tent">IEEE PASC Interpretation 1003.2 #204 is applied, clarifying that the operators <tt>"&amp;&amp;"</tt> and
<tt>"||"</tt> are evaluated with left associativity.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0031 [45] and XCU/TC1-2008/0032 [45] are applied.</p>
<h5><a name="tag_23_02_09_12" id="tag_23_02_09_12"></a>Asynchronous AND-OR Lists</h5>
<p class="tent">Unless the implementation has an internal limit, such as {CHILD_MAX}, on the retained process IDs, it would require
unbounded memory for the following example:</p>
<pre>
<tt>while true
do      foo & echo $!
done
</tt></pre>
<p class="tent">The treatment of the signals SIGINT and SIGQUIT with asynchronous AND-OR lists is described in XCU <a href=
"../utilities/V3_chap02.html#tag_19_12"><i>2.12 Signals and Error Handling</i></a>.</p>
<p class="tent">Since the connection of the input to the equivalent of <b>/dev/null</b> is considered to occur before redirections,
the following script would produce no output:</p>
<pre>
<tt>exec &lt; /etc/passwd
cat &lt;&amp;0 &
wait
</tt></pre>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0028 [760] is applied.</p>
<p class="tent">Austin Group Defect 1254 is applied, replacing the <i>Asynchronous Lists</i> section with an <i>Asynchronous AND-OR
Lists</i> section.</p>
<h5><a name="tag_23_02_09_13" id="tag_23_02_09_13"></a>Sequential AND-OR Lists</h5>
<p class="tent">Austin Group Defect 1254 is applied, replacing the <i>Sequential Lists</i> section with a <i>Sequential AND-OR
Lists</i> section.</p>
<h5><a name="tag_23_02_09_14" id="tag_23_02_09_14"></a>AND Lists</h5>
<p class="tent">There is no additional rationale provided for this section.</p>
<h5><a name="tag_23_02_09_15" id="tag_23_02_09_15"></a>OR Lists</h5>
<p class="tent">There is no additional rationale provided for this section.<br></p>
<h5 class="header4"><a name="tag_23_02_09_16" id="tag_23_02_09_16"></a>C.2.9.4 Compound Commands</h5>
Austin Group Defect 1309 is applied, clarifying the exit status of the <b>for</b>, <b>case</b>, <b>if</b>, <b>while</b>, and
<b>until</b> compound commands.
<h5><a name="tag_23_02_09_17" id="tag_23_02_09_17"></a>Grouping Commands</h5>
<p class="tent">The semicolon shown in {<i>compound-list</i>;} is an example of a control operator delimiting the <b>}</b> reserved
word. Other delimiters are possible, as shown in XCU <a href="../utilities/V3_chap02.html#tag_19_10"><i>2.10 Shell Grammar</i></a>
; &lt;newline&gt; is frequently used.</p>
<p class="tent">A proposal was made to use the <b>&lt;do-done&gt;</b> construct in all cases where command grouping in the current
process environment is performed, identifying it as a construct for the grouping commands, as well as for shell functions. This was
not included because the shell already has a grouping construct for this purpose (<tt>"{}"</tt>), and changing it would have been
counter-productive.</p>
<p class="tent">The requirement for conforming applications to separate two leading <tt>'('</tt> characters with white space if a
grouping command would be parsed as an arithmetic expansion if preceded by a <tt>'$'</tt> is to allow shells which implement the
<tt>"(( arithmetic expression ))"</tt> extension to apply the same disambiguation rules consistently to <tt>$((...))</tt> and
<tt>((...))</tt>. See <a href="#tag_23_02_06_03">C.2.6.3 Command Substitution</a>.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0033 [217] is applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0029 [473] is applied.</p>
<h5><a name="tag_23_02_09_18" id="tag_23_02_09_18"></a>For Loop</h5>
<p class="tent">The format is shown with generous usage of &lt;newline&gt; characters. See the grammar in XCU <a href=
"../utilities/V3_chap02.html#tag_19_10"><i>2.10 Shell Grammar</i></a> for a precise description of where &lt;newline&gt; and
&lt;semicolon&gt; characters can be interchanged.</p>
<p class="tent">Some historical implementations support <tt>'{'</tt> and <tt>'}'</tt> as substitutes for <b>do</b> and <b>done</b>.
The standard developers chose to omit them, even as an obsolescent feature. (Note that these substitutes were only for the
<b>for</b> command; the <b>while</b> and <b>until</b> commands could not use them historically because they are followed by
compound-lists that may contain <tt>"{...}"</tt> grouping commands themselves.)</p>
<p class="tent">The reserved word pair <b>do</b> ... <b>done</b> was selected rather than <b>do</b> ... <b>od</b> (which would have
matched the spirit of <b>if</b> ... <b>fi</b> and <b>case</b> ... <b>esac</b>) because <a href="../utilities/od.html"><i>od</i></a>
is already the name of a standard utility.</p>
<p class="tent">PASC Interpretation 1003.2 #169 has been applied changing the grammar.</p>
<h5><a name="tag_23_02_09_19" id="tag_23_02_09_19"></a>Case Conditional Construct</h5>
<p class="tent">An optional &lt;left-parenthesis&gt; before <i>pattern</i> was added to allow numerous historical KornShell scripts
to conform. At one time, using the leading parenthesis was required if the <b>case</b> statement was to be embedded within a
<tt>"$()"</tt> command substitution; this is no longer the case with the POSIX shell. Nevertheless, many historical scripts use the
&lt;left-parenthesis&gt;, if only because it makes matching-parenthesis searching easier in <a href=
"../utilities/vi.html"><i>vi</i></a> and other editors. This is a relatively simple implementation change that is
upwards-compatible for all scripts.</p>
<p class="tent">Consideration was given to requiring <a href="../utilities/V3_chap02.html#break"><i>break</i></a> inside the
<i>compound-list</i> to prevent falling through to the next pattern action list. This was rejected as being nonexisting practice.
Instead, the standard now requires a feature first added in KornShell that using <tt>";&amp;"</tt> instead of <tt>";;"</tt> as a
terminator causes the exact opposite behaviorâthe flow of control continues with the next <i>compound-list</i>.</p>
<p class="tent">Although the standard is explicit that the order of side-effects due to pattern expansion within a single clause is
unspecified, it is clear that patterns are expanded in clause order, and that no further pattern expansions are attempted after the
first match. That is, the following example is required to output <tt>"1.0"</tt>:</p>
<pre>
<tt>x=0 y=1
case 1 in
  $((y=0)) ) ;;
  $((x=1)) ) ;&
  $((x=2)) ) echo $x.$y ;;
esac
</tt></pre>
<p class="tent">Some implementations of the shell also allow <tt>";;&amp;"</tt> as a terminator which falls through to the next
matching pattern (regardless of the choice of terminator in any intermediate non-matching clauses), in contrast to
<tt>";&amp;"</tt> falling through to the next clause (regardless of the pattern guarding that clause). This is an allowed
extension, but is not required by the standard at this time.</p>
<p class="tent">The pattern <tt>'*'</tt>, given as the last pattern in a <b>case</b> construct, is equivalent to the default case
in a C-language <b>switch</b> statement.</p>
<p class="tent">The grammar shows that reserved words can be used as patterns, even if one is the first word on a line. Obviously,
the reserved word <b>esac</b> cannot be used in this manner.</p>
<p class="tent">Some historical shells would fall back to doing a byte to byte comparison with each pattern if the pattern matching
rules did not produce a match. That behavior is not allowed by this standard because it allows user input to bypass input
validations like:</p>
<pre>
<tt>case $1 in
  [0123456789]) : OK;;
  *) echo &gt;&amp;2 not a decimal digit; exit 1;;
esac
</tt></pre>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0029 [473] is applied.</p>
<p class="tent">Austin Group Defect 449 is applied, adding <tt>;&</tt> as a <b>case</b> clause terminator.</p>
<p class="tent">Austin Group Defect 1454 is applied, clarifying that a <b>case</b> statement with no patterns is valid syntax.</p>
<h5><a name="tag_23_02_09_20" id="tag_23_02_09_20"></a>If Conditional Construct</h5>
<p class="tent">The precise format for the command syntax is described in XCU <a href=
"../utilities/V3_chap02.html#tag_19_10"><i>2.10 Shell Grammar</i></a>.</p>
<h5><a name="tag_23_02_09_21" id="tag_23_02_09_21"></a>While Loop</h5>
<p class="tent">The precise format for the command syntax is described in XCU <a href=
"../utilities/V3_chap02.html#tag_19_10"><i>2.10 Shell Grammar</i></a>.</p>
<h5><a name="tag_23_02_09_22" id="tag_23_02_09_22"></a>Until Loop</h5>
<p class="tent">The precise format for the command syntax is described in XCU <a href=
"../utilities/V3_chap02.html#tag_19_10"><i>2.10 Shell Grammar</i></a>.</p>
<h5 class="header4"><a name="tag_23_02_09_23" id="tag_23_02_09_23"></a>C.2.9.5 Function Definition Command</h5>
<p class="tent">The description of functions in an early proposal was based on the notion that functions should behave like
miniature shell scripts; that is, except for sharing variables, most elements of an execution environment should behave as if they
were a new execution environment, and changes to these should be local to the function. For example, traps and options should be
reset on entry to the function, and any changes to them do not affect the traps or options of the caller. There were numerous
objections to this basic idea, and the opponents asserted that functions were intended to be a convenient mechanism for grouping
common commands that were to be executed in the current execution environment, similar to the execution of the <a href=
"../utilities/V3_chap02.html#dot"><i>dot</i></a> special built-in.</p>
<p class="tent">It was also pointed out that the functions described in that early proposal did not provide a local scope for
everything a new shell script would, such as the current working directory, or <a href="../utilities/umask.html"><i>umask</i></a>,
but instead provided a local scope for only a few select properties. The basic argument was that if a local scope is needed for the
execution environment, the mechanism already existed: the application can put the commands in a new shell script and call that
script. All historical shells that implemented functions, other than the KornShell, have implemented functions that operate in the
current execution environment. Because of this, traps and options have a global scope within a shell script. Local variables within
a function were considered and included in another early proposal (controlled by the special built-in <i>local</i>), but were
removed because they do not fit the simple model developed for functions and because there was some opposition to adding yet
another new special built-in that was not part of historical practice. Implementations should reserve the identifier <i>local</i>
(as well as <i>typeset</i>, as used in the KornShell) in case this local variable mechanism is adopted in a future version of this
standard.</p>
<p class="tent">A separate issue from the execution environment of a function is the availability of that function to child shells.
A few objectors maintained that just as a variable can be shared with child shells by exporting it, so should a function. In early
proposals, the <a href="../utilities/V3_chap02.html#export"><i>export</i></a> command therefore had a <b>-f</b> flag for exporting
functions. Functions that were exported were to be put into the environment as <i>name</i>()=<i>value</i> pairs, and upon
invocation, the shell would scan the environment for these and automatically define these functions. This facility was strongly
opposed and was omitted. Some of the arguments against exportable functions were as follows:</p>
<ul>
<li class="tent">There was little historical practice. The Ninth Edition shell provided them, but there was controversy over how
well it worked.</li>
<li class="tent">There are numerous security problems associated with functions appearing in the environment of a user and
overriding standard utilities or the utilities owned by the application.</li>
<li class="tent">There was controversy over requiring <a href="../utilities/make.html"><i>make</i></a> to import functions, where
it has historically used an <i>exec</i> function for many of its command line executions.</li>
<li class="tent">Functions can be big and the environment is of a limited size. (The counter-argument was that functions are no
different from variables in terms of size: there can be big ones, and there can be small onesâand just as one does not export huge
variables, one does not export huge functions. However, this might not apply to the average shell-function writer, who typically
writes much larger functions than variables.)</li>
</ul>
<p class="tent">As far as can be determined, the functions in the Shell and Utilities volume of POSIX.1-2024 match those in
System&nbsp;V. Earlier versions of the KornShell had two methods of defining functions:</p>
<pre>
<tt>function </tt><i>fname</i><tt> { </tt><i>compound-list</i><tt> }
</tt></pre>
<p class="tent">and:</p>
<pre>
<i>fname</i><tt>() { </tt><i>compound-list</i><tt> }
</tt></pre>
<p class="tent">The latter used the same definition as the Shell and Utilities volume of POSIX.1-2024, but differed in semantics,
as described previously. The current edition of the KornShell aligns the latter syntax with the Shell and Utilities volume of
POSIX.1-2024 and keeps the former as is.</p>
<p class="tent">Some shells accept simple commands (see XCU <a href="../utilities/V3_chap02.html#tag_19_09_01"><i>2.9.1 Simple
Commands</i></a>) after <i>fname</i><tt>()</tt> in addition to compound commands (see XCU <a href=
"../utilities/V3_chap02.html#tag_19_09_04"><i>2.9.4 Compound Commands</i></a>); however this standard only requires support for
compound commands.</p>
<p class="tent">The name space for functions is limited to that of a <i>name</i> because of historical practice. Complications in
defining the syntactic rules for the function definition command and in dealing with known extensions such as the <tt>"@()"</tt>
usage in the KornShell prevented the name space from being widened to a <i>word</i>. Using functions to support synonyms such as
the <tt>"!!"</tt> and <tt>'%'</tt> usage in the C shell is thus disallowed to conforming applications, but acceptable as an
extension. For interactive users, the aliasing facilities in the Shell and Utilities volume of POSIX.1-2024 should be adequate for
this purpose. It is recognized that the name space for utilities in the file system is wider than that currently supported for
functions, if the portable filename character set guidelines are ignored, but it did not seem useful to mandate extensions in
systems for so little benefit to conforming applications.</p>
<p class="tent">The <tt>"()"</tt> in the function definition command consists of two operators. Therefore, intermixing
&lt;blank&gt; characters with the <i>fname</i>, <tt>'('</tt>, and <tt>')'</tt> is allowed, but unnecessary.</p>
<p class="tent">An example of how a function definition can be used wherever a simple command is allowed:</p>
<pre>
<tt># If variable i is equal to "yes",
# define function foo to be ls -l
#
[ "$i" = yes ] &amp;& foo() {
    ls -l
}
</tt></pre>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0034 [383] and XCU/TC1-2008/0035 [214] are applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0029 [473] and XCU/TC2-2008/0030 [654] are applied.</p>
<h4><a name="tag_23_02_10" id="tag_23_02_10"></a>C.2.10 Shell Grammar</h4>
<p class="tent">There are several subtle aspects of this grammar where conventional usage implies rules about the grammar that in
fact are not true.</p>
<p class="tent">For <i>compound_list</i>, only the forms that end in a <i>separator</i> allow a reserved word to be recognized, so
usually only a <i>separator</i> can be used where a compound list precedes a reserved word (such as <b>Then</b>, <b>Else</b>,
<b>Do</b>, and <b>Rbrace</b>). Explicitly requiring a separator would disallow such valid (if rare) statements as:</p>
<pre>
<tt>if (false) then (echo x) else (echo y) fi
</tt></pre>
<p class="tent">See the Note under special grammar rule (1).</p>
<p class="tent">Concerning the third sentence of rule (1) (&quot;Also, if the parser ...&quot;):</p>
<ul>
<li class="tent">This sentence applies rather narrowly: when a compound list is terminated by some clear delimiter (such as the
closing <b>fi</b> of an inner <b>if_clause</b>) then it would apply; where the compound list might continue (as in after a
<tt>';'</tt>), rule (7a) (and consequently the first sentence of rule (1)) would apply. In many instances the two conditions are
identical, but this part of rule (1) does not give license to treating a <b>WORD</b> as a reserved word unless it is in a place
where a reserved word has to appear.</li>
<li class="tent">The statement is equivalent to requiring that when the LR(1) lookahead set contains exactly one reserved word, it
must be recognized if it is present. (Here &quot;LR(1)&quot; refers to the theoretical concepts, not to any real parser generator.)
<p class="tent">For example, in the construct below, and when the parser is at the point marked with <tt>'^'</tt>, the only next
legal token is <b>then</b> (this follows directly from the grammar rules):</p>
<pre>
<tt>if if...fi then ... fi
           ^
</tt></pre>
<p class="tent">At that point, the <b>then</b> must be recognized as a reserved word.</p>
<p class="tent">(Depending on the parser generator actually used, &quot;extra&quot; reserved words may be in some lookahead sets. It does
not really matter if they are recognized, or even if any possible reserved word is recognized in that state, because if it is
recognized and is not in the (theoretical) LR(1) lookahead set, an error is ultimately detected. In the example above, if some
other reserved word (for example, <b>while</b>) is also recognized, an error occurs later.</p>
<p class="tent">This is approximately equivalent to saying that reserved words are recognized after other reserved words (because
it is after a reserved word that this condition occurs), but avoids the &quot;except for ...&quot; list that would be required for
<b>case</b>, <b>for</b>, and so on. (Reserved words are of course recognized anywhere a <i>simple_command</i> can appear, as well.
Other rules take care of the special cases of non-recognition, such as rule (4) for <b>case</b> statements.)</p>
</li>
</ul>
<p class="tent">Note that the body of here-documents are handled by token recognition (see XCU <a href=
"../utilities/V3_chap02.html#tag_19_03"><i>2.3 Token Recognition</i></a>) and do not appear in the grammar directly. (However, the
here-document I/O redirection operator is handled as part of the grammar.)</p>
<p class="tent">The optional redirection syntax:</p>
<pre>
<b>{</b><i>location</i><b>}</b><i>redir-op word</i><tt>
</tt></pre>
<p class="tent">(see XCU <a href="../utilities/V3_chap02.html#tag_19_07"><i>2.7 Redirection</i></a>) is accommodated in the
grammar rules by the optional <b>IO_LOCATION</b> token identifier and two correspondingly optional elements in
<tt>io_redirect</tt>. Without these, the grammar would not permit this form of redirection because it would require that, for
example, <tt>echo {var}&gt; foo</tt> is parsed such that <tt>{var}</tt> is a <b>WORD</b> to be expanded and passed to <a href=
"../utilities/echo.html"><i>echo</i></a>. The grammar does not restrict the location given between the <tt>'{'</tt> and
<tt>'}'</tt> in these forms (other than requiring it to be non-empty) since shells may parse an invalid location as part of an
<tt>io_redirect</tt> and later treat the invalid location as an error.</p>
<h5 class="header4"><a name="tag_23_02_10_01" id="tag_23_02_10_01"></a>C.2.10.1 Shell Grammar Lexical Conventions</h5>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0031 [648] and XCU/TC2-2008/0032 [574,646] are applied.</p>
<p class="tent">Austin Group Defect 1193 is applied, adding the optional <b>IO_LOCATION</b> token identifier.</p>
<p class="tent">Austin Group Defect 1454 is applied, clarifying how to convert the token identifier type of the <b>TOKEN</b> when
rule 1 applies.</p>
<h5 class="header4"><a name="tag_23_02_10_02" id="tag_23_02_10_02"></a>C.2.10.2 Shell Grammar Rules</h5>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0036 [44] is applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0033 [643,839], XCU/TC2-2008/0034 [643], XCU/TC2-2008/0035
[648], XCU/TC2-2008/0036 [736], XCU/TC2-2008/0037 [737], XCU/TC2-2008/0038 [581], and XCU/TC2-2008/0039 [735] are applied.</p>
<p class="tent">Austin Group Defect 249 is applied, adding the dollar-single-quotes quoting mechanism.</p>
<p class="tent">Austin Group Defect 449 is applied, adding <tt>;&</tt> as a <b>case</b> clause terminator.</p>
<p class="tent">Austin Group Defect 1193 is applied, adding the optional <b>IO_LOCATION</b> token identifier.</p>
<p class="tent">Austin Group Defects 1276 and 1279 are applied, clarifying rule 7.</p>
<p class="tent">Austin Group Defect 1454 is applied, clarifying how rule 4 applies.</p>
<h4><a name="tag_23_02_11" id="tag_23_02_11"></a>C.2.11 Job Control</h4>
<p class="tent">See also <a href="../xrat/V4_xbd_chap01.html#tag_21_03_00_57"><i>Job Control</i></a>.</p>
<p class="tent">Shell implementations differ regarding how much of a foreground job is retained when it is converted to a suspended
job. For example, given this foreground job:</p>
<pre>
<tt>sleep 10; echo foo; echo bar &
</tt></pre>
<p class="tent">if this is suspended during execution of the sleep, <i>ksh93</i> retains all of the commands in the suspended job
and executes them when <a href="../utilities/fg.html"><i>fg</i></a> is used:</p>
<pre>
<b>^Z[1] + Stopped                  sleep 10; echo foo; echo bar &
$ </b><tt>jobs
</tt><b>[1] + Stopped                  sleep 10; echo foo; echo bar &
$ </b><tt>fg
</tt><b>sleep 10; echo foo; echo bar
foo
[1]     30686
bar
$</b><tt>
</tt></pre>
<p class="tent">However, some other shells create a suspended job containing only the <tt>sleep 10</tt> command.</p>
<p class="tent">Some historical shells did not handle suspending a foreground AND-OR list well. They would treat the wait status of
a process that indicated it had stopped as if it was a non-zero exit status and (if the next operator in the AND-OR list was ||)
would execute the remainder of the AND-OR list at that point. This behavior is not allowed by the standard for two reasons:</p>
<ol>
<li class="tent">It does not meet the fundamental requirement of an AND-OR list that the decision on whether to execute each part
(except the first) is made based on the exit status of the previous part when it completes.</li>
<li class="tent">It can lead to data loss. For example, consider a user who often runs this command:
<pre>
<tt>generate_report &gt; report.out || rm report.out
</tt></pre>
<p class="tent">with the intention that the incomplete results from a failed <i>generate_report</i> run are never retained in order
that they cannot be mistaken for a complete set of results. If one day the user decides to check on the progress of the command by
stopping it and examining what has been written so far, they will find that the <b>report.out</b> file has already been
removed.</p>
</li>
</ol>
<p class="tent">Austin Group Defects 1254 and 1675 are applied, adding this section.</p>
<h4><a name="tag_23_02_12" id="tag_23_02_12"></a>C.2.12 Signals and Error Handling</h4>
<p class="tent">Historically, some shell implementations silently ignored attempts to use <a href=
"../utilities/trap.html"><i>trap</i></a> to set SIGINT or SIGQUIT to the default action or to set a trap for them after they have
been set to be ignored by the shell when it executes an asynchronous subshell (and job control is disabled). This behavior is not
conforming. For example, if a shell script containing the following line is run in the foreground at a terminal:</p>
<pre>
<tt>(trap - INT; exec sleep 10) & wait
</tt></pre>
<p class="tent">and is then terminated by typing the interrupt character, this standard requires that the <a href=
"../utilities/sleep.html"><i>sleep</i></a> command is terminated by the SIGINT signal.</p>
<p class="tent">SD5-XCU-ERN-93 is applied, updating the first paragraph of XCU <a href=
"../utilities/V3_chap02.html#tag_19_12"><i>2.12 Signals and Error Handling</i></a>.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0040 [750] is applied.</p>
<h4><a name="tag_23_02_13" id="tag_23_02_13"></a>C.2.13 Shell Execution Environment</h4>
<p class="tent">Some implementations have implemented the last stage of a pipeline in the current environment so that commands such
as:</p>
<pre>
<i>command</i><tt> | read foo
</tt></pre>
<p class="tent">set variable <b>foo</b> in the current environment. This extension is allowed, but not required; therefore, a shell
programmer should consider a pipeline to be in a subshell environment, but not depend on it.</p>
<p class="tent">In early proposals, the description of execution environment failed to mention that each command in a multiple
command pipeline could be in a subshell execution environment. For compatibility with some historical shells, the wording was
phrased to allow an implementation to place any or all commands of a pipeline in the current environment. However, this means that
a POSIX application must assume each command is in a subshell environment, but not depend on it.</p>
<p class="tent">The wording about shell scripts is meant to convey the fact that describing &quot;trap actions&quot; can only be understood
in the context of the shell command language. Outside of this context, such as in a C-language program, signals are the operative
condition, not traps.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 1, XCU/TC1-2008/0037 [238] is applied.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0041 [706] is applied.</p>
<p class="tent">Austin Group Defect 1247 is applied, changing &quot;signal traps&quot; to &quot;traps&quot; and changing &quot;All other commands&quot; to
&quot;Except where otherwise stated, all other commands&quot;.</p>
<p class="tent">Austin Group Defect 1254 is applied, changing the list item relating to process IDs &quot;known to this shell
environment&quot;.</p>
<p class="tent">Austin Group Defect 1384 is applied, changing the requirements for subshells of interactive shells.</p>
<p class="tent">Austin Group Defect 1580 is applied, adding a list item about environment variables with invalid names.</p>
<h4><a name="tag_23_02_14" id="tag_23_02_14"></a>C.2.14 Pattern Matching Notation</h4>
<p class="tent">Pattern matching is a simpler concept and has a simpler syntax than REs, as the former is generally used for the
manipulation of filenames, which are relatively simple collections of characters, while the latter is generally used to manipulate
arbitrary text strings of potentially greater complexity. However, some of the basic concepts are the same, so this section points
liberally to the detailed descriptions in XBD <a href="../basedefs/V1_chap09.html#tag_09"><i>9. Regular Expressions</i></a>.</p>
<p class="tent">Austin Group Defect 1443 is applied, adding non-shell uses to the description of what shell pattern matching
notation is used for.</p>
<p class="tent">Austin Group Defect 1564 is applied, clarifying that pattern matching notation is used for matching character
strings (not arbitrary byte strings), and that if an attempt is made to use pattern matching notation to match a string that
contains one or more bytes that do not form part of a valid character, the behavior is unspecified.</p>
<h5 class="header4"><a name="tag_23_02_14_01" id="tag_23_02_14_01"></a>C.2.14.1 Patterns Matching a Single Character</h5>
<p class="tent">Both quoting and escaping are described here because pattern matching must work in three separate
circumstances:</p>
<ol>
<li class="tent">Calling directly upon the shell, such as in pathname expansion or in a <b>case</b> statement. All of the following
match the string or file <b>abc</b>:
<pre>
<tt>abc "abc" a"b"c a\bc a[b]c a["b"]c a[\b]c a["\b"]c a?c a*c
</tt></pre>
<p class="tent">The following do not:</p>
<pre>
<tt>"a?c" a\*c a\[b]c
</tt></pre></li>
<li class="tent">Calling a utility or function without going through a shell, as described for <a href=
"../utilities/find.html"><i>find</i></a> and the <a href="../functions/fnmatch.html"><i>fnmatch</i>()</a> and <a href=
"../functions/glob.html"><i>glob</i>()</a> functions defined in the System Interfaces volume of POSIX.1-2024, or pattern matching
in the shell in situations where the pattern is specified indirectly instead of directly to the shell, such as:
<pre>
<tt>ls -ld -- $pattern
</tt></pre>
<p class="tent">or</p>
<pre>
<tt>case $var in ($pattern) ...
</tt></pre></li>
<li class="tent">Calling utilities such as <a href="../utilities/find.html"><i>find</i></a>, <i>cpio</i>, <i>tar</i>, or <a href=
"../utilities/pax.html"><i>pax</i></a> through the shell command line. In this case, shell quote removal is performed before the
utility sees the argument. For example, in:
<pre>
<tt>find /bin -name "e\c[\h]o" -print
</tt></pre>
<p class="tent">after quote removal, the &lt;backslash&gt; characters are presented to <a href=
"../utilities/find.html"><i>find</i></a> and it treats them as escape characters. Both precede ordinary characters, so the <i>c</i>
and <i>h</i> represent themselves and <a href="../utilities/echo.html"><i>echo</i></a> would be found on many historical systems
(that have it in <b>/bin</b>). To find a filename that contained shell special characters or pattern characters, both quoting and
escaping are required, such as:</p>
<pre>
<tt>pax -r ... "*a(\?"
</tt></pre>
<p class="tent">to extract a filename ending with <tt>"a(?"</tt>.</p>
</li>
</ol>
<p class="tent">The wording &quot;In a pattern, or part of one, where a shell-quoting &lt;backslash&gt; cannot be used to preserve the
literal value of a character that would otherwise be treated as special&quot; has been carefully crafted so that for the shell it only
applies to certain contexts. In particular:</p>
<ul>
<li class="tent">The use of &quot;or part of one&quot; is needed because a single pattern can be produced partly from characters directly
included in a word and partly from characters that result from one or more of the word expansions. For example, in the following
command the &lt;backslash&gt; escapes the <tt>'?'</tt> character:
<pre>
<tt>dir='abc\?'
ls -l -- $dir/*.c
</tt></pre></li>
<li class="tent">The reference to &quot;a shell-quoting &lt;backslash&gt;&quot; rather than just using &quot;where shell quoting cannot be
used&quot; is because there are ways that other types of shell quoting can be used where a shell-quoting &lt;backslash&gt; cannot, such
as placing an expansion within double-quotes as in this example:
<pre>
<tt>dir='abc?'
ls -l -- "$dir"/*.c
</tt></pre></li>
<li class="tent">The use of &quot;that would otherwise be treated as special&quot; is needed because otherwise the condition would apply to
&lt;backslash&gt; in single-quotes. For example, in the following command the &lt;backslash&gt; is not treated as escaping the
<tt>'?'</tt> because the <tt>'?'</tt> would not be treated as special anyway:
<pre>
<tt>ls -l 'abc\?'/*.c
</tt></pre></li>
</ul>
<p class="tent">In patterns specified indirectly to the shell, it is unspecified whether or not &lt;backslash&gt; is special inside
bracket expressions. This is because there are two mutually exclusive consistency aims and neither is considered more important
than the other. One is consistency with direct patterns, where &lt;backslash&gt; is special inside bracket expressions (which is,
in turn, for consistency with the way single-quotes and double-quotes preserve the literal value of characters inside bracket
expressions); the other is consistency with regular expressions, <a href="../utilities/find.html"><i>find</i></a>, <a href=
"../utilities/pax.html"><i>pax</i></a>, <a href="../functions/fnmatch.html"><i>fnmatch</i>()</a>, and <a href=
"../functions/glob.html"><i>glob</i>()</a>, where &lt;backslash&gt; is not special inside bracket expressions (not counting the
extra C-string escaping in EREs in <a href="../utilities/awk.html"><i>awk</i></a>).</p>
<p class="tent">Earlier versions of this standard allowed two behaviors when a pattern ends with an unescaped &lt;backslash&gt;: it
could match nothing or be treated as an invalid pattern. However, a third behavior has since been observed, where the ending
&lt;backslash&gt; is treated as a literal &lt;backslash&gt;, and therefore this standard now simply states that the behavior is
unspecified.</p>
<p class="tent">Earlier versions of this standard included the statement &quot;The shell special characters always require quoting&quot; in
XCU <a href="../utilities/V3_chap02.html#tag_19_14_01"><i>2.14.1 Patterns Matching a Single Character</i></a>. It is unclear what
was intended by this, since there are pattern matching contexts in which it is not possible to quote those characters, such as:</p>
<pre>
<tt>execlp("find", "find", ".", "-name", "*[()]*", (char *)0);
</tt></pre>
<p class="tent">where the parentheses cannot be escaped with a &lt;backslash&gt; because &lt;backslash&gt; is not special in
bracket expressions in that context. The statement is thought to have been a warning to application writers and interactive shell
users that shell special characters (sometimes called metacharacters) always need quoting in patterns that appear directly in shell
code; for example, this code:</p>
<pre>
<tt>case $char in
[()]) ... ;;
esac
</tt></pre>
<p class="tent">is incorrect because the parentheses are parsed as operatorsâthey need to be quoted in order to be treated as part
of the pattern. This standard now simply requires instead that applications quote or escape any character that would otherwise be
treated as special, in order for it to be matched as an ordinary character. If shell special characters are used without this
protection in contexts where they are treated as special, syntax errors can result or implementation extensions can be triggered.
Some shells support a series of extensions based on parentheses in patterns that are valid extensions in these contexts because
they would otherwise cause syntax errors. However, this means that they are not allowed by this standard to be recognized in
contexts where those syntax errors would not occur anyway, such as in:</p>
<pre>
<tt>pattern='a*(b)'; ls -- $pattern
</tt></pre>
which this standard requires to list files with names beginning <tt>'a'</tt> and ending <tt>"(b)"</tt>. It is recommended that
implementations do not extend pattern matching in the shell in ways that are only valid extensions because they would otherwise be
syntax errors, in order to avoid inconsistency between different pattern matching contexts. One way to provide an extension that is
consistent between different pattern matching contexts in the shell (although still not consistent with <a href=
"../utilities/find.html"><i>find</i></a> -<i>name</i>, <a href="../functions/fnmatch.html"><i>fnmatch</i>()</a>, etc.) is to enable
the extension only when a non-standard shell option is set, or when the shell is executed using a command name other than <a href=
"../utilities/sh.html"><i>sh</i></a>. Consistency with non-shell contexts can then be achieved by enabling equivalent extensions in
those other contexts by use of non-standard utility options or non-standard FNM_* and GLOB_* flags.
<p class="tent">The restriction on a &lt;circumflex&gt; in a bracket expression is to allow implementations that support pattern
matching using the &lt;circumflex&gt; as the negation character in addition to the &lt;exclamation-mark&gt;. A conforming
application must use something like <tt>"[\^!]"</tt> to match either character.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0042 [806] is applied.</p>
<p class="tent">Austin Group Defect 985 is applied, changing the description of the <tt>'['</tt> special character.</p>
<p class="tent">Austin Group Defect 1234 is applied, clarifying how &lt;backslash&gt; is handled in patterns.</p>
<h5 class="header4"><a name="tag_23_02_14_02" id="tag_23_02_14_02"></a>C.2.14.2 Patterns Matching Multiple Characters</h5>
<p class="tent">Since each &lt;asterisk&gt; matches zero or more occurrences, the patterns <tt>"a*b"</tt> and <tt>"a**b"</tt> have
identical functionality.</p>
<h5><a name="tag_23_02_14_03" id="tag_23_02_14_03"></a>Examples</h5>
<dl compact>
<dd></dd>
<dt><tt>a[bc]</tt></dt>
<dd>Matches the strings <tt>"ab"</tt> and <tt>"ac"</tt>.</dd>
<dt><tt>a*d</tt></dt>
<dd>Matches the strings <tt>"ad"</tt>, <tt>"abd"</tt>, and <tt>"abcd"</tt>, but not the string <tt>"abc"</tt>.</dd>
<dt><tt>a*d*</tt></dt>
<dd>Matches the strings <tt>"ad"</tt>, <tt>"abcd"</tt>, <tt>"abcdef"</tt>, <tt>"aaaad"</tt>, and <tt>"adddd"</tt>.</dd>
<dt><tt>*a*d</tt></dt>
<dd>Matches the strings <tt>"ad"</tt>, <tt>"abcd"</tt>, <tt>"efabcd"</tt>, <tt>"aaaad"</tt>, and <tt>"adddd"</tt>.</dd>
</dl>
<h5 class="header4"><a name="tag_23_02_14_04" id="tag_23_02_14_04"></a>C.2.14.3 Patterns Used for Filename Expansion</h5>
<p class="tent">The caveat about a &lt;slash&gt; within a bracket expression is derived from historical practice. The pattern
<tt>"a[b/c]d"</tt> does not match such pathnames as <b>abd</b> or <b>a/d</b>. On some implementations (including those conforming
to the Single UNIX Specification), it matched a pathname of literally <tt>"a[b/c]d"</tt>. On other systems, it produced an
undefined condition (an unescaped <tt>'['</tt> used outside a bracket expression). In this version, the XSI behavior is now
required.</p>
<p class="tent">Filenames beginning with a &lt;period&gt; historically have been specially protected from view on UNIX systems. A
proposal to allow an explicit &lt;period&gt; in a bracket expression to match a leading &lt;period&gt; was considered; it is
allowed as an implementation extension, but a conforming application cannot make use of it. If this extension becomes popular in
the future, it will be considered for a future version of the Shell and Utilities volume of POSIX.1-2024.</p>
<p class="tent">Patterns are matched against existing filenames and pathnames only when the pattern contains a <tt>'*'</tt>,
<tt>'?'</tt> or <tt>'['</tt> character that will be treated as special. This prevents accidental removal of &lt;backslash&gt;
characters in variable expansions where generating a list of matching files is not intended and a (usually oddly named) file with a
matching name happens to exist. For example, a shell script that tries to be portable to systems that predate the introduction of
functions and <a href="../utilities/printf.html"><i>printf</i></a> might use this on POSIX systems:</p>
<pre>
<tt>myecho='printf %s\n'
</tt></pre>
<p class="tent">to be used as:</p>
<pre>
<tt>$myecho args...
</tt></pre>
If <tt>%s\n</tt> were to be matched against existing files, this would not work if a file called <b>%sn</b> happened to exist.
<p class="tent">Historical systems have varied in their permissions requirements. To match <b>f*/bar</b> has required read
permissions on the <b>f*</b> directories in the System&nbsp;V shell, but the Shell and Utilities volume of POSIX.1-2024, the C
shell, and KornShell require only search permissions. If read or search permission is denied, shells do not report an error but
treat this as a successful &quot;no match&quot; condition. Error conditions that are related to file system contents and occur when
attempting to read or search a directory are also required to be treated the same way because they imply that there are no matches
(that are accessible to the process). For example, if the pattern is <b>foo/*bar</b> and attempting to open the directory
<b>foo</b> fails because it does not exist or is not a directory, then there can be no matching pathnames. The error conditions
listed in XSH <a href="../functions/V2_chap02.html#tag_16_03"><i>2.3 Error Numbers</i></a> that are related to file system contents
and could occur when attempting to open or search a directory are [EACCES], [ELOOP], [ENAMETOOLONG], [ENOENT], and [ENOTDIR]. Error
conditions that are not related to file system contents or which occur when reading a directory, notably [EMFILE] and [ENFILE] but
also things like [EIO], [ENOMEM], and [EOVERFLOW], can either be treated as errors or be treated the same way as when permission is
denied. Treating them as errors is seen as desirable, because to do otherwise would mean the shell could execute a command with an
unchanged pattern when pathnames matching the pattern exist, but it is not historical practice. Implementations that handle the two
categories of error differently should also handle non-standard error conditions appropriately, if encountered, depending on which
category they fit into.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0043 [963] is applied.</p>
<p class="tent">Austin Group Defect 1070 is applied, requiring that when the matching filenames or pathnames are sorted, any that
collate equally are further compared byte-by-byte using the collating sequence for the POSIX locale.</p>
<p class="tent">Austin Group Defect 1228 is applied, allowing directory entries for dot and dot-dot to be ignored when matching
patterns against existing filenames.</p>
<p class="tent">Austin Group Defect 1234 is applied, changing the behavior of patterns used for filename expansion such that a
pattern is matched against existing filenames and pathnames only when it contains a <tt>'*'</tt>, <tt>'?'</tt> or <tt>'['</tt>
character that will be treated as special.</p>
<p class="tent">Austin Group Defects 1273 and 1275 are applied, clarifying how errors are treated when attempting to open or search
a pathname as a directory or attempting to read an opened directory.</p>
<h4><a name="tag_23_02_15" id="tag_23_02_15"></a>C.2.15 Special Built-In Utilities</h4>
<p class="tent">See the RATIONALE sections on the individual reference pages.</p>
<p class="tent">POSIX.1-2008, Technical Corrigendum 2, XCU/TC2-2008/0044 [882] and XCU/TC2-2008/0045 [654] are applied.</p>
<p class="tent">Austin Group Defect 1009 is applied, clarifying the behavior when a special built-in utility is executed with a
variable assignment.</p>
<p class="tent">Austin Group Defect 1445 is applied, changing text relating to the term &quot;built-in&quot;.</p>
<h3><a name="tag_23_03" id="tag_23_03"></a>C.3 Utilities</h3>
<p class="tent">For the utilities included in POSIX.1-2024, see the RATIONALE sections on the individual reference pages.</p>
<h4><a name="tag_23_03_01" id="tag_23_03_01"></a>C.3.1 Utilities Removed in this Version</h4>
<p class="tent">The following utilities were removed in this version of this standard:</p>
<table cellpadding="3">
<tr valign="top">
<td align="left">
<p class="tent"><br>
<i>qalter</i><br>
<i>qdel</i><br>
<i>qhold</i><br></p>
</td>
<td align="left">
<p class="tent"><br>
<i>qmove</i><br>
<i>qmsg</i><br>
<i>qrerun</i><br></p>
</td>
<td align="left">
<p class="tent"><br>
<i>qrls</i><br>
<i>qselect</i><br>
<i>qsig</i><br></p>
</td>
<td align="left">
<p class="tent"><br>
<i>qstat</i><br>
<i>qsub</i><br></p>
</td>
</tr>
</table>
<h4><a name="tag_23_03_02" id="tag_23_03_02"></a>C.3.2 Utilities Removed in the Previous Version</h4>
<p class="tent">None.</p>
<h4><a name="tag_23_03_03" id="tag_23_03_03"></a>C.3.3 Exclusion of Utilities</h4>
<p class="tent">The set of utilities contained in POSIX.1-2024 is drawn from the base documents for IEEE&nbsp;Std&nbsp;1003.2-1992,
with one addition: the <a href="../utilities/c17.html"><i>c17</i></a> utility. This section contains rationale for some of the
deliberations that led to this set of utilities, and why certain utilities were excluded.</p>
<p class="tent">Many utilities were evaluated by the standard developers; more historical utilities were excluded from the base
documents for IEEE&nbsp;Std&nbsp;1003.2-1992 than included. The following list contains many common UNIX system utilities that were
not included as mandatory utilities, in the User Portability Utilities option, in the XSI option, or in one of the software
development groups. It is logistically difficult for this rationale to distribute correctly the reasons for not including a utility
among the various utility options. Therefore, this section covers the reasons for all utilities not included in POSIX.1-2024.</p>
<p class="tent">This rationale is limited to a discussion of only those utilities actively or indirectly evaluated by the
IEEE&nbsp;Std&nbsp;1003.2-1992 standard developers, rather than the list of all known UNIX utilities from all its variants.</p>
<dl compact>
<dd></dd>
<dt><i>adb</i></dt>
<dd>The intent of the various software development utilities was to assist in the installation (rather than the actual development
and debugging) of applications. This utility is primarily a debugging tool. Furthermore, many useful aspects of <i>adb</i> are very
hardware-specific.</dd>
<dt><i>as</i></dt>
<dd>Assemblers are hardware-specific and are included implicitly as part of the compilers in POSIX.1-2024.</dd>
<dt><i>banner</i></dt>
<dd>The only known use of this command is as part of the <a href="../utilities/lp.html"><i>lp</i></a> printer header pages. It was
decided that the format of the header is implementation-defined, so this utility is superfluous to application portability.</dd>
<dt><i>calendar</i></dt>
<dd>This reminder service program is not useful to conforming applications.</dd>
<dt><i>cancel</i></dt>
<dd>The <a href="../utilities/lp.html"><i>lp</i></a> (line printer spooling) system specified is the most basic possible and did
not need this level of application control.</dd>
<dt><i>chroot</i></dt>
<dd>This is primarily of administrative use, requiring superuser privileges.</dd>
<dt><i>col</i></dt>
<dd>No utilities defined in POSIX.1-2024 produce output requiring such a filter. The <i>nroff</i> text formatter is present on many
historical systems and will continue to remain as an extension; <i>col</i> is expected to be shipped by all the systems that ship
<i>nroff</i>.</dd>
<dt><i>cpio</i></dt>
<dd>This has been replaced by <a href="../utilities/pax.html"><i>pax</i></a>, for reasons explained in the rationale for that
utility.</dd>
<dt><i>cpp</i></dt>
<dd>This is subsumed by <a href="../utilities/c17.html"><i>c17</i></a>.</dd>
<dt><i>cu</i></dt>
<dd>This utility is terminal-oriented and is not useful from shell scripts or typical application programs.</dd>
<dt><i>dc</i></dt>
<dd>The functionality of this utility can be provided by the <a href="../utilities/bc.html"><i>bc</i></a> utility; <a href=
"../utilities/bc.html"><i>bc</i></a> was selected because it was easier to use and had superior functionality. Although the
historical versions of <a href="../utilities/bc.html"><i>bc</i></a> are implemented using <i>dc</i> as a base, POSIX.1-2024
prescribes the interface and not the underlying mechanism used to implement it.</dd>
<dt><i>dircmp</i></dt>
<dd>Although a useful concept, the historical output of this directory comparison program is not suitable for processing in
application programs. Also, the <i>diff</i> <b>-r</b> command gives equivalent functionality.</dd>
<dt><i>dis</i></dt>
<dd>Disassemblers are hardware-specific.</dd>
<dt><i>emacs</i></dt>
<dd>The community of <i>emacs</i> editing enthusiasts was adamant that the full <i>emacs</i> editor not be included in
IEEE&nbsp;Std&nbsp;1003.2-1992 because they were concerned that an attempt to standardize this very powerful environment would
encourage vendors to ship versions conforming strictly to the standard, but lacking the extensibility required by the community.
The author of the original <i>emacs</i> program also expressed his desire to omit the program. Furthermore, there were a number of
historical UNIX systems that did not include <i>emacs</i>, or included it without supporting it, but there were very few that did
not include and support <a href="../utilities/vi.html"><i>vi</i></a>.</dd>
<dt><i>ld</i></dt>
<dd>This is subsumed by <a href="../utilities/c17.html"><i>c17</i></a>.</dd>
<dt><i>line</i></dt>
<dd>The functionality of <i>line</i> can be provided with <a href="../utilities/read.html"><i>read</i></a>.</dd>
<dt><i>lint</i></dt>
<dd>This technology is partially subsumed by <a href="../utilities/c17.html"><i>c17</i></a>. It is also hard to specify the degree
of checking for possible error conditions in programs in any compiler, and specifying what <i>lint</i> would do in these cases is
equally difficult.
<p class="tent">It is fairly easy to specify what a compiler does. It requires specifying the language, what it does with that
language, and stating that the interpretation of any incorrect program is unspecified. Unfortunately, any description of
<i>lint</i> is required to specify what to do with erroneous programs. Since the number of possible errors and questionable
programming practices is infinite, one cannot require <i>lint</i> to detect all errors of any given class.</p>
<p class="tent">Additionally, some vendors complained that since many compilers are distributed in a binary form without a
<i>lint</i> facility (because the ISO&nbsp;C standard does not require one), implementing the standard as a stand-alone product
will be much harder. Rather than being able to build upon a standard compiler component (simply by providing <a href=
"../utilities/c17.html"><i>c17</i></a> as an interface), source to that compiler would most likely need to be modified to provide
the <i>lint</i> functionality. This was considered a major burden on system providers for a very small gain to developers
(users).</p>
</dd>
<dt><i>login</i></dt>
<dd>This utility is terminal-oriented and is not useful from shell scripts or typical application programs.</dd>
<dt><i>lorder</i></dt>
<dd>This utility is an aid in creating an implementation-defined detail of object libraries that the standard developers did not
feel required standardization.</dd>
<dt><i>lpstat</i></dt>
<dd>The <a href="../utilities/lp.html"><i>lp</i></a> system specified is the most basic possible and did not need this level of
application control.</dd>
<dt><i>mail</i></dt>
<dd>This utility was omitted in favor of <a href="../utilities/mailx.html"><i>mailx</i></a> because there was a considerable
functionality overlap between the two.</dd>
<dt><i>mknod</i></dt>
<dd>This was omitted in favor of <a href="../utilities/mkfifo.html"><i>mkfifo</i></a>, as <i>mknod</i> has too many
implementation-defined functions.</dd>
<dt><i>news</i></dt>
<dd>This utility is terminal-oriented and is not useful from shell scripts or typical application programs.</dd>
<dt><i>pack</i></dt>
<dd>This compression program was considered inferior to <a href="../utilities/compress.html"><i>compress</i></a>.</dd>
<dt><i>passwd</i></dt>
<dd>This utility was proposed in an early draft of the IEEE&nbsp;Std&nbsp;1003.2-1992 UPE but met with too many objections to be
included. There were various reasons:
<ul>
<li class="tent">Changing a password should not be viewed as a command, but as part of the login sequence. Changing a password
should only be done while a trusted path is in effect.</li>
<li class="tent">Even though the text in early drafts was intended to allow a variety of implementations to conform, the security
policy for one site may differ from another site running with identical hardware and software. One site might use password
authentication while the other did not. Vendors could not supply a <i>passwd</i> utility that would conform to POSIX.1-2024 for all
sites using their system.</li>
<li class="tent">This is really a subject for a system administration working group or a security working group.</li>
</ul>
</dd>
<dt><i>pcat</i></dt>
<dd>This compression program was considered inferior to <a href="../utilities/zcat.html"><i>zcat</i></a>.</dd>
<dt><i>pg</i></dt>
<dd>This duplicated many of the features of the <a href="../utilities/more.html"><i>more</i></a> pager, which was preferred by the
standard developers.</dd>
<dt><i>prof</i></dt>
<dd>The intent of the various software development utilities was to assist in the installation (rather than the actual development
and debugging) of applications. This utility is primarily a debugging tool.</dd>
<dt>RCS</dt>
<dd>RCS was originally considered as part of a version control utilities portion of the scope. However, this aspect was abandoned
by the standard developers. SCCS is now included as an optional part of the XSI option.</dd>
<dt><i>red</i></dt>
<dd>Restricted editor. This was not considered by the standard developers because it never provided the level of security
restriction required.</dd>
<dt><i>rsh</i></dt>
<dd>Restricted shell. This was not considered by the standard developers because it does not provide the level of security
restriction that is implied by historical documentation.</dd>
<dt><i>sdb</i></dt>
<dd>The intent of the various software development utilities was to assist in the installation (rather than the actual development
and debugging) of applications. This utility is primarily a debugging tool. Furthermore, some useful aspects of <i>sdb</i> are very
hardware-specific.</dd>
<dt><i>sdiff</i></dt>
<dd>The &quot;side-by-side <i>diff</i>&quot; utility from System&nbsp;V was omitted because it is used infrequently, and even less so by
conforming applications. Despite being in System&nbsp;V, it is not in the SVID or XPG.</dd>
<dt><i>shar</i></dt>
<dd>Any of the numerous &quot;shell archivers&quot; were excluded because they did not meet the requirement of existing practice.</dd>
<dt><i>shl</i></dt>
<dd>This utility is terminal-oriented and is not useful from shell scripts or typical application programs. The job control aspects
of the shell command language are generally more useful.</dd>
<dt><i>size</i></dt>
<dd>The intent of the various software development utilities was to assist in the installation (rather than the actual development
and debugging) of applications. This utility is primarily a debugging tool.</dd>
<dt><i>spell</i></dt>
<dd>This utility is not useful from shell scripts or typical application programs. The <i>spell</i> utility was considered, but was
omitted because there is no known technology that can be used to make it recognize general language for user-specified input
without providing a complete dictionary along with the input file.</dd>
<dt><i>su</i></dt>
<dd>This utility is not useful from shell scripts or typical application programs. (There was also sentiment to avoid
security-related utilities.)</dd>
<dt><i>sum</i></dt>
<dd>This utility was renamed <a href="../utilities/cksum.html"><i>cksum</i></a>.</dd>
<dt><i>tar</i></dt>
<dd>This has been replaced by <a href="../utilities/pax.html"><i>pax</i></a>, for reasons explained in the rationale for that
utility.</dd>
<dt><i>unpack</i></dt>
<dd>This compression program was considered inferior to <a href="../utilities/uncompress.html"><i>uncompress</i></a>.</dd>
<dt><i>wall</i></dt>
<dd>This utility is terminal-oriented and is not useful in shell scripts or typical applications. It is generally used only by
system administrators.</dd>
</dl>
<p>&nbsp;</p>
<a href="#top"><span class="topOfPage">return to top of page</span></a><br>
<hr size="2" noshade>
<center><font size="2">UNIXÂ® is a registered Trademark of The Open Group.<br>
POSIXâ¢ is a Trademark of The IEEE.<br>
Copyright Â© 2001-2024 The IEEE and The Open Group, All Rights Reserved<br>
[ <a href="../mindex.html">Main Index</a> | <a href="../basedefs/contents.html">XBD</a> | <a href=
"../functions/contents.html">XSH</a> | <a href="../utilities/contents.html">XCU</a> | <a href="../xrat/contents.html">XRAT</a>
]</font></center>
<hr size="2" noshade>
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../xrat/V4_xsh_chap01.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../xrat/V4_port.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>
<hr align="left" width="100%"></div>
</body>
</html>
