<!-- Copyright 2001-2024 IEEE and The Open Group, All Rights Reserved -->
<!DOCTYPE HTML>
<html lang="en">
<head>
<meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.8.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link type="text/css" rel="stylesheet" href="style.css"><!-- Generated by The Open Group rhtm tool v1.2.4 -->
<!-- Copyright (c) 2001-2024 The Open Group, All Rights Reserved -->
<title>posix_typed_mem_open</title>
</head>
<body bgcolor="white">
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/posix_typed_mem_get_info.html" accesskey=
"P">&lt;&lt;&lt; Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/pow.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>
<hr align="left" width="100%"></div>
<script language="JavaScript" src="../jscript/codes.js"></script><basefont size="3">
<center><font size="2">The Open Group Base Specifications Issue 8<br>
IEEE Std 1003.1-2024<br>
Copyright © 2001-2024 The IEEE and The Open Group</font></center>
<hr size="2" noshade>
<a name="top" id="top"></a> <a name="posix_typed_mem_open" id="posix_typed_mem_open"></a> <a name="tag_17_401" id="tag_17_401"></a>
<!-- posix_typed_mem_open -->
<h4 class="mansect"><a name="tag_17_401_01" id="tag_17_401_01"></a>NAME</h4>
<blockquote>posix_typed_mem_open — open a typed memory object (<b>ADVANCED REALTIME</b>)</blockquote>
<h4 class="mansect"><a name="tag_17_401_02" id="tag_17_401_02"></a>SYNOPSIS</h4>
<blockquote class="synopsis">
<div class="box"><code><tt><sup>[<a href="javascript:open_code('TYM')">TYM</a>]</sup> <img src="../images/opt-start.gif" alt=
"[Option Start]" border="0"> #include &lt;<a href="../basedefs/sys_mman.h.html">sys/mman.h</a>&gt;<br>
<br>
int posix_typed_mem_open(const char *</tt><i>name</i><tt>, int</tt> <i>oflag</i><tt>, int</tt> <i>tflag</i><tt>); <img src=
"../images/opt-end.gif" alt="[Option End]" border="0"></tt></code></div>
<tt><br></tt></blockquote>
<h4 class="mansect"><a name="tag_17_401_03" id="tag_17_401_03"></a>DESCRIPTION</h4>
<blockquote>
<p>The <i>posix_typed_mem_open</i>() function shall establish a connection between the typed memory object specified by the string
pointed to by <i>name</i> and a file descriptor. It shall create an open file description that refers to the typed memory object
and a file descriptor that refers to that open file description. The file descriptor shall be allocated as described in <a href=
"../functions/V2_chap02.html#tag_16_06"><i>2.6 File Descriptor Allocation</i></a> and can be used by other functions to refer to
that typed memory object. It is unspecified whether the name appears in the file system and is visible to other functions that take
pathnames as arguments. The <i>name</i> argument conforms to the construction rules for a pathname, except that the interpretation
of &lt;slash&gt; characters other than the leading &lt;slash&gt; character in <i>name</i> is implementation-defined, and that the
length limits for the <i>name</i> argument are implementation-defined and need not be the same as the pathname limits {PATH_MAX}
and {NAME_MAX}. If <i>name</i> begins with the &lt;slash&gt; character, then processes calling <i>posix_typed_mem_open</i>() with
the same value of <i>name</i> shall refer to the same typed memory object. If <i>name</i> does not begin with the &lt;slash&gt;
character, the effect is implementation-defined.</p>
<p>Each typed memory object supported in a system shall be identified by a name which specifies not only its associated typed
memory pool, but also the path or port by which it is accessed. That is, the same typed memory pool accessed via several different
ports shall have several different corresponding names. The binding between names and typed memory objects is established in an
implementation-defined manner. Unlike shared memory objects, there is no way within POSIX.1-2024 for a program to create a typed
memory object.</p>
<p>The value of <i>tflag</i> shall determine how the typed memory object behaves when subsequently mapped by calls to <a href=
"../functions/mmap.html"><i>mmap</i>()</a>. At most, one of the following flags defined in <a href=
"../basedefs/sys_mman.h.html"><i>&lt;sys/mman.h&gt;</i></a> may be specified:</p>
<dl compact>
<dd></dd>
<dt>POSIX_TYPED_MEM_ALLOCATE</dt>
<dd>
Allocate on <a href="../functions/mmap.html"><i>mmap</i>()</a>.</dd>
<dt>POSIX_TYPED_MEM_ALLOCATE_CONTIG</dt>
<dd>
Allocate contiguously on <a href="../functions/mmap.html"><i>mmap</i>()</a>.</dd>
<dt>POSIX_TYPED_MEM_MAP_ALLOCATABLE</dt>
<dd>
Map on <a href="../functions/mmap.html"><i>mmap</i>()</a>, without affecting allocatability.</dd>
</dl>
<p>If <i>tflag</i> has the flag POSIX_TYPED_MEM_ALLOCATE specified, any subsequent call to <a href=
"../functions/mmap.html"><i>mmap</i>()</a> using the returned file descriptor shall result in allocation and mapping of typed
memory from the specified typed memory pool. The allocated memory may be a contiguous previously unallocated area of the typed
memory pool or several non-contiguous previously unallocated areas (mapped to a contiguous portion of the process address space).
If <i>tflag</i> has the flag POSIX_TYPED_MEM_ALLOCATE_CONTIG specified, any subsequent call to <a href=
"../functions/mmap.html"><i>mmap</i>()</a> using the returned file descriptor shall result in allocation and mapping of a single
contiguous previously unallocated area of the typed memory pool (also mapped to a contiguous portion of the process address space).
If <i>tflag</i> has none of the flags POSIX_TYPED_MEM_ALLOCATE or POSIX_TYPED_MEM_ALLOCATE_CONTIG specified, any subsequent call to
<a href="../functions/mmap.html"><i>mmap</i>()</a> using the returned file descriptor shall map an application-chosen area from the
specified typed memory pool such that this mapped area becomes unavailable for allocation until unmapped by all processes. If
<i>tflag</i> has the flag POSIX_TYPED_MEM_MAP_ALLOCATABLE specified, any subsequent call to <a href=
"../functions/mmap.html"><i>mmap</i>()</a> using the returned file descriptor shall map an application-chosen area from the
specified typed memory pool without an effect on the availability of that area for allocation; that is, mapping such an object
leaves each byte of the mapped area unallocated if it was unallocated prior to the mapping or allocated if it was allocated prior
to the mapping. Appropriate privileges to specify the POSIX_TYPED_MEM_MAP_ALLOCATABLE flag are implementation-defined.</p>
<p>If successful, <i>posix_typed_mem_open</i>() shall return a file descriptor for the typed memory object. The open file
description is new, and therefore the file descriptor shall not share it with any other processes. It is unspecified whether the
file offset is set. The FD_CLOEXEC file descriptor flag associated with the new file descriptor shall be cleared unless
<i>oflag</i> includes O_CLOEXEC. The FD_CLOFORK file descriptor flag associated with the new file descriptor shall be cleared
unless <i>oflag</i> includes O_CLOFORK.</p>
<p>The behavior of <a href="../functions/msync.html"><i>msync</i>()</a>, <a href=
"../functions/ftruncate.html"><i>ftruncate</i>()</a>, and all file operations other than <a href=
"../functions/mmap.html"><i>mmap</i>()</a>, <a href="../functions/posix_mem_offset.html"><i>posix_mem_offset</i>()</a>, <a href=
"../functions/posix_typed_mem_get_info.html"><i>posix_typed_mem_get_info</i>()</a>, <a href=
"../functions/fstat.html"><i>fstat</i>()</a>, <a href="../functions/dup.html"><i>dup</i>()</a>, <a href=
"../functions/dup2.html"><i>dup2</i>()</a>, <a href="../functions/dup3.html"><i>dup3</i>()</a>, and <a href=
"../functions/close.html"><i>close</i>()</a>, is unspecified when passed a file descriptor connected to a typed memory object by
this function.</p>
<p>The file status flags of the open file description shall be set according to the value of <i>oflag</i>. Applications shall
specify exactly one of the three access mode values described below as the value of <i>oflag</i>.</p>
<dl compact>
<dd></dd>
<dt>O_RDONLY</dt>
<dd>Open for read access only.</dd>
<dt>O_WRONLY</dt>
<dd>Open for write access only.</dd>
<dt>O_RDWR</dt>
<dd>Open for read or write access.</dd>
</dl>
<p>Additionally, the value of <i>oflag</i> can include the following flags:</p>
<dl compact>
<dd></dd>
<dt>O_CLOEXEC</dt>
<dd>Set the FD_CLOEXEC file descriptor flag.</dd>
<dt>O_CLOFORK</dt>
<dd>Set the FD_CLOFORK file descriptor flag.</dd>
</dl>
</blockquote>
<h4 class="mansect"><a name="tag_17_401_04" id="tag_17_401_04"></a>RETURN VALUE</h4>
<blockquote>
<p>Upon successful completion, the <i>posix_typed_mem_open</i>() function shall return a non-negative integer representing the file
descriptor. Otherwise, it shall return -1 and set <i>errno</i> to indicate the error.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_401_05" id="tag_17_401_05"></a>ERRORS</h4>
<blockquote>
<p>The <i>posix_typed_mem_open</i>() function shall fail if:</p>
<dl compact>
<dd></dd>
<dt>[EACCES]</dt>
<dd>The typed memory object exists and the permissions specified by <i>oflag</i> are denied.</dd>
<dt>[EINTR]</dt>
<dd>The <i>posix_typed_mem_open</i>() operation was interrupted by a signal.</dd>
<dt>[EINVAL]</dt>
<dd>The flags specified in <i>tflag</i> are invalid (more than one of POSIX_TYPED_MEM_ALLOCATE, POSIX_TYPED_MEM_ALLOCATE_CONTIG, or
POSIX_TYPED_MEM_MAP_ALLOCATABLE is specified).</dd>
<dt>[EMFILE]</dt>
<dd>All file descriptors available to the process are currently open.</dd>
<dt>[ENFILE]</dt>
<dd>Too many file descriptors are currently open in the system.</dd>
<dt>[ENOENT]</dt>
<dd>The named typed memory object does not exist.</dd>
<dt>[EPERM]</dt>
<dd>The caller lacks appropriate privileges to specify the POSIX_TYPED_MEM_MAP_ALLOCATABLE flag in the <i>tflag</i> argument.</dd>
</dl>
<p>The <i>posix_typed_mem_open</i>() function may fail if:</p>
<dl compact>
<dd></dd>
<dt>[ENAMETOOLONG]</dt>
<dd>
The length of the <i>name</i> argument exceeds {_POSIX_PATH_MAX} on systems that do not support the XSI option <sup>[<a href=
"javascript:open_code('XSI')">XSI</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> &nbsp;or exceeds
{_XOPEN_PATH_MAX} on XSI systems, <img src="../images/opt-end.gif" alt="[Option End]" border="0"> &nbsp;or has a pathname component
that is longer than {_POSIX_NAME_MAX} on systems that do not support the XSI option <sup>[<a href=
"javascript:open_code('XSI')">XSI</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> &nbsp;or longer
than {_XOPEN_NAME_MAX} on XSI systems. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
</dl>
</blockquote>
<hr>
<div class="box"><em>The following sections are informative.</em></div>
<h4 class="mansect"><a name="tag_17_401_06" id="tag_17_401_06"></a>EXAMPLES</h4>
<blockquote>
<p>None.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_401_07" id="tag_17_401_07"></a>APPLICATION USAGE</h4>
<blockquote>
<p>None.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_401_08" id="tag_17_401_08"></a>RATIONALE</h4>
<blockquote>
<p>The use of the O_CLOEXEC and O_CLOFORK flags to <i>posix_typed_mem_open</i>() is necessary to avoid leaking typed memory file
descriptors to child processes, since <a href="../functions/fcntl.html"><i>fcntl</i>()</a> has unspecified results on typed memory
objects and therefore cannot be used to set FD_CLOEXEC or FD_CLOFORK after the file descriptor has been opened. The <i><a href=
"../functions/exec.html">exec</a></i> family of functions already unmaps all memory associated with a typed memory object, but does
not close the file descriptor unless FD_CLOEXEC is also set.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_401_09" id="tag_17_401_09"></a>FUTURE DIRECTIONS</h4>
<blockquote>
<p>None.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_401_10" id="tag_17_401_10"></a>SEE ALSO</h4>
<blockquote>
<p><a href="../functions/V2_chap02.html#tag_16_06"><i>2.6 File Descriptor Allocation</i></a>, <a href=
"../functions/close.html#"><i>close</i>()</a>, <a href="../functions/dup.html#"><i>dup</i>()</a>, <a href=
"../functions/exec.html#tag_17_129"></a><a href="../functions/exec.html">exec</a>, <a href=
"../functions/fcntl.html#"><i>fcntl</i>()</a>, <a href="../functions/fstat.html#"><i>fstat</i>()</a>, <a href=
"../functions/ftruncate.html#"><i>ftruncate</i>()</a>, <a href="../functions/mmap.html#"><i>mmap</i>()</a>, <a href=
"../functions/msync.html#"><i>msync</i>()</a>, <a href="../functions/posix_mem_offset.html#"><i>posix_mem_offset</i>()</a>,
<a href="../functions/posix_typed_mem_get_info.html#"><i>posix_typed_mem_get_info</i>()</a>, <a href=
"../functions/umask.html#tag_17_645"><i>umask</i>()</a></p>
<p>XBD <a href="../basedefs/fcntl.h.html"><i>&lt;fcntl.h&gt;</i></a>, <a href=
"../basedefs/sys_mman.h.html"><i>&lt;sys/mman.h&gt;</i></a></p>
</blockquote>
<h4 class="mansect"><a name="tag_17_401_11" id="tag_17_401_11"></a>CHANGE HISTORY</h4>
<blockquote>
<p>First released in Issue 6. Derived from IEEE&nbsp;Std&nbsp;1003.1j-2000.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_401_12" id="tag_17_401_12"></a>Issue 7</h4>
<blockquote>
<p>Austin Group Interpretation 1003.1-2001 #143 is applied.</p>
<p>POSIX.1-2008, Technical Corrigendum 1, XSH/TC1-2008/0442 [119,428] is applied.</p>
<p>POSIX.1-2008, Technical Corrigendum 2, XSH/TC2-2008/0256 [835], XSH/TC2-2008/0257 [835], and XSH/TC2-2008/0258 [835] are
applied.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_401_13" id="tag_17_401_13"></a>Issue 8</h4>
<blockquote>
<p>Austin Group Defects 411 and 1318 are applied, adding O_CLOEXEC, O_CLOFORK, and <a href=
"../functions/dup3.html"><i>dup3</i>()</a>.</p>
<p>Austin Group Defect 593 is applied, removing a reference to <a href="../basedefs/fcntl.h.html"><i>&lt;fcntl.h&gt;</i></a> from
the DESCRIPTION section.</p>
</blockquote>
<div class="box"><em>End of informative text.</em></div>
<hr>
<p>&nbsp;</p>
<a href="#top"><span class="topOfPage">return to top of page</span></a><br>
<hr size="2" noshade>
<center><font size="2">UNIX® is a registered Trademark of The Open Group.<br>
POSIX™ is a Trademark of The IEEE.<br>
Copyright © 2001-2024 The IEEE and The Open Group, All Rights Reserved<br>
[ <a href="../mindex.html">Main Index</a> | <a href="../basedefs/contents.html">XBD</a> | <a href=
"../functions/contents.html">XSH</a> | <a href="../utilities/contents.html">XCU</a> | <a href="../xrat/contents.html">XRAT</a>
]</font></center>
<hr size="2" noshade>
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/posix_typed_mem_get_info.html" accesskey=
"P">&lt;&lt;&lt; Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/pow.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>
<hr align="left" width="100%"></div>
</body>
</html>
