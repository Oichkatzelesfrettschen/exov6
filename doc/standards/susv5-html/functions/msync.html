<!-- Copyright 2001-2024 IEEE and The Open Group, All Rights Reserved -->
<!DOCTYPE HTML>
<html lang="en">
<head>
<meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.8.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link type="text/css" rel="stylesheet" href="style.css"><!-- Generated by The Open Group rhtm tool v1.2.4 -->
<!-- Copyright (c) 2001-2024 The Open Group, All Rights Reserved -->
<title>msync</title>
</head>
<body bgcolor="white">
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/msgsnd.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/mtx_destroy.html" accesskey="N">Next
&gt;&gt;&gt;</a></td>
</tr>
</table>
<hr align="left" width="100%"></div>
<script language="JavaScript" src="../jscript/codes.js"></script><basefont size="3">
<center><font size="2">The Open Group Base Specifications Issue 8<br>
IEEE Std 1003.1-2024<br>
Copyright © 2001-2024 The IEEE and The Open Group</font></center>
<hr size="2" noshade>
<a name="top" id="top"></a> <a name="msync" id="msync"></a> <a name="tag_17_360" id="tag_17_360"></a><!-- msync -->
<h4 class="mansect"><a name="tag_17_360_01" id="tag_17_360_01"></a>NAME</h4>
<blockquote>msync — synchronize memory with physical storage</blockquote>
<h4 class="mansect"><a name="tag_17_360_02" id="tag_17_360_02"></a>SYNOPSIS</h4>
<blockquote class="synopsis">
<div class="box"><code><tt><sup>[<a href="javascript:open_code('XSI')">XSI|SIO</a>]</sup> <img src="../images/opt-start.gif" alt=
"[Option Start]" border="0"> #include &lt;<a href="../basedefs/sys_mman.h.html">sys/mman.h</a>&gt;<br>
<br>
int msync(void *</tt><i>addr</i><tt>, size_t</tt> <i>len</i><tt>, int</tt> <i>flags</i><tt>); <img src="../images/opt-end.gif" alt=
"[Option End]" border="0"></tt></code></div>
<tt><br></tt></blockquote>
<h4 class="mansect"><a name="tag_17_360_03" id="tag_17_360_03"></a>DESCRIPTION</h4>
<blockquote>
<p>The <i>msync</i>() function shall write all modified data to permanent storage locations, if any, in those whole pages
containing any part of the address space of the process starting at address <i>addr</i> and continuing for <i>len</i> bytes. If no
such storage exists, <i>msync</i>() need not have any effect. If requested, the <i>msync</i>() function shall then invalidate
cached copies of data.</p>
<p>The implementation may require that <i>addr</i> be a multiple of the page size as returned by <a href=
"../functions/sysconf.html"><i>sysconf</i>()</a>.</p>
<p>For mappings to files, the <i>msync</i>() function shall ensure that all write operations are completed as defined for
synchronized I/O data integrity completion. It is unspecified whether the implementation also writes out other file attributes.
When the <i>msync</i>() function is called on MAP_PRIVATE mappings, any modified data shall not be written to the underlying object
and shall not cause such data to be made visible to other processes. It is unspecified whether data in MAP_PRIVATE mappings has any
permanent storage locations. The effect of <i>msync</i>() on an anonymous memory object, <sup>[<a href=
"javascript:open_code('SHM')">SHM</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> &nbsp;shared
memory object, <img src="../images/opt-end.gif" alt="[Option End]" border="0"> or<br>
<sup>[<a href="javascript:open_code('TYM')">TYM</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
typed memory object <img src="../images/opt-end.gif" alt="[Option End]" border="0"> is unspecified. The behavior of this function
is unspecified if the mapping was not established by a call to <a href="../functions/mmap.html"><i>mmap</i>()</a>.</p>
<p>The <i>flags</i> argument is constructed from the bitwise-inclusive OR of one or more of the following flags defined in the
<a href="../basedefs/sys_mman.h.html"><i>&lt;sys/mman.h&gt;</i></a> header:</p>
<center>
<table border="1" cellpadding="3" align="center">
<tr valign="top">
<th align="center">
<p class="tent"><b>Symbolic Constant</b></p>
</th>
<th align="center">
<p class="tent"><b>Description</b></p>
</th>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">MS_ASYNC</p>
</td>
<td align="left">
<p class="tent">Perform asynchronous writes.</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">MS_SYNC</p>
</td>
<td align="left">
<p class="tent">Perform synchronous writes.</p>
</td>
</tr>
<tr valign="top">
<td align="left">
<p class="tent">MS_INVALIDATE</p>
</td>
<td align="left">
<p class="tent">Invalidate cached data.</p>
</td>
</tr>
</table>
</center>
<p class="tent">When MS_ASYNC is specified, <i>msync</i>() shall return immediately once all the write operations are initiated or
queued for servicing; when MS_SYNC is specified, <i>msync</i>() shall not return until all write operations are completed as
defined for synchronized I/O data integrity completion. Either MS_ASYNC or MS_SYNC shall be specified, but not both.</p>
<p class="tent">When MS_INVALIDATE is specified, <i>msync</i>() shall invalidate all cached copies of mapped data that are
inconsistent with the permanent storage locations such that subsequent references shall obtain data that was consistent with the
permanent storage locations sometime between the call to <i>msync</i>() and the first subsequent memory reference to the data.</p>
<p class="tent">If <i>msync</i>() causes any write to a file, the file's last data modification and last file status change
timestamps shall be marked for update.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_360_04" id="tag_17_360_04"></a>RETURN VALUE</h4>
<blockquote>
<p>Upon successful completion, <i>msync</i>() shall return 0; otherwise, it shall return -1 and set <i>errno</i> to indicate the
error.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_360_05" id="tag_17_360_05"></a>ERRORS</h4>
<blockquote>
<p>The <i>msync</i>() function shall fail if:</p>
<dl compact>
<dd></dd>
<dt>[EBUSY]</dt>
<dd>Some or all of the addresses in the range starting at <i>addr</i> and continuing for <i>len</i> bytes are locked, and
MS_INVALIDATE is specified.</dd>
<dt>[EINVAL]</dt>
<dd>The value of <i>flags</i> is invalid.</dd>
<dt>[ENOMEM]</dt>
<dd>The addresses in the range starting at <i>addr</i> and continuing for <i>len</i> bytes are outside the range allowed for the
address space of a process or specify one or more pages that are not mapped.</dd>
</dl>
<p class="tent">The <i>msync</i>() function may fail if:</p>
<dl compact>
<dd></dd>
<dt>[EINVAL]</dt>
<dd>The value of <i>addr</i> is not a multiple of the page size as returned by <a href=
"../functions/sysconf.html"><i>sysconf</i>()</a>.</dd>
</dl>
</blockquote>
<hr>
<div class="box"><em>The following sections are informative.</em></div>
<h4 class="mansect"><a name="tag_17_360_06" id="tag_17_360_06"></a>EXAMPLES</h4>
<blockquote>
<p>None.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_360_07" id="tag_17_360_07"></a>APPLICATION USAGE</h4>
<blockquote>
<p>The <i>msync</i>() function is only supported if the Synchronized Input and Output option is supported, and thus need not be
available on all implementations.</p>
<p class="tent">The <i>msync</i>() function should be used by programs that require a memory object to be in a known state; for
example, in building transaction facilities.</p>
<p class="tent">Normal system activity can cause pages to be written to disk. Therefore, there are no guarantees that
<i>msync</i>() is the only control over when pages are or are not written to disk.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_360_08" id="tag_17_360_08"></a>RATIONALE</h4>
<blockquote>
<p>The <i>msync</i>() function writes out data in a mapped region to the permanent storage for the underlying object. The call to
<i>msync</i>() ensures data integrity of the file.</p>
<p class="tent">After the data is written out, any cached data may be invalidated if the MS_INVALIDATE flag was specified. This is
useful on systems that do not support read/write consistency.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_360_09" id="tag_17_360_09"></a>FUTURE DIRECTIONS</h4>
<blockquote>
<p>None.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_360_10" id="tag_17_360_10"></a>SEE ALSO</h4>
<blockquote>
<p><a href="../functions/mmap.html#"><i>mmap</i>()</a>, <a href="../functions/sysconf.html#"><i>sysconf</i>()</a></p>
<p class="tent">XBD <a href="../basedefs/sys_mman.h.html"><i>&lt;sys/mman.h&gt;</i></a></p>
</blockquote>
<h4 class="mansect"><a name="tag_17_360_11" id="tag_17_360_11"></a>CHANGE HISTORY</h4>
<blockquote>
<p>First released in Issue 4, Version 2.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_360_12" id="tag_17_360_12"></a>Issue 5</h4>
<blockquote>
<p>Moved from X/OPEN UNIX extension to BASE.</p>
<p class="tent">Aligned with <i>msync</i>() in the POSIX Realtime Extension as follows:</p>
<ul>
<li class="tent">The DESCRIPTION is extensively reworded.</li>
<li class="tent">[EBUSY] and a new form of [EINVAL] are added as mandatory error conditions.</li>
</ul>
</blockquote>
<h4 class="mansect"><a name="tag_17_360_13" id="tag_17_360_13"></a>Issue 6</h4>
<blockquote>
<p>The <i>msync</i>() function is marked as part of the Memory Mapped Files and Synchronized Input and Output options.</p>
<p class="tent">The following changes are made for alignment with the ISO&nbsp;POSIX-1:1996 standard:</p>
<ul>
<li class="tent">The [EBUSY] mandatory error condition is added.</li>
</ul>
<p class="tent">The following new requirements on POSIX implementations derive from alignment with the Single UNIX
Specification:</p>
<ul>
<li class="tent">The DESCRIPTION is updated to state that implementations require <i>addr</i> to be a multiple of the page
size.</li>
<li class="tent">The second [EINVAL] error condition is made mandatory.</li>
</ul>
<p class="tent">The DESCRIPTION is updated for alignment with IEEE&nbsp;Std&nbsp;1003.1j-2000 by adding reference to typed memory
objects.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_360_14" id="tag_17_360_14"></a>Issue 7</h4>
<blockquote>
<p>Austin Group Interpretation 1003.1-2001 #078 is applied, clarifying page alignment requirements.</p>
<p class="tent">SD5-XSH-ERN-110 is applied.</p>
<p class="tent">The <i>msync</i>() function is marked as part of the Synchronized Input and Output option or XSI option as the
Memory Mapped Files is moved to the Base.</p>
<p class="tent">Changes are made related to support for finegrained timestamps.</p>
</blockquote>
<h4 class="mansect"><a name="tag_17_360_15" id="tag_17_360_15"></a>Issue 8</h4>
<blockquote>
<p>Austin Group Defect 850 is applied, adding anonymous memory objects.</p>
</blockquote>
<div class="box"><em>End of informative text.</em></div>
<hr>
<p>&nbsp;</p>
<a href="#top"><span class="topOfPage">return to top of page</span></a><br>
<hr size="2" noshade>
<center><font size="2">UNIX® is a registered Trademark of The Open Group.<br>
POSIX™ is a Trademark of The IEEE.<br>
Copyright © 2001-2024 The IEEE and The Open Group, All Rights Reserved<br>
[ <a href="../mindex.html">Main Index</a> | <a href="../basedefs/contents.html">XBD</a> | <a href=
"../functions/contents.html">XSH</a> | <a href="../utilities/contents.html">XCU</a> | <a href="../xrat/contents.html">XRAT</a>
]</font></center>
<hr size="2" noshade>
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/msgsnd.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/mtx_destroy.html" accesskey="N">Next
&gt;&gt;&gt;</a></td>
</tr>
</table>
<hr align="left" width="100%"></div>
</body>
</html>
